require=function e(t,s,n){function i(a,r){if(!s[a]){if(!t[a]){var c="function"==typeof require&&require;if(!r&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=s[a]={exports:{}};t[a][0].call(l.exports,function(e){var s=t[a][1][e];return i(s||e)},l,l.exports,e,t,s,n)}return s[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,s){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(h===setTimeout)return setTimeout(e,0);if((h===n||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function a(e){if(d===clearTimeout)return clearTimeout(e);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function r(){g&&_&&(g=!1,_.length?p=_.concat(p):m=-1,p.length&&c())}function c(){if(!g){var e=o(r);g=!0;for(var t=p.length;t;){for(_=p,p=[];++m<t;)_&&_[m].run();m=-1,t=p.length}_=null,g=!1,a(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var h,d,S=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:n}catch(e){h=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(e){d=i}}();var _,p=[],g=!1,m=-1;S.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];p.push(new u(e,t)),1!==p.length||g||o(c)},u.prototype.run=function(){this.fun.apply(null,this.array)},S.title="browser",S.browser=!0,S.env={},S.argv=[],S.version="",S.versions={},S.on=l,S.addListener=l,S.once=l,S.off=l,S.removeListener=l,S.removeAllListeners=l,S.emit=l,S.prependListener=l,S.prependOnceListener=l,S.listeners=function(e){return[]},S.binding=function(e){throw new Error("process.binding is not supported")},S.cwd=function(){return"/"},S.chdir=function(e){throw new Error("process.chdir is not supported")},S.umask=function(){return 0}},{}],2:[function(e,t,s){function n(e,t){this._id=e,this._clearFn=t}var i=e("process/browser.js").nextTick,o=Function.prototype.apply,a=Array.prototype.slice,r={},c=0;s.setTimeout=function(){return new n(o.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new n(o.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},s.setImmediate="function"==typeof setImmediate?setImmediate:function(e){var t=c++,n=!(arguments.length<2)&&a.call(arguments,1);return r[t]=!0,i(function(){r[t]&&(n?e.apply(null,n):e.call(null),s.clearImmediate(t))}),t},s.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(e){delete r[e]}},{"process/browser.js":1}],Animations:[function(e,t,s){"use strict";cc._RF.push(t,"4f5c8ml6oVN077idBLM6lmH","Animations"),cc.Class({extends:cc.Component,properties:{node_emojis:cc.Node},onLoad:function(){},playEmojiAni:function(e){this.node_emojis.active=!0,this.node_emojis.getComponent(cc.Animation).play(e),cc.log(e)}}),cc._RF.pop()},{}],AppStart:[function(e,t,s){"use strict";function n(){if(isWeChatGame()){Config.version>Storage.version&&wxDownloader.cleanOldAssets(),Storage.version=Config.version}}cc._RF.push(t,"fe5afBS1+pFvaycIn/TO4GI","AppStart"),window.globalInit=function(){e("Enumerates"),e("ConstText"),e("EventCode"),e("EventText"),e("PublicFunctions"),e("ChatData"),e("DailyTaskData"),window.Config=new(e("Config")),window.GameData=new(e("GameData")),window.Storage=new(e("Storage")),window.TJUtils=new(e("TJUtils")),n(),window.HttpHelper=new(e("HttpHelper")),window.SocketHelper=new(e("SocketHelper")),window.EventManager=new(e("EventManager")),window.NetManager=new(e("NetManager")),window.SceneManager=new(e("SceneManager")),window.TipsManager=new(e("TipsManager")),window.LayerManager=new(e("LayerManager")),window.AudioManager=new(e("AudioManager")),window.AsycnManager=new(e("AsycnManager")),window.AudioManager.init(),window.SDK=new(e("SDK")),cc.sys.isNative||(window.DodGameUtils=new(e("DodGameUtils")),DodGameUtils.init()),window.GameListData=new(e("GameListData")),window.ExchargeData=new(e("ExchargeData")),GameListData.init(),ExchargeData.init(),GameData.init(),TJUtils.init()},cc._RF.pop()},{AsycnManager:"AsycnManager",AudioManager:"AudioManager",ChatData:"ChatData",Config:"Config",ConstText:"ConstText",DailyTaskData:"DailyTaskData",DodGameUtils:"DodGameUtils",Enumerates:"Enumerates",EventCode:"EventCode",EventManager:"EventManager",EventText:"EventText",ExchargeData:"ExchargeData",GameData:"GameData",GameListData:"GameListData",HttpHelper:"HttpHelper",LayerManager:"LayerManager",NetManager:"NetManager",PublicFunctions:"PublicFunctions",SDK:"SDK",SceneManager:"SceneManager",SocketHelper:"SocketHelper",Storage:"Storage",TJUtils:"TJUtils",TipsManager:"TipsManager"}],ApplyDismissRoom:[function(e,t,s){"use strict";cc._RF.push(t,"c54cbh9dktCoaOUnk76W+uH","ApplyDismissRoom"),cc.Class({extends:cc.Component,properties:{Label_Data:cc.Label,Label_Time:cc.Label,_turnTime:0,turnTime:{get:function(){return parseInt(this._turnTimes)},set:function(e){this._turnTimes=parseFloat(e)||0,this._tickFunc&&this.unschedule(this._tickFunc),this._turnTimes>0&&(this._tickFunc=function(e){this._turnTimes-=e,this.turnTime<=0&&(this.turnTime=0,this.unschedule(this._tickFunc),this._tickFunc=void 0),this.Label_Time.string=this.turnTime}.bind(this),this.schedule(this._tickFunc,1)),this.Label_Time.string=this.turnTime}}},onEnable:function(){this.turnTime=60},updataLabel:function(e){cc.log("updataLabel first11");var t="",s="",n=[],i="";n.push(""),n.push(""),n.push("");for(o=0;o<e.playerVoteInfo.length;o++)e.playerVoteInfo[o].voteResult==eVoteType.Voter&&(t=e.playerVoteInfo[o].playerID);if(""!=t){s=GameData.battleInfo.playerIDToInfo[t].name;for(var o=0;o<GameData.battleInfo.playerInfos.length;o++){var a=!1;cc.log("第"+o+"个玩家"+GameData.battleInfo.playerInfos[o].name);for(var r=0;r<e.playerVoteInfo.length;r++)if(e.playerVoteInfo[r].playerID==GameData.battleInfo.playerInfos[o].playerID){a=!0;break}a?(cc.log("在列表中"+CText.voteDisRoomAgree),n[o]=u_format(CText.voteDisRoomAgree,GameData.battleInfo.playerInfos[o].name)):(cc.log("不在列表中"+CText.voteDisRoomWaitting),n[o]=u_format(CText.voteDisRoomWaitting,GameData.battleInfo.playerInfos[o].name))}i=u_format(CText.voteDisRoomTips,s,n[0],n[1],n[2]),cc.log(i),this.Label_Data.string=i}}}),cc._RF.pop()},{}],AsycnManager:[function(e,t,s){"use strict";cc._RF.push(t,"d9bf1yjwJ9Pzb2gIpSLClA8","AsycnManager"),cc.Class({properties:{actionsQueues:{default:{}}},clear:function(e){e=e||"__main__",this.actionsQueues[e]=[],this.actionsQueues[e].isRunning=!1},clearAll:function(){this.actionsQueues={}},invoke:function(e,t){return t=t||"__main__",this.actionsQueues[t]=this.actionsQueues[t]||[],this.actionsQueues[t].push(e),!this.actionsQueues[t].isRunning&&this._invokeNext(t),function(){this._invokeNext(t)}.bind(this)},_invokeNext:function(e){var t=this.actionsQueues[e];if(t&&t.length>0){var s=t.shift();t.isRunning=!0,s&&s()}else t.isRunning=!1}}),cc._RF.pop()},{}],AudioManager:[function(e,t,s){"use strict";cc._RF.push(t,"f1ca0b7SMNNUqcEhxmdTh4B","AudioManager"),cc.Class({extends:cc.Component,properties:{bgmVolume:1,sfxVolume:1,bgmAudioID:-1},init:function(){this.bgmVolume=.5,this.sfxVolume=1;var e=Storage.bgmVolume;null!=e&&(this.bgmVolume=parseFloat(e)),null!=(e=Storage.sfxVolume)&&(this.sfxVolume=parseFloat(e)),cc.game.on(cc.game.EVENT_HIDE,function(){console.log("cc.audioEngine.pauseAll"),cc.audioEngine.pauseAll()}),cc.game.on(cc.game.EVENT_SHOW,function(){console.log("cc.audioEngine.resumeAll"),cc.audioEngine.resumeAll()})},getUrl:function(e){return cc.url.raw("resources/sounds/"+e)},playBGM:function(e){var t=this.getUrl(e);console.log(t),this.bgmAudioID>=0&&cc.audioEngine.stop(this.bgmAudioID),this.bgmAudioID=cc.audioEngine.play(t,!0,this.bgmVolume)},playSFX:function(e){var t=this.getUrl(e);return this.sfxVolume>0?cc.audioEngine.play(t,!1,this.sfxVolume):0},playVoice:function(e,t){AudioManager.playSFX(ChatData.getChatPath(GameData.battleInfo.playerIDToInfo[e].sex)+t)},stop:function(e){e&&cc.audioEngine.stop(e)},setSFXVolume:function(e){this.sfxVolume!=e&&(Storage.sfxVolume=e,this.sfxVolume=e)},setBGMVolume:function(e,t){this.bgmAudioID>=0&&(e>0?0==this.bgmVolume&&cc.audioEngine.resume(this.bgmAudioID):cc.audioEngine.pause(this.bgmAudioID)),(this.bgmVolume!=e||t)&&(Storage.bgmVolume=e,this.bgmVolume=e,cc.audioEngine.setVolume(this.bgmAudioID,e))},pauseAll:function(){cc.audioEngine.pauseAll()},resumeAll:function(){cc.audioEngine.resumeAll()}}),cc._RF.pop()},{}],BattleAvatar:[function(e,t,s){"use strict";cc._RF.push(t,"edbdeifJr1PJYr7mOXz3FAv","BattleAvatar"),cc.Class({extends:cc.Component,properties:{lbl_name:cc.Label,img_head:cc.Sprite,img_offline:cc.Node,node_speak:cc.Node,imageIcon:{visible:!1,get:function(){return this.img_head&&this.img_head.spriteFrame},set:function(e){this.img_head&&(this.img_head.spriteFrame=e)}},playerName:{visible:!1,get:function(){return this.lbl_name&&this.lbl_name.string||""},set:function(e){this.lbl_name&&(this.lbl_name.string=e||"")}},isOffline:{visible:!1,get:function(){return Boolean(this.img_offline&&this.img_offline.active)},set:function(e){this.img_offline&&(this.img_offline.active=e)}},showSpeak:{visible:!1,get:function(){return Boolean(this.node_speak&&this.node_speak.active)},set:function(e){this.node_speak&&(this.node_speak.active=e)}},onClickHandler:{visible:!1,default:null}},onHeadClick:function(){this.onClickHandler&&this.onClickHandler()},onLoad:function(){}}),cc._RF.pop()},{}],BattleSystem:[function(e,t,s){"use strict";cc._RF.push(t,"6523aKbXelC8Ip4KZ7Zyj7a","BattleSystem"),cc.Class({extends:cc.Component,properties:{nodeDisplayRoot:cc.Node,_showTips:!1,showTips:{visible:!1,get:function(){return this._showTips},set:function(e){this._showTips=Boolean(e);var t=null;null==(t=this._showTips?cc.find("round"+this._round,this.nodeDisplayRoot):cc.find("round0",this.nodeDisplayRoot))?Storage.finishClassMode=!0:t.getComponent(cc.Toggle).check()}},_playScene:cc.Component,_players:[],_chipsPool:[],_whoseTurn:0,_ownerChair:0,_round:0},onLoad:function(){GameData.gameMode==eGameMode.Class&&(this._playScene=this.node.getComponent("PlayScene"),this._playScene.onClickRobotMode=function(){},this._playScene._netBattleStep.send=function(){this.scheduleOnce(this.ownerDiscard.bind(this,this._playScene._netBattleStep.data))}.bind(this),this.nodeDisplayRoot.active=!0,this.initPlayerDatas())},start:function(){GameData.gameMode==eGameMode.Class&&this.gameStart()},gameStart:function(){this.deal(),this.handleTurns()},quit:function(){GameData.newBattleInfo(),GameData.gameMode=eGameMode.Formal,SceneManager.enterHallScene(),GameData.isNewPlayer&&NetManager.send(EventCode.NTutorial,{})},initPlayerDatas:function(){GameData.newBattleInfo(),GameData.battleInfo.costID=1,GameData.battleInfo.chair=0,GameData.battleInfo.newPlayerInfos(),GameData.battleInfo._playerIDToInfo={},GameData.battleInfo._chairToInfo={};for(var e=0;e<4;e++){var t=GameData.battleInfo.addPlayer();t.chair=e,t.head=0==e?GameData.head:"",t.name=0==e?GameData.name:"接龙玩家"+e,t.playerID=0==e?GameData.userId:1e4+e,t.sex=1,t.isOffline=!1,t.auto=!1,t.chips=0,t.score=0,t.isRobot=0!=e,GameData.battleInfo._playerIDToInfo[t.playerID]=t,GameData.battleInfo._chairToInfo[t.chair]=t,GameData.battleInfo.ownerIndex=0}},deal:function(){for(var e=[107,108,110,112,113,205,302,306,308,309,401,403,411,106,111,401,402,404,410,412,305,311,313,407,408,409,103,104,105,203,206,209,213,301,307,312,404,405,406,101,102,109,207,208,211,303,304,310,402,410,412,413],t=[[0,0,1401],[407,408,409],[406,405,206],[207,208,109]],s=[],n=0;n<4;n++){this._players.push(u_clone(GameData.battleInfo._chairToInfo[n]));for(var i=[],o=0;o<13;o++){var a=e.splice(0,1)[0];i.push(a),107==a&&(this._whoseTurn=n)}this._players[n].cardList=i,this._players[n].actionList=t[n];var r={};r.id=this._players[n].playerID,r.hc=i.length,this._players[n].playerID==GameData.userId&&(this._ownerChair=n,r.handCards=u_clone(i)),s.push(r)}var c=this.createStepData();c.battleDealCards=s,c.battleSteps.push({playType:eDDZOperateType.Deal,ownerId:GameData.userId}),c.battleSteps.push({playType:eDDZOperateType.Bonus,ownerId:GameData.userId,card:this.getChips(5)}),NetManager.dispatch(EventCode.NBattleStep,{battleData:c}),this._round=1},createStepData:function(){return{battleTime:1,battleCount:1,focusId:this._players[this._whoseTurn].playerID,cd:10,battleSteps:[]}},getChips:function(e,t){for(var s=30-this._chipsPool.length,n=0;n<s;n++)this._chipsPool.push(parseInt(1e4*Math.random())%11-5);return t?this._chipsPool.slice(0,e):this._chipsPool.splice(0,e)},handleTurns:function(){var e=this._players[this._whoseTurn],t=0,s=!1;if(e.cardList.length<1)this.quit();else{var n=0;if(e.actionList.length>0&&(n=e.actionList.splice(0,1)[0])){if(t=e.cardList.findIndex(function(e){return n%1e3==e}),s=n<1e3,t<0)return cc.log("Robot discard error !!! chair:"+this._whoseTurn+" id: "+n),void this.quit()}else this._playScene._discardHandler.canDsicardGroup.forEach(function(n,i){var o=e.cardList.findIndex(function(e){return n==e});o>-1&&(t=o,s=!0)},this),this._whoseTurn==this._ownerChair&&(t=-1);if(this._whoseTurn==this._ownerChair){var i=this.createStepData();if(i.battleSteps.push({playType:s?eDDZOperateType.CanDiscard:eDDZOperateType.CanCover,ownerId:GameData.userId}),NetManager.dispatch(EventCode.NBattleStep,{battleData:i}),t>-1){var o=this._playScene._idToNode[GameData.userId].getComponent("CardsHandler");o.canSelectGroup=[o.getPart().findIndex(function(s){return e.cardList[t]==s})]}this.showTips=!0}else this.scheduleOnce(function(){this._whoseTurn=(this._whoseTurn+1)%4;var n=this.createStepData();n.battleSteps.push({playType:s?eDDZOperateType.Discard:eDDZOperateType.Cover,ownerId:e.playerID,card:e.cardList.splice(t,1)}),NetManager.dispatch(EventCode.NBattleStep,{battleData:n}),this.handleTurns()}.bind(this),1)}},ownerDiscard:function(e){if(this._whoseTurn==this._ownerChair){this._whoseTurn=(this._whoseTurn+1)%4;var t=this._players[this._ownerChair],s=this.createStepData();switch(e.playType){case eDDZOperateType.Discard:s.battleSteps.push({playType:eDDZOperateType.Discard,ownerId:t.playerID,card:[e.card]});break;case eDDZOperateType.Cover:s.battleSteps.push({playType:eDDZOperateType.Cover,ownerId:t.playerID,card:[e.card]})}t.cardList.splice(t.cardList.findIndex(function(t){return e.card==t}),1),NetManager.dispatch(EventCode.NBattleStep,{battleData:s}),this.showTips=!1,this._round++,this.handleTurns()}}}),cc._RF.pop()},{}],Bonus:[function(e,t,s){"use strict";cc._RF.push(t,"b546aolsZJJ9Kv8EMwdg0xk","Bonus"),cc.Class({extends:cc.Component,properties:{nodeJieLong:cc.Node,nodeShowHand:cc.Node,nodeAllCover:cc.Node,nodeLastSeven:cc.Node,lblChips:cc.Label,lblName:cc.Label,imgAvatar:cc.Sprite,tglAddChips:cc.Toggle,tglSubChips:cc.Toggle,chipsCount:{set:function(e){(e=e||0)<0?(this.tglSubChips.check(),this.lblChips.node.color=cc.color(0,173,255),this.lblChips.string=e):(this.tglAddChips.check(),this.lblChips.node.color=cc.color(255,204,0),this.lblChips.string="+"+e)}},arrParticleList:{type:cc.ParticleSystem,default:[]},closeCallback:{visible:!1,default:null},_typeToNode:{default:{}},_openTime:3},onLoad:function(){this.node.setContentSize(cc.winSize),this._typeToNode[eDDZOperateType.JieLong]=this.nodeJieLong,this._typeToNode[eDDZOperateType.ShowHand]=this.nodeShowHand,this._typeToNode[eDDZOperateType.AllCover]=this.nodeAllCover,this._typeToNode[eDDZOperateType.LastSeven]=this.nodeLastSeven},onEnable:function(){this.arrParticleList.forEach(function(e,t){e.resetSystem()},this),AudioManager.playSFX("effects/bonus.mp3"),this.node.runAction(cc.sequence(cc.delayTime(this._openTime),cc.callFunc(this.close,this)))},close:function(){this.node.stopAllActions(),this.node.active=!1,this.closeCallback&&this.closeCallback()},open:function(e){if(!e)return cc.log("invalid bouns data",e),void this.close();this.node.active=!0;for(var t in this._typeToNode)this._typeToNode[t].active=!1;this._typeToNode[e.type].active=!0;var s=GameData.battleInfo.playerIDToInfo[e.uid];this.lblName.string=s.name,s.head&&u_createSpriteFrame(s.head,function(e){this.imgAvatar.spriteFrame=e}.bind(this),eResType.absUrl);var n=0;e.chips.forEach(function(e,t){n+=e},this),this.chipsCount=n}}),cc._RF.pop()},{}],Bubbles:[function(e,t,s){"use strict";cc._RF.push(t,"bd5c0t6emNH84Sn9CEjRqPa","Bubbles"),cc.Class({extends:cc.Component,properties:{nodeText:cc.Node,lblText:cc.Label},onLoad:function(){this.nodeText.opacity=0},show:function(e,t){this.nodeText.opacity=255,this.lblText.string=e,this.nodeText.runAction(cc.fadeOut(t).easing(cc.easeQuarticActionIn()))}}),cc._RF.pop()},{}],CardsGroup:[function(e,t,s){"use strict";cc._RF.push(t,"43384qDD7xHcJiLy4KI78v6","CardsGroup"),cc.Class({extends:cc.Component,properties:{prefabCard:cc.Prefab,nodeRoot:cc.Node,lblCardCount:cc.Label,distance:40,align:{default:eAlign.HorCenter,type:cc.Enum(eAlign)},_canSelect:!1,canSelect:{get:function(){return this._canSelect},set:function(e){this._canSelect=Boolean(e),this._nodeRoot&&this.updateGroup()}},_multiSelect:!1,multiSelect:{get:function(){return this._multiSelect&&this._canSelect},set:function(e){this._multiSelect=Boolean(e),this._nodeRoot&&this.updateGroup()}},_canDrag:!1,canDrag:{get:function(){return!this._multiSelect&&this._canDrag&&this._canSelect},set:function(e){this._canDrag=Boolean(e),this._canDrag&&(this._canSelect=!0),this._canDrag&&(this._multiSelect=!1),this._nodeRoot&&this.updateGroup()}},onCardSelected:cc.Component.EventHandler,onCardSecondClick:cc.Component.EventHandler,onDragOut:cc.Component.EventHandler,count:{visible:!1,get:function(){return this._group.length}},selectedGroup:{visible:!1,get:function(){var e=[];return this._uiGroup&&this._uiGroup.forEach(function(t,s){t.getComponent("Card").isSelected&&e.push(s)},this),e},set:function(e){var t=u_clone(e)||[];this._uiGroup.forEach(function(e,s){e.getComponent("Card").isSelected=t.some(function(e,t){return e==s})},this)}},grayGroup:{visible:!1,get:function(){var e=[];return this._uiGroup&&this._uiGroup.forEach(function(t,s){t.getComponent("Card").isGray&&e.push(s)},this),e},set:function(e){var t=u_clone(e)||[];this._uiGroup.forEach(function(e,s){e.getComponent("Card").isGray=t.some(function(e,t){return e==s})},this)}},canSelectGroup:{visible:!1,get:function(){var e=[];return this._uiGroup&&this._uiGroup.forEach(function(t,s){t.getComponent("Card").enableSelected&&e.push(s)},this),e},set:function(e){var t=u_clone(e)||[];this._uiGroup.forEach(function(e,s){e.getComponent("Card").enableSelected=this.canSelect&&t.some(function(e,t){return e==s})},this)}},_nodeRoot:cc.Node,_tmpCard:null,_cardFactory:null,_group:[],_uiGroup:[],_rectSelecteds:[],_beginDrag:!1},_createRootNode:function(e,t,s){var n=(new cc.Node).addComponent(cc.Layout);switch(n.node.width=e.width,n.node.height=e.height,n.resizeMode=cc.Layout.ResizeMode.CONTAINER,t){case eAlign.Left:n.node.anchorX=0,n.node.x=-e.width/2,n.type=cc.Layout.Type.HORIZONTAL,n.spacingX=s-e.width;break;case eAlign.Right:n.node.anchorX=1,n.node.x=e.width/2,n.type=cc.Layout.Type.HORIZONTAL,n.spacingX=s-e.width;break;case eAlign.HorCenter:n.type=cc.Layout.Type.HORIZONTAL,n.spacingX=s-e.width;break;case eAlign.Top:n.node.anchorY=1,n.node.y=e.height/2,n.type=cc.Layout.Type.VERTICAL,n.spacingY=s-e.height;break;case eAlign.Botttom:n.node.anchorY=0,n.node.y=-e.height/2,n.type=cc.Layout.Type.VERTICAL,n.spacingY=s-e.height;break;case eAlign.VerCenter:n.type=cc.Layout.Type.VERTICAL,n.spacingY=s-e.height}return n.node},_onSelected:function(e,t){!this.multiSelect&&t.isSelected&&this.selectedGroup.forEach(function(t,s){e!=t&&(this._uiGroup[t].getComponent("Card").isSelected=!1)},this),this.onCardSelected&&this.onCardSelected.emit()},onLoad:function(e,t){this._tmpCard=cc.instantiate(this.prefabCard),this._cardFactory=this._tmpCard.getComponent("Card"),this._nodeRoot=this._createRootNode(this._tmpCard,this.align,this.distance),this._nodeRoot.parent=this.nodeRoot},addCard:function(e,t,s){if(s){for(var n=[],i=0;i<s;i++)n.push(e);this.addCards(n,t)}else this.addCards([e],t)},addCards:function(e,t){var s=[];e.forEach(function(e,t){var n=this._cardFactory.create(e);s.push(n);var i=n.getComponent("Card");i.enableSelected=this.canSelect,!this.multiSelect||this.align!=eAlign.Left&&this.align!=eAlign.Right&&this.align!=eAlign.HorCenter?this.canDrag&&i.selectedNode.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(i.enableSelected){var t=this._nodeRoot.parent.convertToNodeSpace(e.getStartLocation()),s=this._nodeRoot.parent.convertToNodeSpace(e.getLocation());(Math.abs(s.x-t.x)>10||Math.abs(s.y-t.y)>10)&&(n.parent=this._nodeRoot.parent,n.x=s.x,n.y=s.y,this._beginDrag=!0)}else this._beginDrag=!1},this):i.selectedNode.on(cc.Node.EventType.TOUCH_MOVE,function(e){var t=this._nodeRoot.convertToNodeSpace(e.getStartLocation()),s=this._nodeRoot.convertToNodeSpace(e.getLocation()),n=parseInt((t.x<s.x?t.x:s.x)/this.distance),o=parseInt((t.x>s.x?t.x:s.x)/this.distance);this._rectSelecteds.forEach(function(e,t){this._uiGroup[e].getComponent("Card").isGray=!1},this),this._rectSelecteds=[];for(var a=n;a<=o;a++){var r=this._uiGroup[a]&&this._uiGroup[a].getComponent("Card");r&&r.isSelected==i.isSelected&&(this._rectSelecteds.push(a),r.isGray=!0)}},this),i.selectedNode.on(cc.Node.EventType.TOUCH_END,function(e){var t=i.isSelected;if(t&&this.onCardSecondClick&&this.onCardSecondClick.emit([i]),!this.multiSelect||this.align!=eAlign.Left&&this.align!=eAlign.Right&&this.align!=eAlign.HorCenter){if(this.canDrag&&this._beginDrag){var s=this._nodeRoot.parent.convertToNodeSpace(e.getStartLocation()),o=this._nodeRoot.parent.convertToNodeSpace(e.getLocation());i.isSelected=!0,this._beginDrag=!1,this.updateGroup(),o.y-s.y>n.height&&this.onDragOut&&this.onDragOut.emit([i])}}else this._rectSelecteds.forEach(function(e,s){var n=this._uiGroup[e].getComponent("Card");n!=i&&(n.isSelected=!t),n.isGray=!1},this),this._rectSelecteds=[]},this),i.selectedNode.on(cc.Node.EventType.TOUCH_CANCEL,function(e){var t=i.isSelected;!this.multiSelect||this.align!=eAlign.Left&&this.align!=eAlign.Right&&this.align!=eAlign.HorCenter||(this._rectSelecteds.forEach(function(e,s){var n=this._uiGroup[e].getComponent("Card");n.isSelected=!t,n.isGray=!1},this),this._rectSelecteds=[])},this)}.bind(this)),null==t&&(t=-1),t<0&&(t=this._group.length+t),this._group.splice.apply(this._group,[t,0].concat(e)),this._uiGroup.splice.apply(this._uiGroup,[t,0].concat(s)),this.updateGroup()},removeCard:function(e){this.removeCards(e,1)},removeCards:function(e,t){t<0||(null==e&&(e=-1),e<0&&(e=this._group.length+e),this._group.splice.apply(this._group,[e,t]),this._uiGroup.splice.apply(this._uiGroup,[e,t]),this.updateGroup())},clear:function(){this._nodeRoot&&this._nodeRoot.removeAllChildren(),this._group=[],this._uiGroup=[],this.selectedGroup=[],this.lblCardCount&&(this.lblCardCount.string="0")},getCard:function(e){return e<0&&(e=this._group.length+e),this._group[e]},getPart:function(e,t){return e&&e<0&&(e=this._group.length+e),this._group.slice(e||0,t)},forEach:function(e){this._group.forEach(e)},sort:function(e){e=e||function(e,t){return e-t},this._group.sort(function(t,s){return e(t,s)}.bind(this)),this._uiGroup.sort(function(t,s){return e(t.getComponent("Card").cardID,s.getComponent("Card").cardID)}.bind(this)),this.updateGroup()},removeSelecteds:function(){this._group=this._group.filter(function(e,t,s){return!this.selectedGroup.some(function(e){return e==t})},this),this._uiGroup=this._uiGroup.filter(function(e,t,s){return!this.selectedGroup.some(function(e){return e==t})},this),this._selectedGroup=[],this.updateGroup()},updateGroup:function(){this._nodeRoot.removeAllChildren(!1),this._uiGroup.forEach(function(e,t){e.y=e.x=0,e.parent=this._nodeRoot,e.getComponent("Card").selectedCallback=this.canSelect?this._onSelected.bind(this,t):null},this),this.lblCardCount&&(this.lblCardCount.string=this.count)}}),cc._RF.pop()},{}],CardsHandler:[function(e,t,s){"use strict";cc._RF.push(t,"ba18dhLldlHIoDkynlBSJmu","CardsHandler"),cc.Class({extends:cc.Component,properties:{nodeHandRoot:cc.Node,nodeCoverRoot:cc.Node,lblHandsCount:{type:cc.Label,get:function(){var e=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");return e&&e.lblCardCount},set:function(e){var t=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");t&&(t.lblCardCount=e)}},lblCoverCount:{type:cc.Label,get:function(){var e=this.nodeCoverRoot&&this.nodeCoverRoot.getComponent("CardsGroup");return e&&e.lblCardCount},set:function(e){var t=this.nodeCoverRoot&&this.nodeCoverRoot.getComponent("CardsGroup");t&&(t.lblCardCount=e)}},onCardSelected:{type:cc.Component.EventHandler,get:function(){var e=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");return e&&e.onCardSelected},set:function(e){var t=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");t&&(t.onCardSelected=e)}},onCardSecondClick:{type:cc.Component.EventHandler,get:function(){var e=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");return e&&e.onCardSecondClick},set:function(e){var t=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");t&&(t.onCardSecondClick=e)}},onDragOut:{type:cc.Component.EventHandler,get:function(){var e=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");return e&&e.onDragOut},set:function(e){var t=this.nodeHandRoot&&this.nodeHandRoot.getComponent("CardsGroup");t&&(t.onDragOut=e)}},count:{visible:!1,get:function(){return this._handGroup.count}},selectedCard:{visible:!1,get:function(){return this._handGroup&&this._handGroup.selectedGroup&&this._handGroup.selectedGroup[0]},set:function(e){this._handGroup.selectedGroup=e?[e]:[]}},grayGroup:{visible:!1,get:function(){return this._handGroup.grayGroup},set:function(e){this._handGroup.grayGroup=e}},canSelectGroup:{visible:!1,get:function(){return this._handGroup.canSelectGroup},set:function(e){this._handGroup.canSelectGroup=e}},curDiscardType:{visible:!1,get:function(){return this.grayGroup&&(this.grayGroup.some(function(e){return this.selectedCard==e},this)?eDiscardType.COVER:eDiscardType.DISCARD)}},_handGroup:cc.Component,_coverGroup:cc.Component},onLoad:function(e,t){this._handGroup=this.nodeHandRoot.getComponent("CardsGroup"),this._coverGroup=this.nodeCoverRoot.getComponent("CardsGroup")},addCard:function(e,t,s){this._handGroup.addCard(e,t,s)},addCards:function(e,t){this._handGroup.addCards(e,t)},removeCard:function(e){this._handGroup.removeCard(e)},removeCards:function(e,t){this._handGroup.removeCards(e,t)},removeSelecteds:function(){this._handGroup.removeSelecteds()},clear:function(){this._handGroup.clear(),this._coverGroup.clear()},getCard:function(e){return this._handGroup.getCard(e)},getPart:function(e,t){return this._handGroup.getPart(e,t)},forEach:function(e){this._handGroup.forEach(e)},sort:function(){this._handGroup.sort()},refreshCanSelect:function(e){this.selectedCard=null,this._handGroup.updateGroup();var t=this._handGroup.getPart(),s=[],n=[];e.forEach(function(e,n){var i=t.findIndex(function(t){return t==e},this);i>-1&&s.push(i)},this),t.forEach(function(e,t){s.findIndex(function(e){return e==t},this)<0&&n.push(t)},this),this.grayGroup=n,s.length>0?this.canSelectGroup=s:this.canSelectGroup=t.map(function(e,t){return t},this)},cover:function(e){this._coverGroup.addCard(e||0)},coverWithData:function(e){e=e||[],this._coverGroup.addCards(e)}}),cc._RF.pop()},{}],Card:[function(e,t,s){"use strict";cc._RF.push(t,"9e755+bxH1G74savgsNA57T","Card"),cc.Class({extends:cc.Component,properties:{node_front:cc.Node,node_back:cc.Node,toggle_card:cc.Toggle,cardsAltas:cc.SpriteAtlas,cardID:0,imgPath:"",selectHeight:20,enableSelected:{get:function(){return Boolean(this.toggle_card&&this.toggle_card.interactable)},set:function(e){this.toggle_card.interactable=Boolean(e)}},_isGray:!1,isGray:{get:function(){return this._isGray},set:function(e){this._isGray=Boolean(e),this._isGray?(this.node_back&&(this.node_back.color=new cc.Color(160,160,160)),this.node_front&&(this.node_front.color=new cc.Color(160,160,160))):(this.node_back&&(this.node_back.color=new cc.Color(255,255,255)),this.node_front&&(this.node_front.color=new cc.Color(255,255,255)))}},isSelected:{get:function(){return Boolean(this.toggle_card&&this.toggle_card.isChecked)},set:function(e){e=Boolean(e),this.toggle_card.isChecked!=e&&(e?this.toggle_card.check():this.toggle_card.uncheck()),this.toggle_card.isChecked?this.toggle_card.node.y=this.selectHeight:this.toggle_card.node.y=0}},_isCover:!1,isCover:{get:function(){return Boolean(this._isCover)},set:function(e){this._isCover=Boolean(e),this.node_back&&(this.node_back.active=this._isCover),this.node_front&&(this.node_front.active=!this._isCover)}},selectedNode:{get:function(){return this.toggle_card&&this.toggle_card.node}},selectedCallback:{visible:!1,default:null}},onSelected:function(){this.isSelected=this.toggle_card.isChecked,this.selectedCallback&&this.selectedCallback(this)},create:function(e){var t=cc.instantiate(this.node),s=t.getComponent("Card");return s.cardID=e,s.node_front.getComponent(cc.Sprite).spriteFrame=0==e?this.node_back.getComponent(cc.Sprite).spriteFrame:this.cardsAltas.getSpriteFrame("poker"+e),t}}),cc._RF.pop()},{}],ChatData:[function(e,t,s){"use strict";cc._RF.push(t,"4780fAl7fxFs7EnTOSRe07D","ChatData"),window.ChatData={},ChatData.CommonChat=[["你的牌打得真好，让我意乱神迷了!","xianhua1"],["唉，一手烂牌臭到底","xianhua2"],["财运来的时候真是挡也挡不住啊","xianhua3"],["这么慢，你是属蜗牛的吧？","xianhua4"],["你们是一伙的吧？","xianhua5"],["牌这么好，想输都难啊","xianhua6"],["出啊，好牌留着存银行啊？","xianhua7"],["快点吧，我等到花儿都谢了","xianhua8"],["没梦游吧，都在等你呢","xianhua9"],["辛辛苦苦二十年，一把输到解放前","xianhua10"],["哟，牌技不错嘛","xianhua11"]],ChatData.getChatPath=function(e){var t="voices/";return e==eSex.Man?t+="man/":t+="woman/",t},ChatData.playCommonChat=function(e,t){var s=ChatData.getChatPath(t)+ChatData.CommonChat[e][1]+".mp3";AudioManager.playSFX(s)},ChatData.getChatContextAndPlay=function(e,t,s){var n="";return t==eChatType.QuickChat&&(n=ChatData.CommonChat[e][0],ChatData.playCommonChat(e,s)),n},cc._RF.pop()},{}],ChatPanel:[function(e,t,s){"use strict";cc._RF.push(t,"87b50DMvvZFJY4cKoV+Y5Ef","ChatPanel"),cc.Class({extends:cc.Component,properties:{node_face_layer:cc.Node,node_common_layer:cc.Node,node_common_item:cc.Prefab,scrollContent_common:cc.Node,chatType:{type:eChatType,default:eChatType.Face}},onLoad:function(){this.node.setContentSize(cc.winSize),this.initCommon(),this.chatType=eChatType.Face},close:function(){AudioManager.playSFX("effects/return.mp3"),this.node.active=!1},initCommon:function(){for(var e=0;e<ChatData.CommonChat.length;e++){var t=cc.instantiate(this.node_common_item);cc.find("itemLabel",t).getComponent(cc.Label).string=ChatData.CommonChat[e][0],this.scrollContent_common.addChild(t);var s=new cc.Component.EventHandler;s.target=this.node,s.component="ChatPanel",s.handler="onFaceMessageClick",s.customEventData=""+e,cc.find("common_spr",t).getComponent(cc.Button).clickEvents.push(s)}},onFaceMessageClick:function(e,t){var s=this.node.getComponent("LShowChatMessage");s.data.accountID=GameData.userId,s.data.senderChair=GameData.battleInfo.chair,s.data.type=this.chatType,s.data.content=t,s.send();var n=new Date,i=this.node.getComponent("NChatMessage");i.data.content=this.chatType+"&&_"+t,i.data.sendTime=parseInt(n.getTime()/1e3),i.send(),this.node.active=!1},changeToFaceLayer:function(){this.node_face_layer.active=!0,this.node_common_layer.active=!1,this.chatType=eChatType.Face},changeToCommonLayer:function(){this.node_face_layer.active=!1,this.node_common_layer.active=!0,this.chatType=eChatType.QuickChat}}),cc._RF.pop()},{}],Chip:[function(e,t,s){"use strict";cc._RF.push(t,"57c10pNlsZOIp9AVHzlLhON","Chip"),cc.Class({extends:cc.Component,properties:{nodeChipRoot:cc.Layout,imgAddChip:cc.Node,imgSubChip:cc.Node,_count:0,count:{get:function(){return this._count},set:function(e){if(this._count=e||0,this.nodeChipRoot.node.removeAllChildren(),this._count>0)for(t=0;t<this._count;t++)(s=cc.instantiate(this.imgAddChip)).parent=this.nodeChipRoot.node,s.active=!0;else for(var t=0;t<-this._count;t++){var s=cc.instantiate(this.imgSubChip);s.parent=this.nodeChipRoot.node,s.active=!0}}}},onLoad:function(){}}),cc._RF.pop()},{}],Config:[function(e,t,s){"use strict";cc._RF.push(t,"2f92awZ8j5GWrrKMDnOaExq","Config"),cc.Class({properties:{localParams:{get:function(){return this._localParams||(this._localParams=cc.sys.isNative?[]:function(){var e={};if(null==window.location)return e;for(var t,s,n=document.URL,i=n.indexOf("?"),o=(n=n.substr(i+1)).split("&"),a=0;a<o.length;a++)(i=o[a].indexOf("="))>0&&(t=o[a].substring(0,i),s=o[a].substr(i+1),e[t]=s);return e}()),this._localParams}},version:{get:function(){return cc.sys.isNative?AssetsManager.getLocalManifest().getVersion():"1.0.1"}},versionCode:{get:function(){return parseInt(this.version.split(".")[2])}},defaultAccount:{get:function(){return"Guest_"+SDK.deviceId}},channel:{get:function(){if(cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:return 1e4;case cc.sys.OS_IOS:return 2e4;default:return 1}return 2}},isGuestMode:{get:function(){return!0}},h5Type:{get:function(){return eH5Type.Guest}},urlPackage:{get:function(){return"http://10.10.7.19:8801/Update_list.do"}},urlCheckUpdate:{get:function(){return"http://10.10.7.19:8801/Update_list.do"}},urlLoginGame:{get:function(){return"http://120.77.253.240:7801/User_reg.do"}},urlExcharge:{get:function(){return"http://120.77.253.240:9088/order/create.do"}},urlShareIcon:{get:function(){return"http://119.23.76.232:9908/jielong/icon42x42.png"}},urlPay:{get:function(){var e="http://pay.kaikai.ybmajiang.com";return{list:e+"/pay/queryProducts.do",order:e+"/pay/addIAPOrder.do",query:e+"/pay/queryIAPOrder.do",history:e+"/pay/queryIAPOrderList.do"}}},payArea:{get:function(){return"kk"}},hallServerAddr:{get:function(){return this._hallServerAddr=this._hallServerAddr||{ip:"120.77.253.240",port:5666},this._hallServerAddr}},sfsZone:{get:function(){return"gate"}},sfsRoomZone:{get:function(){return"game"}},dodgameDebug:{get:function(){return!1}},updatePath:{get:function(){return(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"blackjack-remote-asset"}}}}),cc._RF.pop()},{}],ConstText:[function(e,t,s){"use strict";cc._RF.push(t,"3b80d43BWdGOoD+13aMQ9h+","ConstText"),window.CText={loginError:"登录服务器失败，请稍后再试!",loginAreadyJion:"您已经在游戏房间中，请先退出当前房间，再进入其他房间!",packageUpdate:"您的游戏程序过于陈旧，需要下载最新版本的安装包进行安装，是否跳转下载页？",dismissRoomTips:"解散房间不扣金豆，是否确定解散！",voteDisRoomTips:"玩家[%s]申请解散房间，请等待其他玩家选择\n(超过1分钟未选择，默认同意)\n%s\n%s\n%s",voteDisRoomTipsMes:"玩家[%s]申请解散房间，请等待其他玩家选择\n(超过1分钟未选择，默认同意)",voteDisRoomAgree:"[%s]同意",voteDisRoomRefuse:"[%s]不同意",voteDisRoomWaitting:"[%s]等待选择",voteDisRoomSuc:"解散房间成功！",voteDisRoomRefuseByName:"因【%s】拒绝，解散房间失败！",logoutByKick:"您被登出，请重新登陆！",logoutByForbid:"您已被封号！",finishTaskError:"领取失败",paySuc:"充值成功!",payErrNotRight:"禁止应用内购买，请检查设置!",payErrNotUnsupport:"系统不支持该支付方式!",payErrNotUncompleted:"上次购买未完成，请完成后重试!",payErrGetOrder:"下单失败!",payErrCheckOrder:"查单失败!",payErrUnknown:"未知错误，错误码：%d",lackCoin:"金币不足",selectGameTips:"请先选择游戏类型",matchInfo:"一分%d金币%s局",scoreRate:"1分%d金币",doleLimitNotReach:"只有金币数量低于%d才能领取补助哦！",doleMaxCount:"今天的补助已经领取完毕了哦！",doleResultCode1000:"恭喜您领取%d金币！",doleResultCode1004:"领取失败！",doleResultCode1009:"系统错误！",doleResultCode1011:"不符合领取条件！",doleResultCode1012:"今日领取救济金已达上限！",shareRoomTile:"欢乐接龙-牌技大比拼！",shareRoomDesc:"房间号：%s，史上最简单、最心机的纸牌接龙！快来陪我一起玩耍吧！"},cc._RF.pop()},{}],DailyTaskBoxItem:[function(e,t,s){"use strict";cc._RF.push(t,"1ba708rVkNEIJ+Ezq6MVPSn","DailyTaskBoxItem"),cc.Class({extends:cc.Component,properties:{iconTogGroup:cc.Node,lblRewardDesc:cc.Label,_data:{default:{}},data:{visible:!1,get:function(){return this._data},set:function(e){switch(e&&(this._data=u_clone(e)),this.lblRewardDesc.string=this._data.num+this._data.name,this._data.type){case 1:cc.find("type_1",this.iconTogGroup).getComponent(cc.Toggle).check();break;default:cc.find("type_2",this.iconTogGroup).getComponent(cc.Toggle).check()}}}}}),cc._RF.pop()},{}],DailyTaskBox:[function(e,t,s){"use strict";cc._RF.push(t,"f12a2ELUZVCrZEA+lOruqrV","DailyTaskBox"),cc.Class({extends:cc.Component,properties:{pfbBoxCell:cc.Prefab,tglGetReward:cc.Toggle,tglNotComplete:cc.Toggle,tglAlreadyGet:cc.Toggle,content:cc.Node,_data:{default:{}},data:{visible:!1,get:function(){return this._data},set:function(e){e&&(this._data=u_clone(e)),this.content.removeAllChildren();for(var t=0;t<this._data.awardArray.length;t++){var s=cc.instantiate(this.pfbBoxCell).getComponent("DailyTaskBoxItem");this.content.addChild(s.node),s.data=this._data.awardArray[t]}}}},onLoad:function(){this.node.setContentSize(cc.winSize)},init:function(e){this.data=DailyTaskData.TaskInfo.idToAwardBox[e.id]},close:function(){LayerManager.closeByName("DailyTaskBox")},onGetRewardClick:function(){var e={};e.type="Get_Award",e.id=this._data.id,NetManager.send("h.daily_task",e)},redraw:function(){switch(this._data.state){case 0:this.tglNotComplete.check();break;case 1:this.tglGetReward.check();break;case 2:this.tglAlreadyGet.check()}}}),cc._RF.pop()},{}],DailyTaskData:[function(e,t,s){"use strict";cc._RF.push(t,"59e7fwYmB1AIaGLVPPOxQRA","DailyTaskData"),window.DailyTaskData={},DailyTaskData.TaskInfo={leftTime:0,weekScore:0,dayScore:0,isShowRed:0,awardBoxArr:[],taskArr:[]},DailyTaskData.initTaskInfo=function(e){DailyTaskData.TaskInfo.leftTime=e.remainingTime,DailyTaskData.TaskInfo.weekScore=e.integral,DailyTaskData.TaskInfo.dayScore=e.dayIntegral,DailyTaskData.TaskInfo.isShowRed=e.show,e.awardBoxArray.sort(function(e,t){return e.id-t.id}),DailyTaskData.TaskInfo.awardBoxArr=u_clone(e.awardBoxArray),DailyTaskData.TaskInfo.idToAwardBox={},DailyTaskData.TaskInfo.awardBoxArr.forEach(function(e,t){DailyTaskData.TaskInfo.idToAwardBox[e.id]=e},this),DailyTaskData.TaskInfo.taskArr=u_clone(e.taskArray),DailyTaskData.TaskInfo.idToTask={},DailyTaskData.TaskInfo.taskArr.forEach(function(e,t){DailyTaskData.TaskInfo.idToTask[e.id]=e},this)},DailyTaskData.getTaskArr=function(){return DailyTaskData.TaskInfo.taskArr.sort(function(e,t){var s=e.state,n=t.state,i=e.id,o=t.id;return s!==n?1==n||0==n:i>o}),DailyTaskData.TaskInfo.taskArr},DailyTaskData.getMaxWeedScore=function(){return DailyTaskData.TaskInfo.awardBoxArr[DailyTaskData.TaskInfo.awardBoxArr.length-1].integral},cc._RF.pop()},{}],DailyTaskItem:[function(e,t,s){"use strict";cc._RF.push(t,"aaa5cx4FDdLIKDamWyJAMKM","DailyTaskItem"),cc.Class({extends:cc.Component,properties:{nodeRewardType:cc.Node,lblTaskDesc:cc.Label,lblProgress:cc.Label,lblRewardDesc:cc.Label,lblRewardCount:cc.Label,tglGetReward:cc.Toggle,tglNotComplete:cc.Toggle,tglAlreadyGet:cc.Toggle,_data:{default:{}},data:{visible:!1,get:function(){return this._data},set:function(e){switch(e&&(this._data=u_clone(e)),cc.find("type_"+this._data.picId,this.nodeRewardType).getComponent(cc.Toggle).check(),this.lblTaskDesc.string=this._data.content,this.lblProgress.string=this._data.progress,this.lblRewardDesc.string=this._data.itemArray[0].name+"：",this.lblRewardCount.string=this._data.itemArray[0].num,this._data.state){case 0:this.tglNotComplete.check();break;case 1:this.tglGetReward.check();break;case 2:this.tglAlreadyGet.check()}}}},onGetRewardClick:function(){var e={type:"Finish_Task",id:this.data.id};NetManager.send("h.daily_task",e)}}),cc._RF.pop()},{}],DailyTask_json:[function(e,t,s){"use strict";cc._RF.push(t,"a67d5DeNnVG1bBG1X1bNk5I","DailyTask_json"),t.exports=[{id:1,type:1,engine:"Login",content:"登录游戏",target:1,items:"2,10",startTime:"",endTime:"",params:"",picId:1},{id:2,type:2,engine:"FinishGame",content:"玩牌5局",target:5,items:"1,68",startTime:"",endTime:"",params:"FinishRound,1",picId:2},{id:3,type:2,engine:"FinishGame",content:"赢牌3局",target:3,items:"2,10",startTime:"",endTime:"",params:"WinRound,1",picId:3},{id:4,type:2,engine:"FinishGame",content:"完成接龙10次",target:10,items:"2,15",startTime:"",endTime:"",params:"FinishJieLong,1",picId:4},{id:5,type:2,engine:"FinishGame",content:"完全脱手10次",target:10,items:"2,40",startTime:"",endTime:"",params:"FinishTuoShou,1",picId:5},{id:6,type:2,engine:"FinishGame",content:"尾张七5次",target:5,items:"2,24",startTime:"",endTime:"",params:"SevenEnd,1",picId:6},{id:7,type:2,engine:"FinishGame",content:"玩牌10局",target:10,items:"1,88",startTime:"",endTime:"",params:"FinishRound,1",picId:2},{id:8,type:2,engine:"FinishGame",content:"赢牌5局",target:5,items:"2,15",startTime:"",endTime:"",params:"WinRound,1",picId:3},{id:9,type:2,engine:"FinishGame",content:"玩牌15局",target:15,items:"1,128",startTime:"",endTime:"",params:"FinishRound,1",picId:2},{id:10,type:2,engine:"FinishGame",content:"赢牌8局",target:8,items:"2,20",startTime:"",endTime:"",params:"WinRound,1",picId:3},{id:11,type:3,engine:"",content:"宝箱",target:100,items:"1,258",startTime:"",endTime:"",params:"",picId:""},{id:12,type:3,engine:"",content:"宝箱",target:200,items:"1,368",startTime:"",endTime:"",params:"",picId:""},{id:13,type:3,engine:"",content:"宝箱",target:300,items:"1,528",startTime:"",endTime:"",params:"",picId:""},{id:14,type:3,engine:"",content:"宝箱",target:400,items:"1,688",startTime:"",endTime:"",params:"",picId:""}],cc._RF.pop()},{}],DailyTask:[function(e,t,s){"use strict";cc._RF.push(t,"59f917pJxpB35lrJjz3XSGY","DailyTask"),cc.Class({extends:cc.Component,properties:{Node_Activity:cc.Node,Node_TaskCell:cc.Prefab,Label_DayScore:cc.Label,Progress_Week:cc.ProgressBar,labelBoxArr:{type:cc.Label,default:[]},nodeBoxArr:{type:cc.Node,default:[]},_taskArr:{default:{}},_onTaskResponse:null},onLoad:function(){this.node.setContentSize(cc.winSize),this._onTaskResponse=function(e){"Finish_Task"==e.type?1==e.isSucceed?(this.updateTaskArr(e),this.updateDayScore(e.dayIntegral),this.updateWeekScore(e.integral)):TipsManager.showTipsBox(CText.finishTaskError,[1]):"Get_Award"==e.type&&(1==e.isSucceed?(this.updateAwardBox(e.awardId,2),this.updateDayScore(e.dayIntegral),this.updateWeekScore(e.integral)):TipsManager.showTipsBox(CText.finishTaskError,[1]))}.bind(this),NetManager.addListener("h.daily_task",this._onTaskResponse)},onDestroy:function(e){NetManager.removeListener("h.daily_task",this._onTaskResponse)},initUI:function(){this._taskArr={},this.Node_Activity.removeAllChildren();for(var e=DailyTaskData.getTaskArr(),t=0;t<e.length;t++){var s=cc.instantiate(this.Node_TaskCell).getComponent("DailyTaskItem");s.data=e[t],this.Node_Activity.addChild(s.node),this._taskArr[s.data.id]=s}this.updateDayScore(DailyTaskData.TaskInfo.dayScore),this.updateWeekScore(DailyTaskData.TaskInfo.weekScore);for(t=0;t<DailyTaskData.TaskInfo.awardBoxArr.length;t++)this.updateAwardBox(DailyTaskData.TaskInfo.awardBoxArr[t].id-1,DailyTaskData.TaskInfo.awardBoxArr[t].state),this.labelBoxArr[t].string=DailyTaskData.TaskInfo.awardBoxArr[t].integral},onGetAwardClick:function(e,t){var s=t;if(1==DailyTaskData.TaskInfo.idToAwardBox[s].state)(n={}).type="Get_Award",n.id=s,NetManager.send("h.daily_task",n);else{var n={};n.id=s,LayerManager.create("DailyTaskBox",n)}},updateWeekScore:function(e){this.Progress_Week.progress=Math.min(e/DailyTaskData.getMaxWeedScore(),1)},updateDayScore:function(e){this.Label_DayScore.string=e},updateAwardBox:function(e,t){DailyTaskData.TaskInfo.idToAwardBox[e+1].state=t},updateTaskArr:function(e){var t=this._taskArr[e.taskId],s=t.data;s.state=2,t.data=s,DailyTaskData.TaskInfo.idToTask[e.taskId].state=2},close:function(){AudioManager.playSFX("effects/return.mp3"),this.node.active=!1}}),cc._RF.pop()},{}],DiscardGroup:[function(e,t,s){"use strict";cc._RF.push(t,"d4b70spflBGerpGY52UyDCp","DiscardGroup"),cc.Class({extends:e("CardsGroup"),properties:{onCardSelected:{default:null,override:!0,visible:!1}},onLoad:function(){this._super()},addCards:function(e,t){this._super(e,t),this.sort()},updateGroup:function(){if(this._super(),this._uiGroup.length>0){for(var e=this._uiGroup.length-1,t=1;t<e;t++)this._uiGroup[t].getComponent("Card").isGray=!0;this._uiGroup[0].getComponent("Card").isGray=!1,this._uiGroup[this._uiGroup.length-1].getComponent("Card").isGray=!1}}}),cc._RF.pop()},{CardsGroup:"CardsGroup"}],DiscardHandler:[function(e,t,s){"use strict";cc._RF.push(t,"4dcd6LNRGdM6r3bkeio4Dx6","DiscardHandler"),cc.Class({extends:cc.Component,properties:{nodeDiscardSpade:cc.Node,nodeDiscardHeart:cc.Node,nodeDiscardClub:cc.Node,nodeDiscardDiamond:cc.Node,_canDsicardGroup:[],canDsicardGroup:{visible:!1,get:function(){return this._canDsicardGroup}},_patternToGroup:{default:{}}},onLoad:function(){this._patternToGroup[eCardPattern.SPADE]=this.nodeDiscardSpade.getComponent("DiscardGroup"),this._patternToGroup[eCardPattern.HEART]=this.nodeDiscardHeart.getComponent("DiscardGroup"),this._patternToGroup[eCardPattern.CLUB]=this.nodeDiscardClub.getComponent("DiscardGroup"),this._patternToGroup[eCardPattern.DIAMOND]=this.nodeDiscardDiamond.getComponent("DiscardGroup"),this.updateCanDsicard()},initWithData:function(e){for(var t in this._patternToGroup){var s=e[t]||[],n=this._patternToGroup[t];n.clear(),n.addCards(s)}this.updateCanDsicard()},clear:function(){for(var e in this._patternToGroup)this._patternToGroup[e].clear()},discard:function(e){var t=this._patternToGroup[parseInt(e/100)];t?(t.addCard(e),this.updateCanDsicard()):cc.log("discard error! invaild card ID: "+e)},updateCanDsicard:function(){if(this._patternToGroup[eCardPattern.SPADE].count<1)this._canDsicardGroup=[107];else{this._canDsicardGroup=[];for(var e in this._patternToGroup)if(this._patternToGroup.hasOwnProperty(e)){var t=this._patternToGroup[e];if(t.count>0){var s=t.getCard(0)-1,n=t.getCard(-1)+1;s%100>0&&this._canDsicardGroup.push(s),n%100<14&&this._canDsicardGroup.push(n)}else this._canDsicardGroup.push(100*parseInt(e)+7)}}}}),cc._RF.pop()},{}],DodGameUtils:[function(e,t,s){"use strict";cc._RF.push(t,"02a59yQkJNMBLJGdAXNSd4n","DodGameUtils"),cc.Class({properties:{payCallBack:null,_curRecharge:null},init:function(){cc.sys.isNative||window.addEventListener("message",function(e){if(console.log("onmessage"),""!=e.data){var t=e.data.info_type,s=e.data.info_data;switch(cc.log("rece_info_type:",t),t){case ePlatformAction.pay_result:this.payCallBack(s);break;case ePlatformAction.share_refresh_data_resault:this.doShare();break;default:cc.log("未定义消息")}}}.bind(this),!1)},startPay:function(e,t){this.payCallBack=t,HttpHelper.sendRequest(Config.urlExcharge,e,this.exchargeRes.bind(this))},exchargeRes:function(e){var t=new Object;t.user_id=e.user_id,t.body=e.body,t.attach=e.attach,t.out_trade_no=e.out_trade_no,t.total_fee=e.total_fee,t.detail=e.detail,t.product_id=e.product_id,t.game_id=e.game_id,t.ip=e.ip,t.nonce_str=e.nonce_str,t.sign=e.sign,cc.log(t);var s=JSON.stringify(t);this.payAction(s),this._curRecharge=t},payAction:function(e){var t=new Object;t.info_type=ePlatformAction.pay,t.info_data=e,t.is_debug=Config.dodgameDebug,cc.log(t),window.parent.postMessage(t,"*")},share:function(e,t,s,n){var i=new Object;i.share_title=e,i.share_desc=t,i.img_url=s,i.friend_code=n;var o=new Object;o.is_debug=Config.dodgameDebug,o.info_type=ePlatformAction.share_refresh_data,o.info_data=i,window.parent.postMessage(o,"*")},doShare:function(){var e=new Object;e.info_type=ePlatformAction.share,e.info_data="",e.is_debug=Config.dodgameDebug,cc.log(e),window.parent.postMessage(e,"*")}}),cc._RF.pop()},{}],Enumerates:[function(e,t,s){"use strict";cc._RF.push(t,"e0529QKEK1CTYbkD4nJsF8K","Enumerates"),window.eH5Type=cc.Enum({Guest:0,WeiXinMini:1,Dod:2}),window.eAlign=cc.Enum({Left:0,Right:1,Top:2,Botttom:3,HorCenter:4,VerCenter:5}),window.eTabType=cc.Enum({JieLong:0,ZhanLong:1}),window.eBattleState=cc.Enum({Offline:0,Ready:1,Start:2}),window.eServerResult=cc.Enum({CreateRoomSuccess:1114121,EnterRoomSuccess:1114123,InvaildRoomId:16842763,AllreadyInTheRoom:17891339,RoomFull:18939915,RoomCardNotEnough:16842761,LoginSuccess:1114116,LoginFailed:16842756,LoginForbiddern:17891332,LoginParamError:18939908,RoomDestorySuccess:1114125,LogOutByKick:16842759,LogOutByForbid:17891335,QuitRoomSuccess:1114142,NotInTheRoom:16842782,QuitRoomFailedInBattle:17891358,MasterCanotQuitRoom:18939934,QuitRoomInvaildRoomId:19988510,VoteDestroySuc:1114135,VoteDestroyFailedByRefused:16842775,VoteDestroyVoting:17891351,VoteDestroyFailedExist:18939927,VoteDestroyFailedNotInRoom:19988503,VoteDestroyFailedHasVoted:21037079,SystemError:17891333}),window.eBtnType=cc.Enum({Sure:1,Cancel:2}),window.eDDZOperateType=cc.Enum({Deal:1,CanDiscard:10002,CanCover:10003,Discard:2,Cover:3,JieLong:4,ShowHand:6,AllCover:7,LastSeven:8,Bonus:9,RoundReport:10,FinalReport:11}),window.eDDZGameState=cc.Enum({Idle:0,Play:3}),window.eCurScene=cc.Enum({HallSecne:1,PlayScene:2}),window.eVoteType=cc.Enum({Voter:2,Agree:0,Refuse:1}),window.eSex=cc.Enum({Wonman:0,Man:1}),window.eChatType=cc.Enum({QuickChat:1,Face:6}),window.eLocalEvent=cc.Enum({UpdateCardsAndBeans:"UpdateCardsAndBeans"}),window.eCardPattern=cc.Enum({SPADE:1,DIAMOND:2,CLUB:3,HEART:4}),window.eDiscardType=cc.Enum({DISCARD:1,COVER:2}),window.ePlatformAction=cc.Enum({pay:"msg_pay",auth_verify_fail:"msg_auth_verify_fail",share:"msg_share",share_refresh_data:"msg_share_refresh_data",follow_subscribe:"msg_follow_subscribe",open_game_hall:"msg_open_game_hall",re_auth_err:"msg_re_auth_err",pay_result:"msg_pay_result",share_to_moments_resault:"msg_share_to_moments_resault",share_to_friend_resault:"msg_share_to_friend_resault",share_refresh_data_resault:"msg_share_refresh_data_resault"}),window.eResType=cc.Enum({absUrl:1,relativeUrl:2}),window.eGameMode=cc.Enum({Formal:1,Class:2}),window.ePayType=cc.Enum({Weixin:1,Apple:2,Web:3}),window.ePayErrorCode=cc.Enum({ERROR_SUCCESS:0,ERROR_USER_CANCEL:1,ERROR_NORIGHT:2,ERROR_PURCHASING:3,ERROR_UNCOMPLETED:4,ERROR_PARAMETER_INVALID:5,ERROR_FAILED:6,ERROR_GET_ORDER:7,ERROR_CHECK_ORDER:8,ERROR_UNSUPPORT:9}),window.eUpdateType=cc.Enum({NO_UPDATE:2101,RESOURCE_UPDATE:2102,PACKAGE_UPDATE:2103}),cc._RF.pop()},{}],EventCode:[function(e,t,s){"use strict";cc._RF.push(t,"3a40aqWGBNHw5k6otU1b5+A","EventCode"),window.EventCode=function(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}({SFS_EVENT_UPDATE:"SFS_EVENT_UPDATE",SFS_EVENT_CONNECT_SUCCESS:"SFS_EVENT_CONNECT_SUCCESS",SFS_EVENT_CONNECT_FAILURE:"SFS_EVENT_CONNECT_FAILURE",SFS_EVENT_CONNECT_DISCONNECT:"SFS_EVENT_CONNECT_DISCONNECT",SFS_EVENT_CONNECT_RETRY:"SFS_EVENT_CONNECT_RETRY",SFS_EVENT_CONNECT_RESUME:"SFS_EVENT_CONNECT_RESUME",SFS_EVENT_LOGIN:"SFS_EVENT_LOGIN",NUserUpdate:"userupdate",NLogOut:"h.logout",NCoinsUpdate:"h.account_modify",NCreateRoom:"r.create",SFS_EVENT_JOIN_ROOM:"SFS_EVENT_JOIN_ROOM",NJoinRoom:"r.join",NDestroyRoom:"r.destory",NBattleStart:"r.start",NBattleReady:"r.ready",SFS_EVENT_BANKER_SET_START:"r.banker_set_start",SFS_EVENT_BANKER_SET_READY:"r.banker_set_ready",SFS_EVENT_BATTLE_STEP:"r.battle_poker",NVoteReq:"vote_req",NVoteRes:"r.vote",NQuitRoom:"r.quit",NRobotMode:"r.set_auto_mode",NPayBack:"h.pay_back",NTutorial:"h.tutorial",NDole:"h.dole",LJoinGame:"LJoinGame",SFS_EVENT_ACTIVITY_SYN:"responseActiveList",SFS_EVENT_ACTIVITY:"requestActiveList",SFS_EVENT_CONTACT:"SFS_EVENT_CONTACT",SFS_EVENT_VISIT_EMAIL:"SFS_EVENT_VISIT_EMAIL",SFS_EVENT_HAVE_NEW_EMAIL_SYN:"SFS_EVENT_HAVE_NEW_EMAIL_SYN",SFS_EVENT_ROOM_RECORD:"SFS_EVENT_ROOM_RECORD",SFS_EVENT_ROOM_ROUND_RECORD:"SFS_EVENT_ROOM_ROUND_RECORD",SFS_EVENT_MARQUEE_SYN:"SFS_EVENT_MARQUEE_SYN",SFS_EVENT_ACCOUNT_LOGOUT:"SFS_EVENT_ACCOUNT_LOGOUT",NChatMessage:"r.chat",SFS_EVENT_FORCE_DESTORY_ROOM:"SFS_EVENT_FORCE_DESTORY_ROOM",SFS_EVENT_PING:"SFS_EVENT_PING",SFS_EVENT_CUSTOM_PING:"ping",SFS_EVENT_BOARD_MSG:"board_msg",SFS_EVENT_SERVER_ERROR:"error",SFS_EVENT_CONNECT_DISCONNECT_REASON_MANUAL:"manual",SFS_EVENT_CONNECT_DISCONNECT_REASON_PING:"ping",SFS_EVENT_ROUND_REPORT:"round_data",SFS_EVENT_CONNECT_DISCONNECT_REASON_BACKGROUND:"background",SFS_EVENT_CONNECT_DISCONNECT_REASON_QUIT:"quit",SFS_EVENT_REAL_NAME:"real_name",SFS_EVENT_UPDATE_INVITATION:"invite_code_info",SFS_EVENT_BIND_INVITE_CODE:"invite_code",SFS_EVENT_GPS:"gps_data",NCardExchange:"h.card_change_gold_bean",NBattleStep:"r.step"},"SFS_EVENT_REAL_NAME","real_name"),cc._RF.pop()},{}],EventManager:[function(e,t,s){"use strict";cc._RF.push(t,"bf7cc2U4cFA6plV77h95iVR","EventManager"),cc.Class({properties:{eventQueue:[],listeners:{default:{}}},ctor:function(){cc.director.getScheduler().schedule(function(){if(this.eventQueue.length>0){var e=this.eventQueue.shift();this.dispatch(e.msg,e.data)}}.bind(this),cc.director,0)},addListener:function(e,t){this.listeners[e]=this.listeners[e]||[],this.removeListener(e,t),this.listeners[e].push(t)},removeListener:function(e,t){if(this.listeners[e])for(var s=0;s<this.listeners[e].length;s++)if(this.listeners[e][s]===t){this.listeners[e].splice(s,1);break}},send:function(e,t){this.eventQueue.push({msg:e,data:t})},dispatch:function(e,t){if(this.listeners[e])for(var s=0;s<this.listeners[e].length;s++)this.listeners[e][s](t)}}),cc._RF.pop()},{}],EventText:[function(e,t,s){"use strict";cc._RF.push(t,"36e8cyQyAVB84nLLssGn2S/","EventText"),window.EventText={16842754:"没有更新",17891330:"资源更新",18939906:"整包更新",16842756:"登录失败，未知原因",17891332:"登录失败，已被封号",18939908:"登录失败，参数错误",19988484:"refreshToken失效,请重新授权",21037060:"登录失败，平台不允许登录",16842759:"登出，其他设备登陆",17891335:"登出，被封号",16842761:"金币不足，请充值后继续游戏",16842764:"金币不足，请充值后继续游戏",17891337:"服务器内部错误",18939913:"已经在房间中",16842763:"房间不存在",17891339:"已经在其他房间中",18939915:"房间已满",16842765:"解散失败，非房主",17891341:"解散失败，不在房间中",18939917:"解散失败，处于打牌状态",19988493:"解散失败，房间号错误",16842770:"非法的出牌",17891346:"掉线",18939922:"未知原因",16842772:"发送消息失败",16842775:"因有人拒绝，退出失败",17891351:"投票中",18939927:"已经有人申请解散",19988503:"您没有在房间中",21037079:"您已经投过票",16842777:"查询记录失败",16842779:"查询记录失败",16842782:"退出失败，不在房间中",17891358:"退出失败，处于战斗中",18939934:"退出失败，房主不能主动退出",19988510:"退出失败,房间号错误",16842786:"启用新KEY失败",16842788:"没有公告",16842790:"没有联系方式",16842794:"房主拒绝连开",17891370:"玩家连开请求处理失败",16842795:"房主选择不连开",16842799:"没有公告",1:"授权已经过期，请重新授权",2:"授权已经过期，请重新授权",3:"授权已经过期，请重新授权",5:"服务器人太多，请稍后重试",6:"您已经在别处登录，请勿重复登录",7:"服务器人太多，请稍后重试",17891333:"操作失败"},cc._RF.pop()},{}],ExchangeGoldBean:[function(e,t,s){"use strict";cc._RF.push(t,"f24a0G830JFY5KovLcT51g9","ExchangeGoldBean"),cc.Class({extends:cc.Component,properties:{Node_ExchangeLayer:cc.Node,Label_GoldBean:cc.Label,Label_Card:cc.Label,_cardNum:0},onLoad:function(){},onExchangeOneCard:function(){cc.log("onExchangeOneCard"),this._cardNum=1,this.showExchangeLayer(this._cardNum)},onExchangeFiveCard:function(){cc.log("onExchangeFiveCard"),this._cardNum=5,this.showExchangeLayer(this._cardNum)},onExchangeTenCard:function(){cc.log("onExchangeTenCard"),this._cardNum=10,this.showExchangeLayer(this._cardNum)},onCloseClick:function(){this.node.active=!1},onCardExchangeRespone:function(e){GameData.gems=e.card,GameData.coins=e.goldBean,EventManager.dispatch(eLocalEvent.UpdateCardsAndBeans)},onConfirmClick:function(){this.node.getComponent("NCardExchange").data.card=this._cardNum,this.node.getComponent("NCardExchange").send(),this.Node_ExchangeLayer.active=!1},onCancelClick:function(){this.Node_ExchangeLayer.active=!1},showExchangeLayer:function(e){var t="X"+e,s="X"+10*e;this.Label_GoldBean.string=s,this.Label_Card.string=t,this.Node_ExchangeLayer.active=!0}}),cc._RF.pop()},{}],ExchargeData:[function(e,t,s){"use strict";cc._RF.push(t,"8f473bzOBdI0aFwb/W4q2dM","ExchargeData"),cc.Class({properties:{exchargeData:[]},init:function(){this.loadExchargeData()},loadExchargeData:function(){this.exchargeData=e("Excharge_json")},getDataById:function(e){for(var t=0;t<this.exchargeData.length;t++)if(this.exchargeData[t].id==e)return this.exchargeData[t];return null}}),cc._RF.pop()},{Excharge_json:"Excharge_json"}],Excharge_json:[function(e,t,s){"use strict";cc._RF.push(t,"62588vvU1pF17e6dXrEjsSQ","Excharge_json"),t.exports=[{id:1,itemId:1,count:5e3,cash:1,git:0},{id:2,itemId:1,count:10500,cash:1200,git:.05},{id:3,itemId:1,count:27500,cash:3e3,git:.1},{id:4,itemId:1,count:65200,cash:6800,git:.15},{id:5,itemId:1,count:102e3,cash:9800,git:.2},{id:6,itemId:1,count:206200,cash:19800,git:.25},{id:7,itemId:1,count:1e3,cash:1,git:.1}],cc._RF.pop()},{}],Excharge:[function(e,t,s){"use strict";cc._RF.push(t,"e9ebc5G+9ZEi6k0R8VlUW/0","Excharge");cc.Class({extends:cc.Component,properties:{rootItem:cc.Node,_curRecharge:null,_payLogic:cc.Component},onLoad:function(){this.node.setContentSize(cc.winSize),this._payLogic=this.node.getComponent("PayLogic"),this._payLogic.getProductList(function(e,t){e?(this._exchargeData=t,this._fillExchargeData()):this.rootItem.active=!1}.bind(this))},onExchargeClick:function(e,t){this._payLogic.pay(this._exchargeData[parseInt(t)].id,this.checkPayResult.bind(this))},close:function(){AudioManager.playSFX("effects/return.mp3"),this.node.active=!1},checkPayResult:function(e){switch(cc.log("pay_result:",e),e.errCode){case ePayErrorCode.ERROR_NORIGHT:TipsManager.showTipsBox(CText.payErrNotRight);break;case ePayErrorCode.ERROR_UNSUPPORT:TipsManager.showTipsBox(CText.payErrNotUnsupport);break;case ePayErrorCode.ERROR_UNCOMPLETED:TipsManager.showTipsBox(CText.payErrNotUncompleted);break;case ePayErrorCode.ERROR_GET_ORDER:TipsManager.showTipsBox(CText.payErrGetOrder);break;case ePayErrorCode.ERROR_CHECK_ORDER:TipsManager.showTipsBox(CText.payErrCheckOrder);break;default:TipsManager.showTipsBox(u_format(CText.payErrUnknown,e.errCode))}},_fillExchargeData:function(){for(var e=0;e<6;e++){var t="exchangeItem"+e,s=this.rootItem.getChildByName(t);if(void 0==this._exchargeData[e])s.active=!1;else{var n=this._exchargeData[e].cash/100+" ¥";s.getChildByName("buy_label").getComponent(cc.Label).string=n,s.getChildByName("New Label").getComponent(cc.Label).string=this._exchargeData[e].count+" 金币"}}}}),cc._RF.pop()},{}],GameData:[function(e,t,s){"use strict";cc._RF.push(t,"7fc1dXaCnNBfowS5PWXR0Dk","GameData");var n=cc.Class({properties:{chair:{get:function(){return this._chair},set:function(e){this._chair=e}},head:{get:function(){return this._head},set:function(e){e&&(this._head="http://h5.dodgame.com.cn/api/getimg?url="+e)}},ip:{get:function(){return this._ip},set:function(e){this._ip=e}},name:{get:function(){return this._name},set:function(e){e&&(this._name=decodeURIComponent(e))}},playerID:{get:function(){return this._playerID},set:function(e){this._playerID=e}},sex:{get:function(){return this._sex},set:function(e){this._sex=e}},status:{get:function(){return this._status},set:function(e){this._status=e}},isOffline:{get:function(){return this._isOffline},set:function(e){this._isOffline=e}},auto:{get:function(){return this._auto},set:function(e){this._auto=e}},chips:{get:function(){return this._chips},set:function(e){this._chips=e}},score:{get:function(){return this._score},set:function(e){this._score=e}},isRobot:{get:function(){return this._isRobot},set:function(e){this._isRobot=e}}}}),i=cc.Class({properties:{roomID:{get:function(){return this._roomID},set:function(e){this._roomID=e}},costID:{get:function(){return this._costID},set:function(e){this._costID=e}},isPersonal:{get:function(){return this._isPersonal},set:function(e){this._isPersonal=e}},roomType:{get:function(){return this._roomType},set:function(e){this._roomType=e}},roomConfigId:{get:function(){return this._roomConfigId},set:function(e){this._roomConfigId=e}},payMode:{get:function(){return this._payMode},set:function(e){this._payMode=e}},gameTypeSelection:{get:function(){return this._gameTypeSelection},set:function(e){this._gameTypeSelection=e}},tabType:{get:function(){return this._tabType},set:function(e){this._tabType=e}},chair:{get:function(){return this._chair},set:function(e){this._chair=e}},currentBattleCount:{get:function(){return this._currentBattleCount},set:function(e){this._currentBattleCount=e}},playerInfos:{get:function(){return this._playerInfos}},playerIDToInfo:{get:function(){return this._playerIDToInfo}},chairToInfo:{get:function(){return this._chairToInfo}},ownerIndex:{get:function(){return null==this._ownerIndex&&(this._ownerIndex=-1),this._ownerIndex},set:function(e){this._ownerIndex=e}}},ctor:function(){this.newPlayerInfos()},newPlayerInfos:function(){return this._playerInfos=[],this._playerInfos},addPlayer:function(){var e=new n;return this._playerInfos.push(e),e}});cc.Class({properties:{version:{get:function(){return this._version},set:function(e){this._version=e}},account:{get:function(){return this._account},set:function(e){this._account=e}},token:{get:function(){return this._token},set:function(e){this._token=e}},gameServerAddr:{get:function(){return this._gameServerAddr},set:function(e){this._gameServerAddr=e}},userIp:{get:function(){return this._userIp},set:function(e){this._userIp=e}},userName:{get:function(){return this._userName},set:function(e){e&&(this._userName=decodeURIComponent(e))}},userSex:{get:function(){return this._userSex},set:function(e){this._userSex=e}},userId:{get:function(){return this._userId},set:function(e){this._userId=e}},head:{get:function(){return this._head},set:function(e){e&&(this._head="http://h5.dodgame.com.cn/api/getimg?url="+e)}},coins:{get:function(){return this._coins},set:function(e){this._coins=e}},gems:{get:function(){return this._gems},set:function(e){this._gems=e}},gameMode:{get:function(){return this._gameMode||eGameMode.Formal},set:function(e){this._gameMode=e}},isNewPlayer:{get:function(){return this._isNewPlayer||!1},set:function(e){this._isNewPlayer=e}},battleInfo:{get:function(){return this._battleInfo||{}}},_stepsCache:[],_node:cc.Node,_netJoinRoom:cc.Component,_netUserUpdate:cc.Component,_netQuitRoom:cc.Component,_netBattleStep:cc.Component,_localPlayersDataChange:cc.Component,_joinGame:cc.Component},ctor:function(){this.newBattleInfo(),this._node=new cc.Node},init:function(){this._netUserUpdate=this._node.addComponent("NUserUpdate").init(),this._netUserUpdate.setListener(this._onUserUpdateRespone.bind(this)),this._netJoinRoom=this._node.addComponent("NJoinRoom").init(),this._netJoinRoom.setListener(this._onJoinRoomRespone.bind(this)),this._netQuitRoom=this._node.addComponent("NQuitRoom").init(),this._netQuitRoom.setListener(this._onQuitRoomRespone.bind(this)),this._localPlayersDataChange=this._node.addComponent("LPlayersDataChange").init(),this._joinGame=this._node.addComponent("JoinGame").init(),NetManager.addListener(EventCode.NTutorial,this._onTutorialRes.bind(this)),NetManager.addListener(EventCode.NCoinsUpdate,this._onCoinsUpdate.bind(this))},newBattleInfo:function(){return this._battleInfo=new i,this._battleInfo},popStepCache:function(){this._netBattleStep&&(this._netBattleStep.setListener(null),this._netBattleStep.destroy(),this._netBattleStep=null);var e=this._stepsCache;return this._stepsCache=[],e},_onUserUpdateRespone:function(e){e.res==eServerResult.LoginSuccess&&(this.account=e.ID,this.userName=e.name,this.userSex=e.sex,this.userId=e.ID,this.userIp=e.ip,this.gems=parseInt(e.coin0),this.coins=parseInt(e.coin0),this.gameMode=eGameMode.Formal,this.isNewPlayer=1!=e.tutorial,this.battleInfo.roomID="null"!=e.room&&0!=e.room&&e.room||Config.localParams.friend_code,this._joinGame.join(this.battleInfo.roomID))},_onJoinRoomRespone:function(e){if(e.res==eServerResult.EnterRoomSuccess){if(this.battleInfo.roomID=e.rid+"",this.battleInfo.costID=e.costId,this.battleInfo.isPersonal=e.isPersonal,this.battleInfo.roomType=e.rt,this.battleInfo.roomConfigId=e.roomConfigId,this.battleInfo.payMode=e.payMode,this.battleInfo.gameTypeSelection=e.gameTypeSelection,this.battleInfo.chair=e.chair,this.battleInfo.currentBattleCount=e.rd,this.battleInfo.newPlayerInfos(),this.battleInfo._playerIDToInfo={},this.battleInfo._chairToInfo={},e.info&&e.info.length>0)for(var t=0;t<e.info.length;t++){var s=this.battleInfo.addPlayer();s.chair=e.info[t].chair,s.head=e.info[t].head,s.ip=e.info[t].ip,s.name=e.info[t].name,s.playerID=e.info[t].uid,s.sex=e.info[t].sex,s.status=e.info[t].status,s.isOffline=e.info[t].off,s.auto=e.info[t].auto,s.chips=e.info[t].chips,s.score=e.info[t].score,s.isRobot=e.info[t].isR,this.battleInfo._playerIDToInfo[s.playerID]=s,this.battleInfo._chairToInfo[s.chair]=s,s.playerID==this.userId&&(this.battleInfo.ownerIndex=t)}e.info.length>0&&!SceneManager.isInPlayScene()&&(this._netBattleStep||(this._netBattleStep=this._node.addComponent("NBattleStep").init(),this._netBattleStep.setListener(function(e){this._stepsCache.push(e)}.bind(this)))),this._localPlayersDataChange.dispatch()}},_onQuitRoomRespone:function(e){if(this.battleInfo.ownerIndex=-1,e.res==eServerResult.QuitRoomSuccess){for(var t=this.battleInfo.playerInfos,s=0;s<t.length;s++)if(t[s].playerID==e.quitter){this.battleInfo._playerIDToInfo[t[s].playerID]=void 0,this.battleInfo._chairToInfo[t[s].chair]=void 0,t.splice(s,1);for(s=0;s<t.length;s++)t[s].playerID==this.userId&&(this.battleInfo.ownerIndex=s);break}this._localPlayersDataChange.dispatch()}},_onTutorialRes:function(e){this.isNewPlayer&&(this.isNewPlayer=1!=e.isSucceed)},_onCoinsUpdate:function(e){this.coins=this.gems=e.num,EventManager.send(eLocalEvent.UpdateCardsAndBeans)}}),cc._RF.pop()},{}],GameListCell:[function(e,t,s){"use strict";cc._RF.push(t,"7fe94i2OEtJp7wsVjlHMZ2J","GameListCell"),cc.Class({extends:cc.Component,properties:{spCoin10:cc.Node,spCoin20:cc.Node,spCoin50:cc.Node,spCoin100:cc.Node,spHand1:cc.Node,spHand4:cc.Node,spLock:cc.Node,spSelect:cc.Node,lblLimit:cc.Label,gameInfo:{default:{}},context:null},onLoad:function(){},init:function(e,t){this.gameInfo=e,this.context=t,this.updateUI()},updateUI:function(){this.spLock.active=this.gameInfo.enterMinCoin>GameData.coins,this["spCoin"+this.gameInfo.scoreCoinRatio].active=!0,this["spHand"+this.gameInfo.roundNum].active=!0,this.lblLimit.string=this.gameInfo.enterMinCoin+"+"},onClick:function(){this.spLock.active||(AudioManager.playSFX("effects/game_select.mp3"),this.spSelect.active=!0,this.context.onSelectCell(this),this.context.enterGame())},unselect:function(){this.spSelect.active=!1},getInfo:function(){return this.gameInfo}}),cc._RF.pop()},{}],GameListData:[function(e,t,s){"use strict";cc._RF.push(t,"85e09XyJ31Mh6V2vfyhl2Ut","GameListData"),cc.Class({properties:{listData:[]},init:function(){this.loadGameListData()},loadGameListData:function(){this.listData=e("GameList_json")},getListByTab:function(e){var t=[];return this.listData.forEach(function(s){s.tab==e&&t.push(s)},this),t},getFastPlayData:function(e){var t=this.getListByTab(e);t.sort(function(e,t){return t.enterMinCoin-e.enterMinCoin});for(var s=null,n=t.length-1;n>=0;n--)if(t[n].enterMinCoin<=GameData.coins){s=t[n];break}return s},getDataById:function(e){for(var t=0;t<this.listData.length;t++)if(this.listData[t].id==e)return this.listData[t];return null}}),cc._RF.pop()},{GameList_json:"GameList_json"}],GameList_json:[function(e,t,s){"use strict";cc._RF.push(t,"3e749QAA5FEEYtWH0PsvrUa","GameList_json"),t.exports=[{id:1,tab:0,playerNum:4,roundTp:1,roundNum:1,cost:10,costCoinType:0,scoreCoinRatio:10,robotInitCoinRange:"2000,5000",enterMinCoin:100,"":"接龙"},{id:2,tab:0,playerNum:4,roundTp:1,roundNum:1,cost:20,costCoinType:0,scoreCoinRatio:20,robotInitCoinRange:"4000,12000",enterMinCoin:200,"":"接龙"},{id:3,tab:0,playerNum:4,roundTp:1,roundNum:1,cost:50,costCoinType:0,scoreCoinRatio:50,robotInitCoinRange:"12000,40000",enterMinCoin:500,"":"接龙"},{id:4,tab:0,playerNum:4,roundTp:1,roundNum:1,cost:100,costCoinType:0,scoreCoinRatio:100,robotInitCoinRange:"25000,100000",enterMinCoin:1e3,"":"接龙"},{id:1001,tab:1,playerNum:4,roundTp:1,roundNum:1,cost:10,costCoinType:0,scoreCoinRatio:10,robotInitCoinRange:"2000,5000",enterMinCoin:100,"":"斩龙"},{id:1002,tab:1,playerNum:4,roundTp:1,roundNum:1,cost:20,costCoinType:0,scoreCoinRatio:20,robotInitCoinRange:"4000,12000",enterMinCoin:200,"":"斩龙"},{id:1003,tab:1,playerNum:4,roundTp:1,roundNum:1,cost:50,costCoinType:0,scoreCoinRatio:50,robotInitCoinRange:"12000,40000",enterMinCoin:500,"":"斩龙"},{id:1004,tab:1,playerNum:4,roundTp:1,roundNum:1,cost:100,costCoinType:0,scoreCoinRatio:100,robotInitCoinRange:"25000,100000",enterMinCoin:1e3,"":"斩龙"}],cc._RF.pop()},{}],GameList:[function(e,t,s){"use strict";cc._RF.push(t,"0ee6cfA191HSoJ46MzIsra7","GameList"),cc.Class({extends:cc.Component,properties:{pfbListCell:cc.Prefab,ndContent:cc.Layout,maskContentView:cc.Node,tglMatch:cc.Toggle,tglCreate:cc.Toggle,isPersonal:{get:function(){return Boolean(this.tglCreate&&this.tglCreate.isChecked)},set:function(e){this._isPersonal=e||!1,this._isPersonal?this.tglCreate&&this.tglCreate.check():this.tglMatch&&this.tglMatch.check()}},cellArr:[],selected:null},onLoad:function(){this.node.setContentSize(cc.winSize),this.initCells()},initCells:function(){var e=GameListData.getListByTab(eTabType.JieLong),t=cc.instantiate(this.pfbListCell);t.width*e.length<this.maskContentView.width&&(this.ndContent.spacingX=this.maskContentView.width/e.length-t.width,this.ndContent.paddingLeft=this.ndContent.spacingX/2),e.forEach(function(e){var t=cc.instantiate(this.pfbListCell);t.getComponent("GameListCell").init(e,this),this.cellArr.push(t.getComponent("GameListCell")),this.ndContent.node.addChild(t)},this)},onSelectCell:function(e){this.cellArr.forEach(function(t){e!=t&&t.unselect()},this),this.selected=e},onEnterClick:function(e,t){null!=this.selected?(AudioManager.playSFX("effects/enter.mp3"),this.enterGame()):TipsManager.showTips(CText.selectGameTips)},enterGame:function(){var e=u_clone(this.selected.getInfo());e.isPersonal=this.isPersonal,cc.log("加入游戏：",e),EventManager.dispatch(EventCode.LJoinGame,e)},onBackClick:function(){AudioManager.playSFX("effects/return.mp3"),this.node.active=!1},open:function(e){this.node.active=!0,this.isPersonal=e,this.onSelectCell()}}),cc._RF.pop()},{}],GameMatch:[function(e,t,s){"use strict";cc._RF.push(t,"04eecj5dT5FLJ6k2rFq3VNG","GameMatch"),cc.Class({extends:cc.Component,properties:{lblMatchInfo:cc.Label,lblMatchTime:cc.Label,_tabTypeToText:{default:{}},_data:null},onLoad:function(){this.node.setContentSize(cc.winSize),this._tabTypeToText[eTabType.JieLong]="接龙",this._tabTypeToText[eTabType.ZhanLong]="斩龙"},onEnable:function(){this.lblMatchInfo.string=u_format(CText.matchInfo,this._data.scoreCoinRatio,this._tabTypeToText[this._data.tab]);var e=Date.now();this.lblMatchTime.string=u_toTimeString(0,"%h:%m:%s"),this.schedule(function(){this.lblMatchTime.string=u_toTimeString(Date.now()-e,"%h:%m:%s")},1)},onQuitMatch:function(){AudioManager.playSFX("effects/button_click.mp3"),this.close()},open:function(e){this._data=e,this.node.active=!0},close:function(){this.node.active=!1,this.unscheduleAllCallbacks()}}),cc._RF.pop()},{}],HallScene:[function(e,t,s){"use strict";cc._RF.push(t,"fc751WLS1tCEIbeSc0PQ4hn","HallScene"),cc.Class({extends:cc.Component,properties:{Dialog_Setting:cc.Node,Dialog_Activity:cc.Node,Dialog_Excharge:cc.Node,Dialog_Help:cc.Node,Dialog_GameList:cc.Node,Dialog_GameMatch:cc.Node,Label_PlayerName:cc.Label,Label_PlayerId:cc.Label,Label_PlayerCard:cc.Label,btnDole:cc.Button,btnClassMode:cc.Button,imgHeadIcon:cc.Sprite,_onUpdateCardsAndBeansEvent:null,_onPayBack:null,_joinGameHandler:null,_onDoleStateRespone:null,_curDoleState:{default:{}}},onLoad:function(){AudioManager.playBGM("music/bgm_hall.mp3"),this.Label_PlayerName.string=GameData.userName,this.Label_PlayerId.string="ID:"+GameData.userId,this.getDailyTaskInfo(),this.initDoleButton(),!Config.isGuestMode&&this.updateHeadIcon();var e=this.Dialog_Setting.getComponent("Setting");cc.sys.os===cc.sys.OS_OSX?(e.showQuitButton=!0,e.hallEnter=!0):e.showQuitButton=!1,this._onUpdateCardsAndBeansEvent=function(){this.Label_PlayerCard.string=GameData.gems}.bind(this),EventManager.addListener(eLocalEvent.UpdateCardsAndBeans,this._onUpdateCardsAndBeansEvent),this._onUpdateCardsAndBeansEvent(),this._onPayBack=function(e){cc.log("onPayBack:"+e.result),1==e.result&&(GameData.gems=e.count,GameData.coins=e.count,EventManager.send(eLocalEvent.UpdateCardsAndBeans),TipsManager.showTipsBox(CText.paySuc,[1]))}.bind(this),NetManager.addListener(EventCode.NPayBack,this._onPayBack),this._joinGameHandler=function(e){var t=this.node.getComponent("NewGame");t.data.costId=e.id,t.data.tabType=e.tab,t.data.isPersonal=e.isPersonal,t.create(function(){}.bind(this)),!t.data.isPersonal&&this.Dialog_GameMatch.getComponent("GameMatch").open(e)}.bind(this),EventManager.addListener(EventCode.LJoinGame,this._joinGameHandler),this._onDoleStateRespone=function(e){switch(e.type){case"find_dole":this._curDoleState.doleCount=[e.receivedTimes||0,e.avaiableTimes||0],this._curDoleState.doleContent=e.avaiableGold||0,this._curDoleState.doleLimit=e.conditionGold||0,this.updateDoleButton();break;case"receive_dole":1e3==e.resultCode&&(GameData.gems+=this._curDoleState.doleContent,this._curDoleState.doleCount[0]=e.receivedTime,EventManager.send(eLocalEvent.UpdateCardsAndBeans),this.updateDoleButton()),TipsManager.showTipsBox(u_format(CText["doleResultCode"+e.resultCode],this._curDoleState.doleContent))}}.bind(this),NetManager.addListener(EventCode.NDole,this._onDoleStateRespone),NetManager.send(EventCode.NDole,{type:"find_dole"}),this.showHideClassModeBtn()},start:function(){GameData.battleInfo.roomID&&0!=GameData.battleInfo.roomID&&"null"!=GameData.battleInfo.roomID&&this.Dialog_GameMatch.getComponent("GameMatch").open(GameListData.getDataById(GameData.battleInfo.costID))},onDestroy:function(){this._joinGameHandler&&EventManager.removeListener(EventCode.LJoinGame,this._joinGameHandler),this._onUpdateCardsAndBeansEvent&&EventManager.removeListener(eLocalEvent.UpdateCardsAndBeans,this._onUpdateCardsAndBeansEvent),this._onDoleStateRespone&&NetManager.removeListener(EventCode.NDole,this._onDoleStateRespone),this._onPayBack&&NetManager.removeListener(EventCode.NPayBack,this._onPayBack)},onDoleClick:function(){NetManager.send(EventCode.NDole,{type:"receive_dole"})},initDoleButton:function(){this.btnDole.node.on(cc.Node.EventType.TOUCH_END,function(){this._curDoleState&&!this._curDoleState.canDole&&TipsManager.showTipsBox(this._curDoleState.tipsText)}.bind(this))},updateDoleButton:function(){this._curDoleState.canDole=!0,GameData.gems>=this._curDoleState.doleLimit?(this._curDoleState.tipsText=u_format(CText.doleLimitNotReach,this._curDoleState.doleLimit),this._curDoleState.canDole=!1):this._curDoleState.doleCount[0]==this._curDoleState.doleCount[1]&&(this._curDoleState.tipsText=u_format(CText.doleMaxCount),this._curDoleState.canDole=!1),this.btnDole.interactable=this._curDoleState.canDole},updateHeadIcon:function(){u_createSpriteFrame(GameData.head,function(e){this.imgHeadIcon&&(this.imgHeadIcon.spriteFrame=e)}.bind(this),eResType.absUrl)},onCreateRoomClick:function(){AudioManager.playSFX("effects/button_click.mp3"),this.Dialog_GameList.getComponent("GameList").open(!0)},onMatchGameClick:function(){AudioManager.playSFX("effects/button_click.mp3"),this.Dialog_GameList.getComponent("GameList").open(!1)},onClassModeClick:function(){AudioManager.playSFX("effects/enter.mp3"),GameData.gameMode=eGameMode.Class,SceneManager.enterPlayScene()},onHeadClick:function(){AudioManager.playSFX("effects/button_click.mp3"),TipsManager.showPlayerInfoTips(GameData.userName,GameData.userId,GameData.userIp,GameData.head)},onClickBuyCard:function(){AudioManager.playSFX("effects/button_click.mp3"),this.Dialog_Excharge.active=!0},onBtnActivityClick:function(){AudioManager.playSFX("effects/button_click.mp3"),this.Dialog_Activity.getComponent("DailyTask").initUI(),this.Dialog_Activity.active=!0},onHelpClick:function(){AudioManager.playSFX("effects/button_click.mp3"),this.Dialog_Help.active=!0},onSettingClick:function(){AudioManager.playSFX("effects/button_click.mp3"),this.Dialog_Setting.active=!0},onLogOutRes:function(e){e.res==eServerResult.LOGOUT_KICKOFF?TipsManager.showTipsBox(CText.logoutByKick,[1],this.logOutAction.bind(this)):e.res==eServerResult.LOGOUT_FORBID&&TipsManager.showTipsBox(CText.logoutByForbid,[1],this.logOutAction.bind(this))},logOutAction:function(){SceneManager.enterLoginScene(),NetManager.close(EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_QUIT)},getDailyTaskInfo:function(){var e={};e.type="Get_View",NetManager.sendWithListener("h.daily_task",e,this.onTaskResponse_hall)},onTaskResponse_hall:function(e){"Get_View"==e.type&&DailyTaskData.initTaskInfo(e)},showHideClassModeBtn:function(){this.btnClassMode.node.active=0==Storage.finishClassMode}}),cc._RF.pop()},{}],HeartbeatService:[function(e,t,s){"use strict";cc._RF.push(t,"27006wZwThEMpzXhBWorQvn","HeartbeatService");var n=e("timers");cc.Class({properties:{keepaliveinterval:0,requestErrorCount:0,isLogicPackActive:!1,heartbeatHandler:null,timeOutHandler:null,heartbeatRetHandler:null,MAX_LOST_HEART_NUMBER:3e3},ctor:function(){cc.log("HeartbeatService ctor"),this.init()},init:function(){this.keepaliveinterval=5,this.requestErrorCount=0,this.heartbeatHandler=this.heartbeat.bind(this),this.isLogicPackActive=!1},exit:function(){this.closeHeartbeatTimer(),NetManager.removeListener(EventCode.SFS_EVENT_CUSTOM_PING,this.heartbeatRetHandler)},receivedLogicMessage:function(){this.isLogicPackActive=!0,this.requestErrorCount=0},openHeartbeat:function(){null==this.heartbeatRetHandler&&(this.heartbeatRetHandler=this.onHeartbeatRet.bind(this),NetManager.addListener(EventCode.SFS_EVENT_CUSTOM_PING,this.heartbeatRetHandler)),this.requestErrorCount=0,this.timer=(0,n.setInterval)(this.heartbeatHandler,this.keepaliveinterval)},closeHeartbeat:function(){cc.log("closeHeartbeat"),(0,n.clearInterval)(this.timer)},SetHeartbeatTimeoutHandler:function(e){this.timeOutHandler=e},heartbeat:function(){++this.requestErrorCount<=this.MAX_LOST_HEART_NUMBER?this.sendHeartbeat():(this.closeHeartbeat(),this.timeOutHandler&&this.timeOutHandler())},sendHeartbeat:function(){NetManager.send(EventCode.SFS_EVENT_CUSTOM_PING,{})},onHeartbeatRet:function(e,t){this.requestErrorCount=0}}),cc._RF.pop()},{timers:2}],Help:[function(e,t,s){"use strict";cc._RF.push(t,"de772YvTRRDo4WaoWqW+Bji","Help"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.setContentSize(cc.winSize)},onClose:function(){AudioManager.playSFX("effects/return.mp3"),this.node.active=!1}}),cc._RF.pop()},{}],HttpHelper:[function(e,t,s){"use strict";cc._RF.push(t,"f26bc8wLCFNOYTsnEMwPUuP","HttpHelper"),cc.Class({properties:{},sendRequest:function(e,t,s){var n=cc.loader.getXMLHttpRequest();n.timeout=1e4;var i="?";for(var o in t)"?"!=i&&(i+="&"),i+=o+"="+t[o];var a=e+encodeURI(i);return cc.log("RequestURL:"+a),n.open("GET",a,!0),cc.sys.isNative&&n.setRequestHeader("Accept-Encoding","gzip,deflate","text/html;charset=UTF-8"),n.onerror=function(e){cc.log("xhr error!!!:\n",e)},n.onreadystatechange=function(){if(cc.log("xhr respone readyState: "+n.readyState+" responseText: "),cc.log(n.responseText),4===n.readyState&&n.status>=200&&n.status<300){var e={};if(n.responseText)try{e=JSON.parse(n.responseText)}catch(e){cc.log("error:",e)}cc.log("http request results("+n.responseText.length+") data:",e),null!==s&&s(e)}},n.send(),n}}),cc._RF.pop()},{}],JoinGame:[function(e,t,s){"use strict";cc._RF.push(t,"082e4Or/idFHauEdGxJITJM","JoinGame"),cc.Class({extends:cc.Component,properties:{data:{visible:!1,get:function(){return this._netJoinRoom&&this._netJoinRoom.data}},_callback:null,_netJoinRoom:cc.Component},_onJoinRoomRespone:function(e){switch(this._netJoinRoom.setListener(null),e.res){case eServerResult.EnterRoomSuccess:break;case eServerResult.InvaildRoomId:case eServerResult.AllreadyInTheRoom:case eServerResult.RoomFull:default:GameData.newBattleInfo(),SceneManager.enterHallScene(function(t){t&&TipsManager.showServerErrTips(e)})}},_onPlayerDataChange:function(){GameData.battleInfo.playerInfos.length<4&&!GameData.battleInfo.isPersonal?SceneManager.enterHallScene():(this._localPlayersDataChange.setListener(null),SceneManager.enterPlayScene())},onLoad:function(){this.init()},init:function(){return this._netJoinRoom=this.addComponent("NJoinRoom").init(),this._localPlayersDataChange=this.addComponent("LPlayersDataChange").init(),this},join:function(e){e&&0!=e&&"null"!=e?(this._netJoinRoom.setListener(this._onJoinRoomRespone.bind(this)),this._localPlayersDataChange.setListener(this._onPlayerDataChange.bind(this)),this.data.roomid=e+"",this._netJoinRoom.send()):SceneManager.enterHallScene()}}),cc._RF.pop()},{}],JoinRoom:[function(e,t,s){"use strict";cc._RF.push(t,"b98d8Vai81A0qeKzaCBSbOB","JoinRoom"),cc.Class({extends:cc.Component,properties:{nums:{default:[],type:[cc.Label]},_inputIndex:0},onLoad:function(){this.onResetClick()},onEnable:function(){this.onResetClick()},close:function(){this.node.active=!1},onInputFinished:function(e){this.node.getComponent("JoinGame").join(e)},onNumberClick:function(e,t){if(!(this._inputIndex>=this.nums.length)){var s=t;if(this.nums[this._inputIndex].string=s,this._inputIndex+=1,this._inputIndex==this.nums.length){var n=this.parseRoomID();console.log("ok:"+n),this.onInputFinished(n)}}},onDelClick:function(){this._inputIndex>0&&(this._inputIndex-=1,this.nums[this._inputIndex].string="")},onResetClick:function(){for(var e=0;e<this.nums.length;++e)this.nums[e].string="";this._inputIndex=0},parseRoomID:function(){for(var e="",t=0;t<this.nums.length;++t)e+=this.nums[t].string;return e}}),cc._RF.pop()},{}],LFinalReport:[function(e,t,s){"use strict";cc._RF.push(t,"de326JIR1RGrYlL5/cPXUMy","LFinalReport"),cc.Class({extends:e("LocalEvent"),properties:{},ctor:function(){}}),cc._RF.pop()},{LocalEvent:"LocalEvent"}],LPlayersDataChange:[function(e,t,s){"use strict";cc._RF.push(t,"cf03e7WBmtGh7p1AJqDPb08","LPlayersDataChange"),cc.Class({extends:e("LocalEvent"),properties:{},ctor:function(){}}),cc._RF.pop()},{LocalEvent:"LocalEvent"}],LShowChatMessage:[function(e,t,s){"use strict";cc._RF.push(t,"427d7bIyGZIjbE5FIZQQ/ht","LShowChatMessage"),cc.Class({extends:e("LocalEvent"),properties:{},ctor:function(){this.data.accountID="",this.data.type=0,this.data.content=""}}),cc._RF.pop()},{LocalEvent:"LocalEvent"}],LUpdateCardsAndBeans:[function(e,t,s){"use strict";cc._RF.push(t,"a3cbcCa/gpDmJcP0WsiWIzP","LUpdateCardsAndBeans"),cc.Class({extends:e("LocalEvent"),properties:{},ctor:function(){}}),cc._RF.pop()},{LocalEvent:"LocalEvent"}],LUpdateToggle:[function(e,t,s){"use strict";cc._RF.push(t,"7edd6yDxx1EtrkIdtkBSHUt","LUpdateToggle"),cc.Class({extends:e("LocalEvent"),properties:{selectedNode:cc.Node,selectedData:{default:[],type:cc.String}},ctor:function(){this.data.selectedNode=this.selectedNode,this.data.selectedData=this.selectedData},sendOnClick:function(e,t){this.data={selectedNode:e,selectedData:t||""},this.send()},dispatchOnClick:function(e,t){this.data={selectedNode:e,selectedData:t||""},this.dispatch()}}),cc._RF.pop()},{LocalEvent:"LocalEvent"}],LayerManager:[function(e,t,s){"use strict";cc._RF.push(t,"31cc58IeexEuL3aK75C1HrD","LayerManager"),cc.Class({properties:{},create:function(e,t){this.closeByName(e);var s="Prefab/"+e;cc.loader.loadRes(s,function(s,n){if(s)cc.log("LayerManager.create,error,modelNm:"+e);else{var i=cc.instantiate(n);cc.director.getScene().addChild(i),i.getComponent(e).init(t),i.x=cc.visibleRect.center.x,i.y=cc.visibleRect.center.y}})},closeByName:function(e){var t=cc.director.getScene().getChildByName(e);null!=t&&t.removeFromParent(!0)}}),cc._RF.pop()},{}],LocalEvent:[function(e,t,s){"use strict";cc._RF.push(t,"bc5a05VicNKbYLLGCgIkFm1","LocalEvent"),cc.Class({extends:cc.Component,properties:{msg:{default:"",visible:!1},data:{default:{},visible:!1},handler:{default:null,visible:!1},listener:cc.Component.EventHandler},onLoad:function(){this.init()},onEnable:function(){this.setListener(this.handler)},onDisable:function(){this.removeListener()},onDestroy:function(){this.removeListener()},init:function(){var e=this.name.split(/[<>]/)[1];return this.msg=EventCode[e]||e,this.listener&&(this.handler=function(e){this.listener.emit([e])}.bind(this)),this.setListener(this.handler),this},setListener:function(e){this.removeListener(),this.handler=e,this.handler&&EventManager.addListener(this.msg,this.handler)},removeListener:function(){this.handler&&EventManager.removeListener(this.msg,this.handler)},send:function(){EventManager.send(this.msg,this.data)},dispatch:function(){EventManager.dispatch(this.msg,this.data)}}),cc._RF.pop()},{}],LoginGame:[function(e,t,s){"use strict";cc._RF.push(t,"fbc4blJ3ZlFt50P5IBQ+BXV","LoginGame"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.log("cc.director.getScene().name:",cc.director.getScene().name)},login:function(e){Config.isGuestMode?this.loginWithGuest(e):cc.sys.isNative?this.loginWithNative(e):this.loginWithWeb(e)},loginWithGuest:function(e){var t={uid:Config.localParams.account||Config.defaultAccount,channel:Config.channel};this.loginToServer(t,e)},loginWithWeb:function(e){var t={sign:Config.localParams.sign,user_uid:Config.localParams.user_uid,user_gender:Config.localParams.user_gender,user_img_url:encodeURIComponent(Config.localParams.user_img_url),token:encodeURIComponent(Config.localParams.token),user_name:Config.localParams.user_name,deviceid:"1",channel:Config.channel,region:1};this.loginToServer(t,e)},loginWithNative:function(e){SDK.login(function(t,s){if(t){var n={deviceid:"1",channel:Config.channel,region:1,code:s};this.loginToServer(n,e)}else e&&e(!1)}.bind(this))},loginToServer:function(e,t){var s=function(){NetManager.connectToHall(function(e){t&&t(e)})};TipsManager.showLoadingTips(),NetManager.loginGame(e,function(e){TipsManager.closeLoadingTips(),e?GameData.battleInfo.roomID&&0!=GameData.battleInfo.roomID&&"null"!=GameData.battleInfo.roomID&&Config.localParams.friend_code?TipsManager.showTipsBox(CText.loginAreadyJion,[],function(){s()}):s():t&&t(!1)}.bind(this))}}),cc._RF.pop()},{}],LoginScene:[function(e,t,s){"use strict";cc._RF.push(t,"505c5Mj7n5JeJsapCRQdp6M","LoginScene"),cc.Class({extends:cc.Component,properties:{nodeLoginButtons:cc.Node,tglWxLogin:cc.Toggle,tglGuestLogin:cc.Toggle,edAccount:cc.EditBox},onLoad:function(){Config.isGuestMode?(this.tglGuestLogin.node.active=!0,this.edAccount.node.active=!0,this.edAccount.string=Storage.inputAccount):this.onClickLogin()},onClickLogin:function(){if(Config.isGuestMode){var e=this.edAccount.string;e&&""!=e&&(Config.localParams.account=e,Storage.inputAccount=e)}this.node.getComponent("LoginGame").login(function(e){e||(this.nodeLoginButtons.active=cc.sys.isNative,Config.isGuestMode?this.tglGuestLogin.check():this.tglWxLogin.check(),!cc.sys.isNative&&this.onClickLogin())}.bind(this))}}),cc._RF.pop()},{}],NBattleStep:[function(e,t,s){"use strict";cc._RF.push(t,"0a815WU+3NN560mUIw6kEW/","NBattleStep"),cc.Class({extends:e("NetEvent"),ctor:function(){}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NCardExchange:[function(e,t,s){"use strict";cc._RF.push(t,"b3508V1SJBPfIGgaqRLrQ37","NCardExchange"),cc.Class({extends:e("NetEvent"),ctor:function(){this.data.card=0}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NChatMessage:[function(e,t,s){"use strict";cc._RF.push(t,"ab0e1wkYF9EdpRmvcKL1WJQ","NChatMessage"),cc.Class({extends:e("NetEvent"),ctor:function(){this.data.content=0,this.data.sendTime=0}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NCreateRoom:[function(e,t,s){"use strict";cc._RF.push(t,"be6b4jCdxNOGKeZ9FE49qdT","NCreateRoom"),cc.Class({extends:e("NetEvent"),ctor:function(){this.data.costId=0,this.data.tabType=eTabType.JieLong,this.data.isPersonal=!1}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NDestroyRoom:[function(e,t,s){"use strict";cc._RF.push(t,"17f88vjvbhOo7eIwXuWc2zY","NDestroyRoom"),cc.Class({extends:e("NetEvent"),ctor:function(){}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NJoinRoom:[function(e,t,s){"use strict";cc._RF.push(t,"e796dl2rwhEtYekUNvjQGNi","NJoinRoom"),cc.Class({extends:e("NetEvent"),ctor:function(){this.data.roomid=0,this.data.x=-2,this.data.y=-2}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NLogOut:[function(e,t,s){"use strict";cc._RF.push(t,"f4ac4rCYshH9bOGtDVJ/Cqu","NLogOut"),cc.Class({extends:e("NetEvent"),ctor:function(){}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NQuitRoom:[function(e,t,s){"use strict";cc._RF.push(t,"6a8f2LN/CtFCI4C2s8LehB2","NQuitRoom"),cc.Class({extends:e("NetEvent"),ctor:function(){}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NRobotMode:[function(e,t,s){"use strict";cc._RF.push(t,"b4057qe7bpPkJnKIW+Ok1Oe","NRobotMode"),cc.Class({extends:e("NetEvent"),ctor:function(){this.data.auto=!0}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NUserUpdate:[function(e,t,s){"use strict";cc._RF.push(t,"c9d55tSsshHvYgkOruDKsM5","NUserUpdate"),cc.Class({extends:e("NetEvent"),ctor:function(){}}),cc._RF.pop()},{NetEvent:"NetEvent"}],NetEvent:[function(e,t,s){"use strict";cc._RF.push(t,"154e8Tc1sJPeL+XsHpjOC5Y","NetEvent"),cc.Class({extends:cc.Component,properties:{msg:{default:"",visible:!1},data:{default:{},visible:!1},handler:{default:null,visible:!1},listener:cc.Component.EventHandler},onLoad:function(){this.init()},onEnable:function(){this.setListener(this.handler)},onDisable:function(){this.removeListener()},onDestroy:function(){this.removeListener()},init:function(){var e=this.name.split(/[<>]/)[1];return this.msg=EventCode[e]||e,this.listener&&(this.handler=function(e){this.listener.emit([e])}.bind(this)),this.setListener(this.handler),this},setListener:function(e){this.removeListener(),this.handler=e,this.handler&&NetManager.addListener(this.msg,this.handler)},removeListener:function(){this.handler&&NetManager.removeListener(this.msg,this.handler)},send:function(){NetManager.send(this.msg,this.data)}}),cc._RF.pop()},{}],NetManager:[function(e,t,s){"use strict";cc._RF.push(t,"d2a08y33pFFpp5uVlabn/4A","NetManager"),cc.Class({properties:{listeners:{default:{}},reconnectMaxTimes:3,reconnectTimes:0,heartbeatService:null},ctor:function(){SocketHelper.connectedHandler=this._onConnected.bind(this),SocketHelper.disConnectedHandler=this._onDisConnected.bind(this),SocketHelper.loginHandler=this._onLogin.bind(this),SocketHelper.joinHandler=this._onJoin.bind(this),SocketHelper.recivedHandler=this._onRecived.bind(this),this.heartbeatService=new(e("HeartbeatService")),this.heartbeatService.SetHeartbeatTimeoutHandler(this.onHeartbeatTimeout.bind(this))},_onConnected:function(){},_onDisConnected:function(e){e!=SFS2X.Utils.ClientDisconnectionReason.MANUAL&&(e==SFS2X.Utils.ClientDisconnectionReason.IDLE?cc.log("A disconnection occurred due to inactivity"):e==SFS2X.Utils.ClientDisconnectionReason.KICK?cc.log("You have been kicked by the moderator"):e==SFS2X.Utils.ClientDisconnectionReason.BAN?cc.log("You have been banned by the moderator"):cc.log("A disconnection occurred due to unknown reason; please check the server log")),this.heartbeatService.closeHeartbeat(),cc.log("self.closeReason",this.closeReason),e!=EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_MANUAL&&this.closeReason!=EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_QUIT&&this.closeReason!=EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_MANUAL&&(this.closeReason,EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_PING,++this.reconnectTimes>this.reconnectMaxTimes||this._reconnect(this.closeReason))},_reconnect:function(e){this.connectToHall()},_onLogin:function(){},_onJoin:function(){},_onRecived:function(e){this.dispatch(e.cmd,e.params||{})},addListener:function(e,t){this.listeners[e]=this.listeners[e]||[],this.removeListener(e,t),this.listeners[e].push(t)},removeListener:function(e,t){if(this.listeners[e])for(var s=0;s<this.listeners[e].length;s++)if(this.listeners[e][s]===t){this.listeners[e].splice(s,1);break}},send:function(e,t){SocketHelper.send(e,t)},sendWithListener:function(e,t,s){this.listeners[e]=this.listeners[e]||[],this.removeListener(e,s),this.listeners[e].push(s),SocketHelper.send(e,t)},dispatch:function(e,t){this.heartbeatService.receivedLogicMessage();t.res||t.result;if(e==EventCode.SFS_EVENT_SERVER_ERROR&&TipsManager.showServerErrTips(t),this.listeners[e])for(var s=0;s<this.listeners[e].length;s++)this.listeners[e][s](t)},loginGame:function(e,t){HttpHelper.sendRequest(Config.urlLoginGame,e,function(e){0==e.result?(GameData.account=e.ID,GameData.token=e.token,GameData.userName=e.name,GameData.userSex=e.sex,GameData.head=e.head,GameData.userId=e.unionid,GameData.userIp=e.ip,GameData.gems=e.coin0,GameData.coins=e.coin0,GameData.battleInfo.roomID=e.room,t&&t(!0)):(cc.log(CText.loginError),TipsManager.showTipsBox(CText.loginError),t&&t(!1))}),this.reconnectTimes=0},connectToHall:function(e){SocketHelper.connectedHandler=function(t){t.success?(cc.log("begin login to hall!!!"),SocketHelper.login(GameData.account,GameData.token,Config.sfsZone)):(cc.log("connect to hall failed!"),e&&e(!1))}.bind(this),SocketHelper.disConnectedHandler=this._onDisConnected.bind(this),SocketHelper.loginHandler=function(t){TipsManager.closeConnectTips(),t.res?(this.reconnectTimes=0,this.heartbeatService.openHeartbeat(),e&&e(!0)):(cc.log("login to hall failed!"),SocketHelper.disconnect(),e&&e(!1))}.bind(this),cc.log("begin connect to hall!"),TipsManager.showConnectTips(),SocketHelper.connect(Config.hallServerAddr.ip,Config.hallServerAddr.port)},connectToGame:function(e){SocketHelper.connectedHandler=function(t){t.success?(cc.log("begin login to game!"),SocketHelper.login(GameData.account,GameData.token,Config.sfsRoomZone)):(cc.log("connect to game failed!"),e&&e(!1))}.bind(this),SocketHelper.disConnectedHandler=this._onDisConnected.bind(this),SocketHelper.loginHandler=function(t){TipsManager.closeConnectTips(),t.res?(this.reconnectTimes=0,this.heartbeatService.openHeartbeat(),e&&e(!0)):(cc.log("login to game failed!"),SocketHelper.disconnect(),e&&e(!1))}.bind(this),cc.log("begin connect to game!"),TipsManager.showConnectTips(),SocketHelper.connect(GameData.gameServerAddr.ip,GameData.gameServerAddr.port)},joinRoom:function(e,t){SocketHelper.joinHandler=function(s){s.res?t&&t(!0):(cc.log("join to "+e+" failed!"),t&&t(!1))}.bind(this),SocketHelper.join(e)},close:function(e){cc.log("close reason:",e),this.closeReason=e,SocketHelper.disconnect(e)},onHeartbeatTimeout:function(){this.close(EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_PING)}}),cc._RF.pop()},{HeartbeatService:"HeartbeatService"}],NewGame:[function(e,t,s){"use strict";cc._RF.push(t,"10da0mmExVAq55R4IGI6unF","NewGame"),cc.Class({extends:cc.Component,properties:{data:{get:function(){return this._netCreateRoom&&this._netCreateRoom.data},set:function(e){this._netCreateRoom.data=e}},_callback:null,_netGetServer:cc.Component,_netCreateRoom:cc.Component,_netJoinRoom:cc.Component,_localPlayersDataChange:cc.Component},_onCreateRoomRespone:function(e){e.res==eServerResult.CreateRoomSuccess?this._callback&&this._callback():TipsManager.showServerErrTips(e,function(){})},_onPlayerDataChange:function(){GameData.battleInfo.playerInfos.length<4&&!GameData.battleInfo.isPersonal?SceneManager.enterHallScene():SceneManager.enterPlayScene()},onLoad:function(){this._netCreateRoom=this.addComponent("NCreateRoom"),this._netCreateRoom.setListener(this._onCreateRoomRespone.bind(this)),this._localPlayersDataChange=this.addComponent("LPlayersDataChange").init(),this._localPlayersDataChange.setListener(this._onPlayerDataChange.bind(this))},create:function(e){this._callback=e,this._netCreateRoom.send()}}),cc._RF.pop()},{}],PFinalReport:[function(e,t,s){"use strict";cc._RF.push(t,"0a28bOyvERA3aq98d4is0Xf","PFinalReport"),cc.Class({extends:cc.Component,properties:{nodeWinner:cc.Node,lblClock:cc.Label,arrPlayerList:{type:cc.Node,default:[]},closeCallback:{visible:!1,default:null},_openTime:0,openTime:{visible:!1,get:function(){return Math.ceil(this._openTime)},set:function(e){this._openTime=parseFloat(e)||0,this._tickFunc&&this.unschedule(this._tickFunc),this._openTime>0&&(this._tickFunc=function(e){this._openTime-=e,this.openTime<=0&&(this.openTime=0,this.unschedule(this._tickFunc),this._tickFunc=void 0),this.lblClock.string=this.openTime}.bind(this),this.schedule(this._tickFunc,1)),this.lblClock.string=this.openTime}},_data:null,_closeType:"normal"},onLoad:function(){this.node.setContentSize(cc.winSize)},onEnable:function(){this.openTime=10,this.node.runAction(cc.sequence(cc.delayTime(this.openTime),cc.callFunc(this.close,this))),this._data&&(u_dump(this._data,"PFinalReport"),this._data.playerDatas.forEach(function(e,t){var s=this.arrPlayerList[t];cc.find(e.winnerId==e.playerId?"tglWin":"tglLose",s).getComponent(cc.Toggle).check(),this.nodeWinner.active=e.winnerId==GameData.userId,e.winnerId==GameData.userId?AudioManager.playSFX("effects/win.mp3"):AudioManager.playSFX("effects/lose.mp3");var n=GameData.battleInfo.playerIDToInfo[e.playerId];cc.find("name",s).getComponent(cc.Label).string=n.name;var i=cc.find("Avatar/icon",s).getComponent(cc.Sprite);n.head&&u_createSpriteFrame(n.head,function(e){i.isValid&&(i.spriteFrame=e)}.bind(this),eResType.absUrl),cc.find("id",s).getComponent(cc.Label).string="ID: "+e.playerId,cc.find("score",s).getComponent(cc.Label).string=e.totalScore,cc.find("coins",s).getComponent(cc.Label).string=e.totalCoinNum},this))},close:function(){this.node.stopAllActions(),this.unscheduleAllCallbacks(),this.node.active=!1,this.closeCallback&&this.closeCallback(this._closeType)},open:function(e){this._data=u_clone(e),this.node.active=!0},onClickClose:function(){this._closeType="normal",this.close()},onClickNextGame:function(){this._closeType="play_again",this.close()}}),cc._RF.pop()},{}],PRoundReport:[function(e,t,s){"use strict";cc._RF.push(t,"1c255QEtztChJ9glxnxi6Tf","PRoundReport"),cc.Class({extends:cc.Component,properties:{tglWin:cc.Toggle,tglLose:cc.Toggle,lblBonusScore:cc.Label,lblCoverScore:cc.Label,lblAllScore:cc.Label,lblGetScore:cc.Label,lblGetCoins:cc.Label,arrPlayerList:{type:cc.Node,default:[]},closeCallback:{visible:!1,default:null},_data:null,_openTime:5},onLoad:function(){this.node.setContentSize(cc.winSize)},onEnable:function(){if(this.node.runAction(cc.sequence(cc.delayTime(this._openTime),cc.callFunc(this.close,this))),this._data){u_dump(this._data,"PRoundReport"),this._data.playerDatas[0].winnerId==GameData.userId?this.tglWin.check():this.tglLose.check();var e=0;this._data.playerDatas.forEach(function(t,s){t.playerId==GameData.userId&&(e=s)},this);for(var t=0;t<this._data.playerDatas.length;t++){var s=this._data.playerDatas[e];e=(e+1)%this._data.playerDatas.length;var n=GameData.battleInfo.playerIDToInfo[s.playerId],i=this.arrPlayerList[t];if(n.score=s.totalScore,cc.find(s.coinNum>0?"tgladd":"tglsub",i).getComponent(cc.Toggle).check(),cc.find("name",i).getComponent(cc.Label).string=n.name,n.head&&u_createSpriteFrame(n.head,function(e,t){e.isValid&&(e.spriteFrame=t)}.bind(this,cc.find("Avatar/icon",i).getComponent(cc.Sprite)),eResType.absUrl),cc.find("coins",i).getComponent(cc.Label).string=s.coinNum>0?"+"+s.coinNum:s.coinNum,cc.find("allCoins",i).getComponent(cc.Label).string=s.totalCoinNum,s.openCards){var o=cc.find("cardNode",i).getComponent("CardsGroup");o.clear(),o.addCards(s.openCards),o.sort()}var a=cc.find("bonus",i);a.children.forEach(function(e,t){e.active=!1},this),s.achievement&&s.achievement.forEach(function(e,t){cc.find("type_"+e,a).active=!0},this),s.playerId==GameData.userId&&(this.lblBonusScore.string=s.chipsScore,this.lblCoverScore.string=s.gaiPaiScore,this.lblAllScore.string=s.chipsScore+s.gaiPaiScore,this.lblGetScore.string=s.score,this.lblGetCoins.string=s.coinNum)}}},close:function(){this.node.stopAllActions(),this.node.active=!1,this.closeCallback&&this.closeCallback()},open:function(e){this._data=u_clone(e),this.node.active=!0}}),cc._RF.pop()},{}],PayLogic:[function(e,t,s){"use strict";cc._RF.push(t,"1ba7ckCCqNMwrizFgvC7436","PayLogic"),cc.Class({extends:cc.Component,properties:{_productList:null},onLoad:function(){},getProductList:function(t){if(cc.sys.isNative){var s={playerID:"101659",token:"432e28c932f2492da7e3c2238bb80e5a",area:Config.payArea};if(this._productList)switch(cc.sys.os){case cc.sys.OS_ANDROID:t&&t(!0,u_clone(this._productList[ePayType.Weixin]));break;case cc.sys.OS_IOS:t&&t(!0,u_clone(this._productList[ePayType.Apple]))}else HttpHelper.sendRequest(Config.urlPay.list,s,function(e){if(-1!=e.result&&0!=e.result)switch(this._productList={},e.forEach(function(e,t){this._productList[e.payType]=e.chargeList.map(function(e,t,s){return{id:e.id,itemId:1,cash:e.price,count:e.baseCard}})},this),cc.sys.os){case cc.sys.OS_ANDROID:t&&t(!0,u_clone(this._productList[ePayType.Weixin]||[]));break;case cc.sys.OS_IOS:t&&t(!0,u_clone(this._productList[ePayType.Apple]))}else t&&t(!1,[])}.bind(this))}else t&&t(!0,u_clone(e("Excharge_json")))},pay:function(e,t){Config.isGuestMode?this.payWithNative(e,t):cc.sys.isNative?this.payWithNative(e,t):this.payWithWeb(e,t)},payWithNative:function(e,t){var s={playerID:"101659",token:"432e28c932f2492da7e3c2238bb80e5a",productID:e,area:Config.payArea};HttpHelper.sendRequest(Config.urlPay.order,s,function(s){if(s.res){var n={appid:s.appid,partnerid:s.partnerid,prepayid:s.prepayid,noncestr:s.noncestr,timestamp:s.timestamp,package:s.package,sign:s.sign,productId:e,userId:GameData.userId,appleProductId:s.productID,sandbox:Config.isGuestMode,orderNO:s.orderNO};this.startPay(n,t)}else t&&t(ePayErrorCode.ERROR_GET_ORDER)})},payWithWeb:function(e,t){var s={};s.uid=GameData.userId,s.id=e,this.startPay(s,t)},startPay:function(e,t){TipsManager.showPayTips(),SDK.pay(e,function(e){TipsManager.closePayTips();var s={};if(cc.sys.isNative){if(s.errCode=e.errorCode,s.productId=e.errorMsg.productId,s.paySystem=e.errorMsg.paySystem,s.orderNO=e.errorMsg.orderNO,s.errCode==ePayErrorCode.ERROR_PURCHASING)return}else switch(e.pay_type){case"msg_pay_result_type_jsapi":return;case"msg_pay_result_type_native":var n=JSON.stringify(pay_date);s.errorMsg=n.result_code,s.errCode="SUCCESS"==n.result_code?ePayErrorCode.ERROR_SUCCESS:ePayErrorCode.ERROR_FAILED,s.paySystem=ePayType.Web,s.productId=e.product_id,s.orderNO=e.out_trade_no;break;case"msg_pay_result_type_native_user_close":s.errCode=ePayErrorCode.ERROR_USER_CANCEL}t&&t(s)})}}),cc._RF.pop()},{Excharge_json:"Excharge_json"}],PlayScene:[function(e,t,s){"use strict";cc._RF.push(t,"12624abdENGwbmf8wpcz5qZ","PlayScene"),cc.Class({extends:cc.Component,properties:{prefabCard:cc.Prefab,nodeChips:cc.Node,nodeChipsTips:cc.Node,nodeDiscardTips:cc.Node,nodeDiscard:cc.Node,nodeSetting:cc.Node,nodeChatpanel:cc.Node,nodeBonus:cc.Node,nodeRobot:cc.Node,nodeRoundReport:cc.Node,nodeFinalReport:cc.Node,lblBattleCount:cc.Label,lblRoomId:cc.Label,lblClock:cc.Label,lblTabType:cc.Label,lblScoreRate:cc.Label,lblCoins:cc.Label,lblScore:cc.Label,tglDiscardTips:cc.Toggle,tglCoverTips:cc.Toggle,btnChat:cc.Button,btnRobot:cc.Button,btnShare:cc.Button,btnExit:cc.Button,arrPlayerNodes:{type:cc.Node,default:[]},arrChipNode:{type:cc.Node,default:[]},arrChipCount:{type:cc.Label,default:[]},fntChipsAdd:cc.Font,fntChipsSub:cc.Font,_roomId:"",roomId:{visible:!1,get:function(){return this._roomId},set:function(e){this._roomId=e||"",this.lblRoomId&&(this.lblRoomId.string=this._roomId)}},_battleCount:[],battleCount:{visible:!1,get:function(){return this._battleCount},set:function(e){this._battleCount=e||[0,0],this.lblBattleCount&&(this.lblBattleCount.string=u_format("%02d/%02d",this._battleCount[0],this._battleCount[1]))}},_gameStatus:eDDZGameState.Idle,gameStatus:{visible:!1,type:cc.Enum(eDDZGameState),get:function(){return this._gameStatus},set:function(e){this._gameStatus=e||eDDZGameState.Idle}},_whoseTurn:0,whoseTurn:{visible:!1,get:function(){return this._whoseTurn},set:function(e){this._whoseTurn=e||0;var t=this._idToNode[this._whoseTurn];if(t){var s=cc.find("tgl_clock",t).getComponent(cc.Toggle);switch(this.lblClock.node.parent=cc.find("clock",s.node),this.gameStatus){case eDDZGameState.Play:this.nodeDiscardTips.active=GameData.userId==this._whoseTurn,this._whoseTurn!=GameData.userId&&(this._curOperateType=null),s.node.active=!0,s.check();break;case eDDZGameState.Idle:default:s.check(),s.isChecked=!1}}}},_turnTime:0,turnTime:{visible:!1,get:function(){return Math.ceil(this._turnTime)},set:function(e){this._turnEffectID&&AudioManager.stop(this._turnEffectID),this._turnEffectID=void 0,this._turnTime=parseFloat(e)||0,this._tickFunc&&this.unschedule(this._tickFunc),this._turnTime>0&&(this._tickFunc=function(e){this._turnTime-=e,this.turnTime<=0?(this.turnTime=0,this.unschedule(this._tickFunc),this._tickFunc=void 0):3==this.turnTime&&(this._turnEffectID=AudioManager.playSFX("effects/timeup_alarm.mp3")),this.lblClock.string=this.turnTime}.bind(this),this.schedule(this._tickFunc,1)),this.lblClock.string=this.turnTime}},_chipsData:[],chipsData:{visible:!1,get:function(){return u_clone(this._chipsData)},set:function(e){this._chipsData=e?u_clone(e):[];for(var t=0;t<this.arrChipNode.length;t++){var s=this.arrChipNode[t],n=this.arrChipCount[t];s.getComponent("Chip").count=this._chipsData[t]||0;var i=this._chipsData[t]+"";this._chipsData[t]<0?n.font=this.fntChipsSub:n.font=this.fntChipsAdd,n.string=i}}},stepHandlers:{visible:!1,default:{}},_maxSeat:0,_idToNode:{default:{}},_chairToNode:{default:{}},_netBattleStep:null,_discardHandler:null,_curOperateType:null,_mainAsID:"playscene",_tabTypeToText:{default:{}}},onLoad:function(){AudioManager.playBGM("music/bgm_play.mp3"),this._maxSeat=4,this._tabTypeToText[eTabType.JieLong]="接龙局",this._tabTypeToText[eTabType.ZhanLong]="斩龙局",this._netBattleStep=this.node.getComponent("NBattleStep"),this._discardHandler=this.nodeDiscard.getComponent("DiscardHandler"),this.initChipsButton()},start:function(){this.onPlayersChange(),this.initPlayerState(),this.initStepHandlers()},resetBattle:function(){var e=GameListData.getDataById(GameData.battleInfo.costID);this.roomId=GameData.battleInfo.roomID,this.lblTabType.string=this._tabTypeToText[e.tab],this.lblScoreRate.string=u_format(CText.scoreRate,e.scoreCoinRatio),this.lblCoins.string=GameData.coins,this.lblScore.string=GameData.battleInfo.playerIDToInfo[GameData.userId].score,this.nodeSetting.getComponent("Setting").showQuitButton=this.btnShare.node.active=this.btnExit.node.active=GameData.gameMode==eGameMode.Formal&&GameData.battleInfo.isPersonal,this.onRobotMode({auto:this._idToNode[GameData.userId]._playerInfo.auto});for(var t in this._idToNode)this._idToNode.hasOwnProperty(t)&&this._idToNode[t].getComponent("CardsHandler").clear();this._discardHandler.clear()},initPlayerState:function(){for(var e=0;e<this.arrPlayerNodes.length;e++){var t=this.arrPlayerNodes[e],s=cc.find("avatar",t).getComponent("BattleAvatar");t._playerInfo&&(s.isOffline=t._playerInfo.isOffline)}},initChipsButton:function(){this.nodeChips.on(cc.Node.EventType.TOUCH_START,function(){this.nodeChipsTips.active=!0}.bind(this)),this.nodeChips.on(cc.Node.EventType.TOUCH_END,function(){this.nodeChipsTips.active=!1}.bind(this)),this.nodeChips.on(cc.Node.EventType.TOUCH_CANCEL,function(){this.nodeChipsTips.active=!1}.bind(this))},delayPlayVoice:function(e,t,s){var n=cc.delayTime(e),i=cc.callFunc(function(){AudioManager.playVoice(t,s)});this.node.runAction(cc.sequence(n,i))},initStepHandlers:function(){this.stepHandlers[eDDZOperateType.Deal]=function(e){e.dlist.forEach(function(e,t){var s=this._idToNode[e.id].getComponent("CardsHandler");e.id==GameData.userId&&e.handCards?(s.addCards(e.handCards),s.sort()):e.hc>0&&s.addCard(0,-1,e.hc),e.openCards&&s.coverWithData(e.openCards.map(function(e,t){return e.cards?e.cards[0]:0},this))},this),this._idToNode[GameData.userId].getComponent("CardsHandler").refreshCanSelect(this._discardHandler.canDsicardGroup)}.bind(this),this.stepHandlers[eDDZOperateType.Discard]=function(e,t){var s=this._idToNode[e.uid].getComponent("CardsHandler"),n=e.data.card&&e.data.card.length>0?e.data.card:[0];if(e.uid==GameData.userId){var i=s.getPart().findIndex(function(e,t){return n[0]==e},this);i>-1&&s.removeCard(i)}else s.removeCards(0,n.length);this._discardHandler.discard(n[0]),this._idToNode[GameData.userId].getComponent("CardsHandler").refreshCanSelect(this._discardHandler.canDsicardGroup),t||(AudioManager.playSFX("effects/discard.mp3"),AudioManager.playVoice(e.uid,"poker_"+n[0]+".mp3"))}.bind(this),this.stepHandlers[eDDZOperateType.Cover]=function(e,t){var s=this._idToNode[e.uid].getComponent("CardsHandler"),n=e.data.card&&e.data.card.length>0?e.data.card:[0];if(e.uid==GameData.userId){var i=s.getPart().findIndex(function(e,t){return n[0]==e},this);i>-1&&s.removeCard(i)}else s.removeCards(0,n.length);s.cover(n[0]),this._idToNode[GameData.userId].getComponent("CardsHandler").refreshCanSelect(this._discardHandler.canDsicardGroup),t||AudioManager.playVoice(e.uid,"cover.mp3")}.bind(this),this.stepHandlers[eDDZOperateType.CanDiscard]=function(e){this._curOperateType="discard",this.tglDiscardTips.check(),e.uid==GameData.userId&&this.delayPlayVoice(.7,e.uid,"p_discard.mp3")}.bind(this),this.stepHandlers[eDDZOperateType.CanCover]=function(e){this._curOperateType="cover",this.tglCoverTips.check(),e.uid==GameData.userId&&this.delayPlayVoice(.7,e.uid,"p_cover.mp3")}.bind(this),this.stepHandlers[eDDZOperateType.Bonus]=function(e){this.chipsData=e.data.card}.bind(this);var e=function(e,t,s){var n={type:e,uid:t.uid,chips:t.data.card.slice(s)},i=this.nodeBonus.getComponent("Bonus");i.closeCallback=AsycnManager.invoke(function(){i.open(n)}.bind(this),this._mainAsID);for(var o=0,a=0;a<n.chips.length;a++)o+=n.chips[a];cc.log("bouns chips cur:"+this.getChipCount(t.uid)+" get:"+o,n),this.setChipCount(t.uid,this.getChipCount(t.uid)+o)}.bind(this);this.stepHandlers[eDDZOperateType.JieLong]=function(t){e(eDDZOperateType.JieLong,t,1)}.bind(this),this.stepHandlers[eDDZOperateType.LastSeven]=function(t){e(eDDZOperateType.LastSeven,t,0)}.bind(this),this.stepHandlers[eDDZOperateType.ShowHand]=function(t){e(eDDZOperateType.ShowHand,t,0)}.bind(this),this.stepHandlers[eDDZOperateType.AllCover]=function(t){e(eDDZOperateType.AllCover,t,0)}.bind(this),this.stepHandlers[eDDZOperateType.RoundReport]=function(e){this.turnTime=0;var t={playerDatas:e.rpdata},s=this.nodeRoundReport.getComponent("PRoundReport");s.closeCallback=AsycnManager.invoke(function(){s.open(t)}.bind(this),this._mainAsID)}.bind(this),this.stepHandlers[eDDZOperateType.FinalReport]=function(e){this.stepHandlers[eDDZOperateType.RoundReport](e);var t={playerDatas:e.rpdata},s=this.nodeFinalReport.getComponent("PFinalReport"),n=AsycnManager.invoke(function(){s.open(t)}.bind(this),this._mainAsID);s.closeCallback=function(e){if("play_again"==e){var t=u_clone(GameListData.getDataById(GameData.battleInfo.costID));t.isPersonal=GameData.battleInfo.isPersonal,t.isPersonal?this.node.getComponent("JoinGame").join(this.roomId):SceneManager.enterHallScene(function(){EventManager.dispatch(EventCode.LJoinGame,t)})}else SceneManager.enterHallScene();GameData.newBattleInfo(),n()}.bind(this)}.bind(this);var t=GameData.popStepCache();cc.log("handle ext steps: ",t),t.forEach(function(e,t){this.onBattleStep(e)},this)},getChipCount:function(e){return parseInt(cc.find("chip_count",this._idToNode[e]).getComponent(cc.Label).string)},setChipCount:function(e,t){cc.find("chip_count",this._idToNode[e]).getComponent(cc.Label).string=t},onPlayersChange:function(){var e=GameData.battleInfo;if(-1==e.ownerIndex)return GameData.newBattleInfo(),void SceneManager.enterHallScene();for(var t=e.playerInfos[e.ownerIndex],s=0;s<this.arrPlayerNodes.length;s++)this.arrPlayerNodes[s].active=!1;for(s=0;s<e.playerInfos.length;s++){var n=e.playerInfos[s],i=this.arrPlayerNodes[(n.chair+this._maxSeat-t.chair)%this._maxSeat];i._playerInfo=n,this._idToNode[n.playerID]=i,this._chairToNode[n.chair]=i,i.active=!0;var o=cc.find("avatar",i).getComponent("BattleAvatar");o.playerName=n.name,this.loadHeadIcon(o,n.head),cc.find("chip_count",i).getComponent(cc.Label).string=n.chips,o.onClickHandler=function(e){AudioManager.playSFX("effects/button_click.mp3"),TipsManager.showPlayerInfoTips(e.name,e.playerID,e.ip,e.head)}.bind(this,n)}cc.log("battle_info.playerInfos:",e.playerInfos),this.resetBattle()},loadHeadIcon:function(e,t){t&&u_createSpriteFrame(t,function(t){e.imageIcon=t}.bind(this),eResType.absUrl)},onBattleStep:function(e){if(this.stepHandlers&&this.stepHandlers[eDDZOperateType.Deal]){var t=!1;if(this.gameStatus=eDDZGameState.Play,!(e=e.battleData))return cc.log("step error!!!!"),void NetManager.close(EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_PING);this.battleCount=[e.battleTime,e.battleCount],GameData.battleInfo.currentBattleCount=e.battleTime,e.battleDealCards&&(this.resetBattle(),GameData.popStepCache(),this.nodeSetting.getComponent("Setting").showQuitButton=this.btnShare.node.active=!1,e.disposeCards&&this._discardHandler.initWithData(e.disposeCards),t=!0),this.whoseTurn=e.focusId,GameData.battleInfo.playerIDToInfo[this.whoseTurn].isRobot?this.turnTime=10:this.turnTime=e.cd,e.battleSteps.forEach(function(s,n){if(4==e.result||5==e.result)NetManager.close(EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_PING);else{var i=this.stepHandlers[s.playType];i&&i({uid:s.ownerId,data:s,dlist:e.battleDealCards,rpdata:e.gameRes},t)}},this)}},onSettingClick:function(){AudioManager.playSFX("effects/button_click.mp3"),this.nodeSetting.active=!0},onChatClick:function(){AudioManager.playSFX("effects/button_click.mp3"),this.nodeChatpanel.active=!0},onVoiceClick:function(){cc.log("onVoiceClick")},showFaceMessage:function(e){if(GameData.userId==e.accountID&&(this.btnChat.interactable=!1,this.unschedule(this.enableChatBtn),this.scheduleOnce(this.enableChatBtn,3)),!e.type){var t=e.content.split("&&_",2);e.type=parseInt(t[0]),e.content=t[1]}if(e.type==eChatType.Face)cc.find("Animations",this._chairToNode[e.senderChair]).getComponent("Animations").playEmojiAni(e.content);else{var s=ChatData.getChatContextAndPlay(e.content,e.type,GameData.battleInfo.chairToInfo[e.senderChair].sex);cc.find("Bubbles",this._chairToNode[e.senderChair]).getComponent("Bubbles").show(s,3)}},playCallLordChat:function(e,t){var s=ChatData.getQiangDiZhuChatIdx(this.callLordType,t,this.callScore),n=this.getComponent("LShowChatMessage"),i=GameData.battleInfo.playerIDToInfo[e].chair;n.data.accountID=e,n.data.senderChair=i,n.data.type=eChatType.QiangDiZhu,n.data.content=s,n.send()},playJiaBeiChat:function(e,t){var s=ChatData.getJiaBeiIdx(t),n=this.getComponent("LShowChatMessage"),i=GameData.battleInfo.playerIDToInfo[e].chair;n.data.accountID=e,n.data.senderChair=i,n.data.type=eChatType.QiangDiZhu,n.data.content=s,n.send()},enableChatBtn:function(){this.btnChat.interactable=!0},onClickDiscard:function(){var e=this._idToNode[GameData.userId].getComponent("CardsHandler"),t={playType:eDDZOperateType.Discard,card:e.getCard(e.selectedCard)};this._netBattleStep.data=t,this._netBattleStep.send(),e.canSelectGroup=[]},onClickCover:function(){var e=this._idToNode[GameData.userId].getComponent("CardsHandler"),t={playType:eDDZOperateType.Cover,card:e.getCard(e.selectedCard)};this._netBattleStep.data=t,this._netBattleStep.send(),e.canSelectGroup=[]},onDoubleClickCard:function(){"discard"==this._curOperateType?this.onClickDiscard():"cover"==this._curOperateType&&this.onClickCover()},onDragCard:function(e){var t,s=this._idToNode[GameData.userId].getComponent("CardsHandler");if("discard"==this._curOperateType)t={playType:eDDZOperateType.Discard,card:e.cardID};else{if("cover"!=this._curOperateType)return;t={playType:eDDZOperateType.Cover,card:e.cardID}}this._netBattleStep.data=t,this._netBattleStep.send(),s.canSelectGroup=[]},onDismissRoomClick:function(){TipsManager.showTipsBox(CText.dismissRoomTips,[1,2],this.sendDismissRoomEvent.bind(this))},onClickRobotMode:function(){AudioManager.playSFX("effects/button_click.mp3");var e=this.node.getComponent("NRobotMode");e.data.auto=!0,e.send()},onClickDisableRobot:function(){var e=this.node.getComponent("NRobotMode");e.data.auto=!1,e.send()},onBackToHallClick:function(){this.node.getComponent("NQuitRoom").send()},onShareClick:function(){if(!Config.isGuestMode){GameListData.getDataById(GameData.battleInfo.costID);SDK.share(CText.shareRoomTile,u_format(CText.shareRoomDesc,this.roomId),Config.urlShareIcon,this.roomId)}},onRobotMode:function(e){GameData.battleInfo.playerIDToInfo[GameData.userId].auto=e.auto,this.btnRobot.node.active=Boolean(!e.auto),this.nodeRobot.active=Boolean(e.auto)},onCardSelected:function(){},onLogOutRes:function(e){e.res==eServerResult.LogOutByKick?TipsManager.showTipsBox(CText.logoutByKick,[1],this.logOutAction.bind(this)):e.res==eServerResult.LogOutByForbid&&TipsManager.showTipsBox(CText.logoutByForbid,[1],this.logOutAction.bind(this))},logOutAction:function(){SceneManager.enterLoginScene(),NetManager.close(EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_QUIT)}}),cc._RF.pop()},{}],PlayerInfoTips:[function(e,t,s){"use strict";cc._RF.push(t,"ef6afqNowJI4K2QWetuACf3","PlayerInfoTips"),cc.Class({extends:cc.Component,properties:{lbl_name:cc.Label,lbl_id:cc.Label,lbl_ip:cc.Label,nd_head:cc.Sprite},onLoad:function(){this.node.setContentSize(cc.winSize)},showInfo:function(e,t,s,n){this.lbl_name&&(this.lbl_name.string=e),this.lbl_id&&(this.lbl_id.string=u_format("%s",t)),this.lbl_ip&&(this.lbl_ip.string=s),null!=n&&u_createSpriteFrame(n,function(e){this.nd_head&&(this.nd_head.spriteFrame=e)}.bind(this),eResType.absUrl)},onClick:function(){this.node.active=!1}}),cc._RF.pop()},{}],PublicFunctions:[function(e,t,s){"use strict";cc._RF.push(t,"78dd8OgL6BHqaYt9+56VNLe","PublicFunctions");var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.u_dump=function(e,t,s,n,i){function o(e){for(var t="";e>0;)t+="  ",e--;return t}t=t||e.name||"obj",s=s||!1,i=i||0,void 0==n&&(n=5);var a=t+" = ";if(e.constructor===Array){if(n<1)return void console.log(o(i)+a+"[Array]");console.log(o(i)+a+"{");for(var r=0;r<e.length;r++)u_dump(e[r],"["+r+"]",!1,n-1,i+1);o(i),console.log(o(i)+"}")}else if(e.constructor===Object){if(n<1)return void console.log(o(i)+a+"[Object]");console.log(o(i)+a+"{");for(var c in e)u_dump(e[c],c,!1,n-1,i+1);console.log(o(i)+"}")}else e.constructor===String?console.log(o(i)+a+'"'+e+'"'):(e.constructor,Function,console.log(o(i)+a+e))},window.u_format=function(e){function t(e,t){for(var s="",n=0;n<t;n++)s+=e;return s}for(var s=1;s<arguments.length;s++){var n="",i=!1,o=" ",a=256,r=(e=e.replace(/%%/g,"%$")).match(/%(?!\$)-?0?[0-9]*\.?[0-9]*[adfgs]/);if(!r||!(r=r[0]))break;var c=function(e){return e.length>a?e=i?e.substr(0,a):e.substr(-a):i?e+=t(o,a-e.length):e=t(o,a-e.length)+e,e};"-"==(r=r.substr(1)).charAt(0)&&(i=!0,r=r.substr(1)),"0"==r.charAt(0)&&(o="0",r=r.substr(1));var u=r.split(/[\.adfgs]/);switch(u.length>2?(a=parseInt(u[0]),parseInt(u[1])):u.length>1&&(a=parseInt(u[0])),r.charAt(r.length-1)){case"d":case"f":n=c(parseInt(arguments[s])+"");break;case"s":n=c(arguments[s].toString())}e=e.replace(/%(?!\$)-?0?[0-9]*\.?[0-9]*[adfgs]/,n)}return e=e.replace(/%\$/g,"%")},window.u_copy=function(e,t){if("object"===(void 0===t?"undefined":n(t)))for(var s in t)"object"===n(t[s])?null!=e[s]&&u_copy(e[s],t[s]):"function"!=typeof t[s]&&null!=e[s]&&(t[s]=e[s]);else cc.log("can not copy the value type")},window.u_clone=function(e){var t;if("object"===(void 0===e?"undefined":n(e))){t=new e.constructor;for(var s in e)"function"!=typeof e[s]&&(t[s]=u_clone(e[s]))}else t=e;return t},window.u_createSpriteFrame=function(e,t,s){var n=e.split(":");if(n[0])if(s!=eResType.absUrl)cc.loader.loadRes(n[0],n[1]?cc.SpriteAtlas:cc.Texture2D,function(s,i){s?cc.log("load resource error!\npath:"+e+"\nmsg:"+s.message):i instanceof cc.SpriteAtlas?t&&t(i.getSpriteFrame(n[1])):t&&t(new cc.SpriteFrame(i))});else{var i=decodeURIComponent(e);cc.loader.load({url:i,type:"png"},function(e,s){if(e)cc.log("loadImage faild------\x3eurl = "+i);else if(s){var n=new cc.SpriteFrame(s,cc.Rect(0,0,s.width,s.height));t&&t(n)}})}else cc.log("invalid resource path :"+u_format('"%s"',e))},window.u_createFont=function(e,t){cc.loader.loadRes(e,cc.Font,function(s,n){s?cc.log("load resource error!\npath:"+e+"\nmsg:"+s.message):t&&t(n)})},window.u_toTimeString=function(e,t){var s=Math.floor(e/31536e6);e-=31536e6*s;var n=Math.floor(e/2592e6);e-=2592e6*n;var i=Math.floor(e/864e5);e-=864e5*i;var o=Math.floor(e/36e5);e-=36e5*o;var a=Math.floor(e/6e4);e-=6e4*a;var r=Math.floor(e/1e3);return t=t.replace(/%%/g,"%$"),t=t.replace(/%y/g,s),t=t.replace(/%n/g,n),t=t.replace(/%d/g,i),t=t.replace(/%h/g,u_format("%02d",o)),t=t.replace(/%m/g,u_format("%02d",a)),t=t.replace(/%s/g,u_format("%02d",r)),t=t.replace(/%\$/g,"%")},window.u_retartGame=function(e){1!=e&&AssetsManager&&!cc.sys.ENABLE_GC_FOR_NATIVE_OBJECTS&&(AssetsManager.release(),window.AssetsManager=void 0),cc.game.restart()},window.u_calcDataLen=function(e){var t=1048576,s=1024*t;return e>s+t?Math.ceil(100*e/s)/100+"GB":e>1049600?Math.ceil(100*e/t)/100+"MB":e>1127?Math.ceil(100*e/1024)/100+"KB":e+"B"},window.isWeChatGame=function(){return!!window.wx},cc._RF.pop()},{}],SDK:[function(e,t,s){"use strict";cc._RF.push(t,"c40f9hwMqNCKZB0bQmBl48X","SDK"),cc.Class({properties:{deviceId:{visible:!1,get:function(){if(cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:return"android"+jsb.reflection.callStaticMethod("org/cocos2dx/javascript/SDKWrapper","getDeviceId","()Ljava/lang/String;");case cc.sys.OS_IOS:return"ios"+jsb.reflection.callStaticMethod("SDKWrapper","getDeviceId")}return"NONE"}},loginCallback:null,shareCallback:null,payCallback:null},init:function(){cc.sys.isNative||(isWeChatGame()?(window.WXMiniGameUtils=new(e("WXMiniGameUtils")),WXMiniGameUtils.init()):Config.h5Type==eH5Type.Dod&&(window.DodGameUtils=new(e("DodGameUtils")),DodGameUtils.init()))},log:function(e){if(cc.sys.isNative)switch(cc.sys.os){case cc.sys.OS_ANDROID:jsb.reflection.callStaticMethod("org/cocos2dx/javascript/SDKWrapper","Log","(Ljava/lang/String;)V",e);break;case cc.sys.OS_IOS:jsb.reflection.callStaticMethod("SDKWrapper","Log:",e)}},pay:function(e,t){if(cc.sys.isNative){this.payCallback=t;var s=JSON.stringify(e);switch(cc.log("SDK.pay:"),cc.log(s),cc.sys.os){case cc.sys.OS_ANDROID:e.paySystem=ePayType.Weixin,jsb.reflection.callStaticMethod("org/cocos2dx/javascript/SDKWrapper","gotoPay","(Ljava/lang/String;)V",JSON.stringify(e));break;case cc.sys.OS_IOS:e.paySystem=ePayType.Apple,jsb.reflection.callStaticMethod("SDKWrapper","gotoPay:",JSON.stringify(e))}}else DodGameUtils.startPay(e,t)},onPay:function(e){var t=JSON.parse(e),s=this.payCallback;this.payCallback=null,s&&s(t)},share:function(e,t,s,n,i){if(cc.sys.isNative){this.shareCallback=i;var o=JSON.stringify({title:e,txt:t,type:1,url:"http://h5.dodgame.com.cn/"});switch(cc.sys.os){case cc.sys.OS_ANDROID:jsb.reflection.callStaticMethod("org/cocos2dx/javascript/SDKWrapper","gotoShare","(Ljava/lang/String;)V",o);break;case cc.sys.OS_IOS:jsb.reflection.callStaticMethod("SDKWrapper","gotoShare:",o)}}else cc.log(e,t,s,n),Config.h5Type==eH5Type.WeiXinMini?WXMiniGameUtils.shareAppMessage(e):Config.h5Type==eH5Type.Dod&&DodGameUtils.share(e,t,s,n)},onShare:function(e){var t=this.shareCallback;this.shareCallback=null,t&&t(e)},login:function(e){if(cc.sys.isNative)switch(this.loginCallback=e,cc.sys.os){case cc.sys.OS_ANDROID:jsb.reflection.callStaticMethod("org/cocos2dx/javascript/SDKWrapper","gotoLogin","()V");break;case cc.sys.OS_IOS:jsb.reflection.callStaticMethod("SDKWrapper","gotoLogin")}},onLogin:function(e,t){var s=this.loginCallback;this.loginCallback=null,s&&s(e,t)}}),cc._RF.pop()},{DodGameUtils:"DodGameUtils",WXMiniGameUtils:"WXMiniGameUtils"}],SFS2X_API_JS:[function(e,t,s){"use strict";function n(e){return o(i(a(e)))}function i(e){return c(u(r(e),8*e.length))}function o(e){for(var t,s=R?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<e.length;i++)t=e.charCodeAt(i),n+=s.charAt(t>>>4&15)+s.charAt(15&t);return n}function a(e){for(var t,s,n="",i=-1;++i<e.length;)t=e.charCodeAt(i),s=i+1<e.length?e.charCodeAt(i+1):0,55296<=t&&56319>=t&&56320<=s&&57343>=s&&(t=65536+((1023&t)<<10)+(1023&s),i++),127>=t?n+=String.fromCharCode(t):2047>=t?n+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n}function r(e){for(var t=Array(e.length>>2),s=0;s<t.length;s++)t[s]=0;for(s=0;s<8*e.length;s+=8)t[s>>5]|=(255&e.charCodeAt(s/8))<<s%32;return t}function c(e){for(var t="",s=0;s<32*e.length;s+=8)t+=String.fromCharCode(e[s>>5]>>>s%32&255);return t}function u(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var s=1732584193,n=-271733879,i=-1732584194,o=271733878,a=0;a<e.length;a+=16)var r=s,c=n,u=i,l=o,n=_(n=_(n=_(n=_(n=S(n=S(n=S(n=S(n=d(n=d(n=d(n=d(n=h(n=h(n=h(n=h(n,i=h(i,o=h(o,s=h(s,n,i,o,e[a+0],7,-680876936),n,i,e[a+1],12,-389564586),s,n,e[a+2],17,606105819),o,s,e[a+3],22,-1044525330),i=h(i,o=h(o,s=h(s,n,i,o,e[a+4],7,-176418897),n,i,e[a+5],12,1200080426),s,n,e[a+6],17,-1473231341),o,s,e[a+7],22,-45705983),i=h(i,o=h(o,s=h(s,n,i,o,e[a+8],7,1770035416),n,i,e[a+9],12,-1958414417),s,n,e[a+10],17,-42063),o,s,e[a+11],22,-1990404162),i=h(i,o=h(o,s=h(s,n,i,o,e[a+12],7,1804603682),n,i,e[a+13],12,-40341101),s,n,e[a+14],17,-1502002290),o,s,e[a+15],22,1236535329),i=d(i,o=d(o,s=d(s,n,i,o,e[a+1],5,-165796510),n,i,e[a+6],9,-1069501632),s,n,e[a+11],14,643717713),o,s,e[a+0],20,-373897302),i=d(i,o=d(o,s=d(s,n,i,o,e[a+5],5,-701558691),n,i,e[a+10],9,38016083),s,n,e[a+15],14,-660478335),o,s,e[a+4],20,-405537848),i=d(i,o=d(o,s=d(s,n,i,o,e[a+9],5,568446438),n,i,e[a+14],9,-1019803690),s,n,e[a+3],14,-187363961),o,s,e[a+8],20,1163531501),i=d(i,o=d(o,s=d(s,n,i,o,e[a+13],5,-1444681467),n,i,e[a+2],9,-51403784),s,n,e[a+7],14,1735328473),o,s,e[a+12],20,-1926607734),i=S(i,o=S(o,s=S(s,n,i,o,e[a+5],4,-378558),n,i,e[a+8],11,-2022574463),s,n,e[a+11],16,1839030562),o,s,e[a+14],23,-35309556),i=S(i,o=S(o,s=S(s,n,i,o,e[a+1],4,-1530992060),n,i,e[a+4],11,1272893353),s,n,e[a+7],16,-155497632),o,s,e[a+10],23,-1094730640),i=S(i,o=S(o,s=S(s,n,i,o,e[a+13],4,681279174),n,i,e[a+0],11,-358537222),s,n,e[a+3],16,-722521979),o,s,e[a+6],23,76029189),i=S(i,o=S(o,s=S(s,n,i,o,e[a+9],4,-640364487),n,i,e[a+12],11,-421815835),s,n,e[a+15],16,530742520),o,s,e[a+2],23,-995338651),i=_(i,o=_(o,s=_(s,n,i,o,e[a+0],6,-198630844),n,i,e[a+7],10,1126891415),s,n,e[a+14],15,-1416354905),o,s,e[a+5],21,-57434055),i=_(i,o=_(o,s=_(s,n,i,o,e[a+12],6,1700485571),n,i,e[a+3],10,-1894986606),s,n,e[a+10],15,-1051523),o,s,e[a+1],21,-2054922799),i=_(i,o=_(o,s=_(s,n,i,o,e[a+8],6,1873313359),n,i,e[a+15],10,-30611744),s,n,e[a+6],15,-1560198380),o,s,e[a+13],21,1309151649),i=_(i,o=_(o,s=_(s,n,i,o,e[a+4],6,-145523070),n,i,e[a+11],10,-1120210379),s,n,e[a+2],15,718787259),o,s,e[a+9],21,-343485551),s=p(s,r),n=p(n,c),i=p(i,u),o=p(o,l);return[s,n,i,o]}function l(e,t,s,n,i,o){return p(g(p(p(t,e),p(n,o)),i),s)}function h(e,t,s,n,i,o,a){return l(t&s|~t&n,e,t,i,o,a)}function d(e,t,s,n,i,o,a){return l(t&n|s&~n,e,t,i,o,a)}function S(e,t,s,n,i,o,a){return l(t^s^n,e,t,i,o,a)}function _(e,t,s,n,i,o,a){return l(s^(t|~n),e,t,i,o,a)}function p(e,t){var s=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(s>>16)<<16|65535&s}function g(e,t){return e<<t|e>>>32-t}cc._RF.push(t,"850ceaKkZ9LDpgUaJuglL3t","SFS2X_API_JS");var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.SFS2X={SmartFox:function(e){this._majVersion=1,this._minVersion=7,this._subVersion=1,this._socketEngine=new SFS2X.SocketEngine,this._eventDispatcher=new SFS2X.EventDispatcher,this._lagMonitor=null,this._log=SFS2X.Logger,this._inited=this._isJoining=!1,this._currentZone=null,this._clientDetails="JavaScript",this.version=this._majVersion+"."+this._minVersion+"."+this._subVersion,this.config=e,this.debug=!1,null!=this.config&&this.config.debug&&(this.debug=!0),this.logger=this._log,this.lastJoinedRoom=this.mySelf=this.buddyManager=this.userManager=this.roomManager=this.sessionToken=null,this._controllers={},this._initialize(),this._log.info("SmartFox instance ready!")}},window.SmartFox=SFS2X.SmartFox,SFS2X.SmartFox.prototype.addEventListener=function(e,t,s){this._eventDispatcher.addEventListener(e,t,s)},SFS2X.SmartFox.prototype.removeEventListener=function(e,t){this._eventDispatcher.removeEventListener(e,t)},SFS2X.SmartFox.prototype.setClientDetails=function(e,t){this.isConnected()?this._log.warn("SetClientDetails must be called before the connection is started"):(this._clientDetails=null!=e?e.replace(":"," "):"",this._clientDetails+=":",this._clientDetails+=null!=t?t.replace(":"," "):"")},SFS2X.SmartFox.prototype.connect=function(e,t,s){if(this.isConnected())this._log.warn("Already connected");else if(this._socketEngine.isConnecting)this._log.warn("A connection attempt is already in progress");else{var n=null!=this.config&&null!=this.config.host?this.config.host:null,i=null!=this.config&&null!=this.config.port?this.config.port:null,o=null!=this.config&&this.config.useSSL;null!=e&&(n=e),null!=t&&(i=t),null!=s&&(o=s),null==n||0==n.length?this._log.error("Invalid connection host/address"):"number"!=typeof i||0>i||65535<i?this._log.error("Invalid TCP port"):("boolean"!=typeof o&&(o=!1),this._socketEngine.connect(n,i,o))}},SFS2X.SmartFox.prototype.disconnect=function(){this.isConnected()?(0<this._socketEngine.reconnectionSeconds&&this.send(new SFS2X.Requests.System.ManualDisconnectionRequest),setTimeout(function(e){e._handleClientDisconnection(SFS2X.Utils.ClientDisconnectionReason.MANUAL)},100,this)):this._log.info("You are not connected")},SFS2X.SmartFox.prototype.enableLagMonitor=function(e,t,s){null==this.mySelf?this._log.warn("Lag Monitoring requires that you are logged in a Zone; please retry after completing the login process"):(null!=this._lagMonitor&&this._lagMonitor.destroy(),e&&(this._lagMonitor=new SFS2X.Utils.LagMonitor(this,t,s),this._lagMonitor.start()))},SFS2X.SmartFox.prototype.isConnected=function(){return null!=this._socketEngine&&this._socketEngine.isConnected},SFS2X.SmartFox.prototype.getMaxMessageSize=function(){return null!=this._socketEngine?this._socketEngine._maxMessageSize:0},SFS2X.SmartFox.prototype.send=function(e){if(this.isConnected()){if(null!=e.validate&&null!=e.execute){try{e.validate(this),e.execute(this)}catch(s){if(!(s instanceof SFS2X.Exceptions.SFSValidationError&&null!=s.getMessage))throw s;if(e=s.getMessage(),null!=s.getErrors())for(var e=e+":",t=0;t<s.getErrors().length;t++)1<s.getErrors().length&&(e+=" "+(t+1)+")"),e+=" "+s.getErrors()[t];return this._log.error("Request failed | "+e),!1}return this.debug&&(this._log.info("OUTGOING DATA\n"+SFS2X.DebugHelper.getDump(e.getMessage())),this._log.info("OUT > "+SFS2X.Requests.getRequestNameFromId(e._id))),this._socketEngine.send(e.getMessage()),!0}this._log.error("An invalid request was passed: "+e),this._log.debug("Object dump:\n"+SFS2X.DebugHelper.getDump(e))}else this._log.error("You are not connected. Request cannot be sent: "+SFS2X.Requests.getRequestNameFromId(e._id))},SFS2X.SmartFox.prototype.getRoomById=function(e){return this.roomManager.getRoomById(e)},SFS2X.SmartFox.prototype.getRoomByName=function(e){return this.roomManager.getRoomByName(e)},SFS2X.SmartFox.prototype.getRoomList=function(){return this.roomManager.getRoomList()},SFS2X.SmartFox.prototype.getRoomListFromGroup=function(e){return this.roomManager.getRoomListFromGroup(e)},SFS2X.SmartFox.prototype.getJoinedRooms=function(){return this.roomManager.getJoinedRooms()},SFS2X.SmartFox.prototype._initialize=function(){this._inited||(this._socketEngine=new SFS2X.SocketEngine(this),this._socketEngine.addEventListener(SFS2X.SocketEvent.CONNECT,this._onSocketConnect,this),this._socketEngine.addEventListener(SFS2X.SocketEvent.DISCONNECT,this._onSocketDisconnect,this),this._socketEngine.addEventListener(SFS2X.SocketEvent.DATA,this._onSocketData,this),this._socketEngine.addEventListener(SFS2X.SocketEvent.IOERROR,this._onSocketIOError,this),this._controllers[0]=new SFS2X.Controllers.SystemController(this),this._controllers[1]=new SFS2X.Controllers.ExtensionController(this),this._inited=!0,this._reset())},SFS2X.SmartFox.prototype._reset=function(e){null!=this.buddyManager&&this.buddyManager._clearAll(),this.userManager=new SFS2X.Managers.GlobalUserManager(this),this.roomManager=new SFS2X.Managers.RoomManager(this),this.buddyManager=new SFS2X.Managers.BuddyManager(this),null!=this._lagMonitor&&this._lagMonitor.destroy(),this._isJoining=!1,this.mySelf=this.lastJoinedRoom=this._currentZone=null,e&&(this.sessionToken=null)},SFS2X.SmartFox.prototype._dispatchEvent=function(e,t){this._eventDispatcher.dispatchEvent(e,t)},SFS2X.SmartFox.prototype._onSocketConnect=function(e){e.success?(e=new SFS2X.Requests.System.HandshakeRequest(this.version,this._clientDetails,e.isReconnection?this.sessionToken:null),this.send(e)):this._dispatchEvent(SFS2X.SFSEvent.CONNECTION,{success:!1})},SFS2X.SmartFox.prototype._onSocketDisconnect=function(e){this._dispatchEvent(SFS2X.SFSEvent.CONNECTION_LOST,{reason:e.reason}),this._reset(!0)},SFS2X.SmartFox.prototype._onSocketData=function(e){this.debug&&this._log.info("INCOMING DATA\n"+SFS2X.DebugHelper.getDump(e));var t=e[SFS2X.Controllers.CONTROLLER_ID],s=e[SFS2X.Controllers.ACTION_ID],e=e[SFS2X.Controllers.PARAM_ID];null==t?this._log.error("Message rejected: Controller ID is missing"):null==t?this._log.error("Message rejected: Action ID missing"):this._controllers[t].handleMessage(e,s)},SFS2X.SmartFox.prototype._onSocketIOError=function(e){this._dispatchEvent(SFS2X.SFSEvent.SOCKET_ERROR,{message:e})},SFS2X.SmartFox.prototype._handleHandShake=function(e){var t=e[SFS2X.Controllers.KEY_ERROR_CODE];null==t?(this.sessionToken=e[SFS2X.Requests.System.HandshakeRequest.KEY_SESSION_TOKEN],this._socketEngine._maxMessageSize=e[SFS2X.Requests.System.HandshakeRequest.KEY_MAX_MESSAGE_SIZE],this._socketEngine._isReconnecting?this._socketEngine._isReconnecting=!1:this._dispatchEvent(SFS2X.SFSEvent.CONNECTION,{success:!0})):(e={success:!1,errorMessage:SFS2X.ErrorCodes.getErrorMessage(t,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),errorCode:t},this._dispatchEvent(SFS2X.SFSEvent.CONNECTION,e))},SFS2X.SmartFox.prototype._handleLogout=function(){this._reset(!1)},SFS2X.SmartFox.prototype._handleClientDisconnection=function(e){this.isConnected()&&this._socketEngine.disconnect(e)},function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;window.Class=function(){},Class.extend=function(s){function n(){!e&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;e=!0;var o=new this;e=!1;for(var a in s)o[a]="function"==typeof s[a]&&"function"==typeof i[a]&&t.test(s[a])?function(e,t){return function(){var s=this._super;this._super=i[e];var n=t.apply(this,arguments);return this._super=s,n}}(a,s[a]):s[a];return n.prototype=o,n.prototype.constructor=n,n.extend=Class.extend,n}}();var R=0,f="";SFS2X.Utils={},SFS2X.Utils.md5_crypt=function(e,t){"undefined"!=typeof VarType&&(e=VarType.toStr(e),t=VarType.toStr(t));var s=f;f="";var n=chrsz;chrsz=8,"$1$"==t.substr(0,3)&&(t=t.substr(3)),(0>(a=t.indexOf("$"))||8<a)&&(a=8);for(var i=e+"$1$"+(t=t.substr(0,a)),o=str_md5(e+t+e),a=e.length;0<a;a-=16)i=16<=a?i+o:i+o.substr(0,a);for(a=e.length;0!=a;a>>=1)i=0!=(1&a)?i+String.fromCharCode(0):i+e.charAt(0);for(var r="$1$"+t+"$",o=str_md5(i),a=0;1e3>a;a++)i="",i=0!=(1&a)?i+e:i+o,0!=a%3&&(i+=t),0!=a%7&&(i+=e),i=0!=(1&a)?i+o:i+e,o=str_md5(i);for(o+=o.charAt(5),a=0;5>a;a++)i=o.charCodeAt(a)<<16|o.charCodeAt(a+6)<<8|o.charCodeAt(a+12),r+=md5_to64(i,4);return i=o.charCodeAt(11),r+=md5_to64(i,2),f=s,chrsz=n,r},SFS2X.Utils.ClientDisconnectionReason={IDLE:"idle",KICK:"kick",BAN:"ban",MANUAL:"manual",UNKNOWN:"unknown"},SFS2X.Utils.ClientDisconnectionReason.getReason=function(e){switch(e){case 0:return this.IDLE;case 1:return this.KICK;case 2:return this.BAN;case 3:return this.MANUAL;case 4:return this.UNKNOWN}},SFS2X.Utils.ArrayUtil={},SFS2X.Utils.ArrayUtil.objToArray=function(e){var t,s=[];for(t in e)e.hasOwnProperty(t)&&s.push(e[t]);return s},SFS2X.Utils.ArrayUtil.removeItem=function(e,t){var s=e.indexOf(t);-1<s&&e.splice(s,1)},SFS2X.Utils.HashTable=function(e){this.length=0,this.items={};for(var t in e)e.hasOwnProperty(t)&&(this.items[t]=e[t],this.length++)},SFS2X.Utils.HashTable.prototype.setItem=function(e,t){var s=void 0;return this.hasItem(e)?s=this.items[e]:this.length++,this.items[e]=t,s},SFS2X.Utils.HashTable.prototype.getItem=function(e){return this.hasItem(e)?this.items[e]:void 0},SFS2X.Utils.HashTable.prototype.hasItem=function(e){return this.items.hasOwnProperty(e)},SFS2X.Utils.HashTable.prototype.removeItem=function(e){if(this.hasItem(e))return previous=this.items[e],this.length--,delete this.items[e],previous},SFS2X.Utils.HashTable.prototype.keys=function(){var e,t=[];for(e in this.items)this.hasItem(e)&&t.push(e);return t},SFS2X.Utils.HashTable.prototype.values=function(){var e,t=[];for(e in this.items)this.hasItem(e)&&t.push(this.items[e]);return t},SFS2X.Utils.HashTable.prototype.each=function(e){for(var t in this.items)this.hasItem(t)&&e(t,this.items[t])},SFS2X.Utils.HashTable.prototype.clear=function(){this.items={},this.length=0},SFS2X.Utils.LagMonitor=function(e,t,s){(null==t||1>t)&&(t=4),(null==s||1>s)&&(s=10),this._sfs=e,this._valueQueue=[],this._interval=t,this._queueSize=s,this._thread=null,this._lastReqTime=-1},SFS2X.Utils.LagMonitor.prototype.start=function(){!this.isRunning()&&null!=this._sfs&&(this._thread=setInterval(this._threadRunner,1e3*this._interval,this))},SFS2X.Utils.LagMonitor.prototype.stop=function(){this.isRunning()&&(clearInterval(this._thread),this._thread=null,this._valueQueue=[])},SFS2X.Utils.LagMonitor.prototype.destroy=function(){this.stop(),this._sfs=null},SFS2X.Utils.LagMonitor.prototype.isRunning=function(){return null!=this._thread},SFS2X.Utils.LagMonitor.prototype.getLastPingTime=function(){return 0<this._valueQueue.length?this._valueQueue[this._valueQueue.length-1]:0},SFS2X.Utils.LagMonitor.prototype._threadRunner=function(e){e._lastReqTime=(new Date).getTime(),e._sfs.send(new SFS2X.Requests.System.PingPongRequest)},SFS2X.Utils.LagMonitor.prototype._onPingPong=function(){var e=(new Date).getTime()-this._lastReqTime;return this._valueQueue.length>=this._queueSize&&this._valueQueue.shift(),this._valueQueue.push(e),this._getAveragePingTime()},SFS2X.Utils.LagMonitor.prototype._getAveragePingTime=function(){if(0==this._valueQueue.length)return 0;for(var e=0,t=0;t<this._valueQueue.length;t++)e+=this._valueQueue[t];return e/this._valueQueue.length},SFS2X.Utils.BuddyOnlineState={ONLINE:0,OFFLINE:1,LEFT_THE_SERVER:2},SFS2X.Controllers={},SFS2X.Controllers.CONTROLLER_ID="c",SFS2X.Controllers.ACTION_ID="a",SFS2X.Controllers.PARAM_ID="p",SFS2X.Controllers.KEY_ERROR_CODE="ec",SFS2X.Controllers.KEY_ERROR_PARAMS="ep",SFS2X.Controllers.ROOM_PARAM="r",SFS2X.Controllers.USER_PARAM="u",SFS2X.Controllers.USER_COUNT_PARAM="uc",SFS2X.Controllers.SPECT_COUNT_PARAM="sc",SFS2X.Controllers.SystemController=function(e){this._sfs=e,this._id=0,this._requestHandlers={},this._initRequestHandlers(),this._log=SFS2X.Logger},SFS2X.Controllers.SystemController.prototype.getId=function(){return this._id},SFS2X.Controllers.SystemController.prototype.handleMessage=function(e,t){this._sfs.debug&&this._log.info("IN < "+this._getEvtName(t));var s=this._requestHandlers[t];null!=s?this[s](e):this._log.warn("Unknown message id: "+e.id)},SFS2X.Controllers.SystemController.prototype._initRequestHandlers=function(){this._requestHandlers[SFS2X.Requests.Handshake]="_fnHandshake",this._requestHandlers[SFS2X.Requests.Login]="_fnLogin",this._requestHandlers[SFS2X.Requests.Logout]="_fnLogout",this._requestHandlers[SFS2X.Requests.JoinRoom]="_fnJoinRoom",this._requestHandlers[SFS2X.Requests.CreateRoom]="_fnCreateRoom",this._requestHandlers[SFS2X.Requests.ChangeRoomName]="_fnChangeRoomName",this._requestHandlers[SFS2X.Requests.ChangeRoomPassword]="_fnChangeRoomPassword",this._requestHandlers[SFS2X.Requests.ChangeRoomCapacity]="_fnChangeRoomCapacity",this._requestHandlers[SFS2X.Requests.GenericMessage]="_fnGenericMessage",this._requestHandlers[SFS2X.Requests.SetRoomVariables]="_fnSetRoomVariables",this._requestHandlers[SFS2X.Requests.SetUserVariables]="_fnSetUserVariables",this._requestHandlers[SFS2X.Requests.SubscribeRoomGroup]="_fnSubscribeRoomGroup",this._requestHandlers[SFS2X.Requests.UnsubscribeRoomGroup]="_fnUnsubscribeRoomGroup",this._requestHandlers[SFS2X.Requests.SpectatorToPlayer]="_fnSpectatorToPlayer",this._requestHandlers[SFS2X.Requests.PlayerToSpectator]="_fnPlayerToSpectator",this._requestHandlers[SFS2X.Requests.InitBuddyList]="_fnInitBuddyList",this._requestHandlers[SFS2X.Requests.AddBuddy]="_fnAddBuddy",this._requestHandlers[SFS2X.Requests.RemoveBuddy]="_fnRemoveBuddy",this._requestHandlers[SFS2X.Requests.BlockBuddy]="_fnBlockBuddy",this._requestHandlers[SFS2X.Requests.GoOnline]="_fnGoOnline",this._requestHandlers[SFS2X.Requests.SetBuddyVariables]="_fnSetBuddyVariables",this._requestHandlers[SFS2X.Requests.FindRooms]="_fnFindRooms",this._requestHandlers[SFS2X.Requests.FindUsers]="_fnFindUsers",this._requestHandlers[SFS2X.Requests.InviteUsers]="_fnInviteUsers",this._requestHandlers[SFS2X.Requests.InvitationReply]="_fnInvitationReply",this._requestHandlers[SFS2X.Requests.QuickJoinGame]="_fnQuickJoinGame",this._requestHandlers[SFS2X.Requests.PingPong]="_fnPingPong",this._requestHandlers[SFS2X.Requests.SetUserPosition]="_fnSetUserPosition",this._requestHandlers[1e3]="_fnUserEnterRoom",this._requestHandlers[1001]="_fnUserCountChange",this._requestHandlers[1002]="_fnUserLost",this._requestHandlers[1003]="_fnRoomLost",this._requestHandlers[1004]="_fnUserExitRoom",this._requestHandlers[1005]="_fnClientDisconnection",this._requestHandlers[1007]="_fnSetMMOItemVariables"},SFS2X.Controllers.SystemController.prototype._getEvtName=function(e){return this._requestHandlers[e].substr(3)},SFS2X.Controllers.SystemController.prototype._fnHandshake=function(e){this._sfs._handleHandShake(e)},SFS2X.Controllers.SystemController.prototype._fnLogin=function(e){if(this._log.info("_fnLogin handle !!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),null==e[SFS2X.Controllers.KEY_ERROR_CODE]){this._log.info("login init !!!!!!!!!!!!!!!!!!!!!!!!!!!!!",e[SFS2X.Requests.System.LoginRequest.KEY_ROOMLIST]),this._populateRoomList(e[SFS2X.Requests.System.LoginRequest.KEY_ROOMLIST]),this._sfs.mySelf=new SFS2X.Entities.SFSUser(e[SFS2X.Requests.System.LoginRequest.KEY_ID],e[SFS2X.Requests.System.LoginRequest.KEY_USER_NAME],!0),this._sfs.mySelf._setUserManager(this._sfs.userManager),this._sfs.mySelf.privilegeId=e[SFS2X.Requests.System.LoginRequest.KEY_PRIVILEGE_ID],this._sfs.userManager._addUser(this._sfs.mySelf),this._sfs._socketEngine.reconnectionSeconds=e[SFS2X.Requests.System.LoginRequest.KEY_RECONNECTION_SECONDS];var t={};t.zone=e[SFS2X.Requests.System.LoginRequest.KEY_ZONE_NAME],t.user=this._sfs.mySelf,t.data=e[SFS2X.Requests.System.LoginRequest.KEY_PARAMS],this._sfs._dispatchEvent(SFS2X.SFSEvent.LOGIN,t)}else t=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(t,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),this._sfs._dispatchEvent(SFS2X.SFSEvent.LOGIN_ERROR,{errorMessage:e,errorCode:t})},SFS2X.Controllers.SystemController.prototype._fnLogout=function(e){this._sfs._handleLogout();var t={};t.zone=e[SFS2X.Requests.System.LogoutRequest.KEY_ZONE_NAME],this._sfs._dispatchEvent(SFS2X.SFSEvent.LOGOUT,t)},SFS2X.Controllers.SystemController.prototype._fnJoinRoom=function(e){var t=this._sfs.roomManager,s={};this._sfs._isJoining=!1;var n=e[SFS2X.Controllers.KEY_ERROR_CODE];if(null==n){for(n=e[SFS2X.Requests.System.JoinRoomRequest.KEY_USER_LIST],(e=SFS2X.Entities.SFSRoom.fromArray(e[SFS2X.Requests.System.JoinRoomRequest.KEY_ROOM]))._setRoomManager(t),e=t._replaceRoom(e,t.containsGroup(e.groupId)),t=0;t<n.length;t++){var i=n[t],o=this._getOrCreateUser(i,!0,e);o._setPlayerId(i[3],e),e._addUser(o)}e.isJoined=!0,this._sfs.lastJoinedRoom=e,s.room=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_JOIN,s)}else e=SFS2X.ErrorCodes.getErrorMessage(n,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),s.errorMessage=e,s.errorCode=n,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_JOIN_ERROR,s)},SFS2X.Controllers.SystemController.prototype._fnCreateRoom=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=this._sfs.roomManager;(e=SFS2X.Entities.SFSRoom.fromArray(e[SFS2X.Requests.System.CreateRoomRequest.KEY_ROOM]))._setRoomManager=s,s._addRoom(e),t.room=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_ADD,t)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_CREATION_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnChangeRoomName=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=this._sfs.roomManager.getRoomById(e[SFS2X.Requests.System.ChangeRoomNameRequest.KEY_ROOM]);null!=s?(t.oldName=s.name,this._sfs.roomManager._changeRoomName(s,e[SFS2X.Requests.System.ChangeRoomNameRequest.KEY_NAME]),t.room=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_NAME_CHANGE,t)):this._log.warn("RoomNameChange event, unknown Room id: "+rId)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_NAME_CHANGE_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnChangeRoomPassword=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=this._sfs.roomManager.getRoomById(e[SFS2X.Requests.System.ChangeRoomNameRequest.KEY_ROOM]);null!=s?(this._sfs.roomManager._changeRoomPasswordState(s,e[SFS2X.Requests.System.ChangeRoomPasswordStateRequest.KEY_PASS]),t.room=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_PASSWORD_STATE_CHANGE,t)):this._log.warn("RoomPasswordChange event, unknown Room id: "+rId)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_PASSWORD_STATE_CHANGE_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnChangeRoomCapacity=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=this._sfs.roomManager.getRoomById(e[SFS2X.Requests.System.ChangeRoomNameRequest.KEY_ROOM]);null!=s?(this._sfs.roomManager._changeRoomCapacity(s,e[SFS2X.Requests.System.ChangeRoomCapacityRequest.KEY_USER_SIZE],e[SFS2X.Requests.System.ChangeRoomCapacityRequest.KEY_SPEC_SIZE]),t.room=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_CAPACITY_CHANGE,t)):this._log.warn("RoomPasswordChange event, unknown Room id: "+rId)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_CAPACITY_CHANGE_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnGenericMessage=function(e){switch(e[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE_TYPE]){case SFS2X.Requests.GenericMessageType.PUBLIC_MSG:this._handlePublicMessage(e);break;case SFS2X.Requests.GenericMessageType.PRIVATE_MSG:this._handlePrivateMessage(e);break;case SFS2X.Requests.GenericMessageType.BUDDY_MSG:this._handleBuddyMessage(e);break;case SFS2X.Requests.GenericMessageType.MODERATOR_MSG:this._handleModMessage(e);break;case SFS2X.Requests.GenericMessageType.ADMING_MSG:this._handleAdminMessage(e);break;case SFS2X.Requests.GenericMessageType.OBJECT_MSG:this._handleObjectMessage(e)}},SFS2X.Controllers.SystemController.prototype._handlePublicMessage=function(e){var t={},s=e[SFS2X.Requests.System.GenericMessageRequest.KEY_ROOM_ID],n=this._sfs.roomManager.getRoomById(s);null!=n?(t.room=n,t.sender=this._sfs.userManager.getUserById(e[SFS2X.Requests.System.GenericMessageRequest.KEY_USER_ID]),t.message=e[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE],t.data=e[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(SFS2X.SFSEvent.PUBLIC_MESSAGE,t)):this._log.warn("Unexpected, public message target Room doesn't exist; Room id: "+s)},SFS2X.Controllers.SystemController.prototype._handlePrivateMessage=function(e){var t={},s=this._sfs.userManager.getUserById(e[SFS2X.Requests.System.GenericMessageRequest.KEY_USER_ID]);if(null==s){if(null==e[SFS2X.Requests.System.GenericMessageRequest.KEY_SENDER_DATA])return void this._log.warn("Unexpected, private message has no sender details");s=SFS2X.Entities.SFSUser.fromArray(e[SFS2X.Requests.System.GenericMessageRequest.KEY_SENDER_DATA])}t.sender=s,t.message=e[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE],t.data=e[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(SFS2X.SFSEvent.PRIVATE_MESSAGE,t)},SFS2X.Controllers.SystemController.prototype._handleBuddyMessage=function(e){var t={},s=e[SFS2X.Requests.System.GenericMessageRequest.KEY_USER_ID],n=this._sfs.buddyManager.getBuddyById(s);t.isItMe=this._sfs.mySelf.id==s,t.buddy=n,t.message=e[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE],t.data=e[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_MESSAGE,t)},SFS2X.Controllers.SystemController.prototype._handleModMessage=function(e){var t={};t.sender=SFS2X.Entities.SFSUser.fromArray(e[SFS2X.Requests.System.GenericMessageRequest.KEY_SENDER_DATA]),t.message=e[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE],t.data=e[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(SFS2X.SFSEvent.MODERATOR_MESSAGE,t)},SFS2X.Controllers.SystemController.prototype._handleAdminMessage=function(e){var t={};t.sender=SFS2X.Entities.SFSUser.fromArray(e[SFS2X.Requests.System.GenericMessageRequest.KEY_SENDER_DATA]),t.message=e[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE],t.data=e[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(SFS2X.SFSEvent.ADMIN_MESSAGE,t)},SFS2X.Controllers.SystemController.prototype._handleObjectMessage=function(e){var t={};t.sender=this._sfs.userManager.getUserById(e[SFS2X.Requests.System.GenericMessageRequest.KEY_USER_ID]),t.message=e[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(SFS2X.SFSEvent.OBJECT_MESSAGE,t)},SFS2X.Controllers.SystemController.prototype._fnSetRoomVariables=function(e){var t=e[SFS2X.Requests.System.SetRoomVariablesRequest.KEY_VAR_ROOM],s=e[SFS2X.Requests.System.SetRoomVariablesRequest.KEY_VAR_LIST],n=[];if(null!=(e=this._sfs.roomManager.getRoomById(t))){for(t=0;t<s.length;t++){var i=SFS2X.Entities.Variables.SFSRoomVariable.fromArray(s[t]);e._setVariable(i),n.push(i.name)}(s={}).changedVars=n,s.room=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_VARIABLES_UPDATE,s)}else this._log.warn("RoomVariablesUpdate event, unknown Room id: "+t)},SFS2X.Controllers.SystemController.prototype._fnSetUserVariables=function(e){var t=e[SFS2X.Requests.System.SetUserVariablesRequest.KEY_USER],s=e[SFS2X.Requests.System.SetUserVariablesRequest.KEY_VAR_LIST],n=[];if(null!=(e=this._sfs.userManager.getUserById(t))){for(t=0;t<s.length;t++){var i=SFS2X.Entities.Variables.SFSUserVariable.fromArray(s[t]);e._setVariable(i),n.push(i.name)}(s={}).changedVars=n,s.user=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,s)}else this._log.warn("UserVariablesUpdate event, unknown User id: "+t)},SFS2X.Controllers.SystemController.prototype._fnSubscribeRoomGroup=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.System.SubscribeRoomGroupRequest.KEY_GROUP_ID],e=e[SFS2X.Requests.System.SubscribeRoomGroupRequest.KEY_ROOM_LIST];this._sfs.roomManager.containsGroup(s)&&this._log.warn("Subscribe Group error: Group '"+s+"' already subscribed"),this._populateRoomList(e),t.groupId=s,t.newRooms=this._sfs.roomManager.getRoomListFromGroup(s),this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_GROUP_SUBSCRIBE,t)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_GROUP_SUBSCRIBE_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnUnsubscribeRoomGroup=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.System.UnsubscribeRoomGroupRequest.KEY_GROUP_ID];this._sfs.roomManager.containsGroup(s)||this._log.warn("Unsubscribe Group error: Group '"+s+"' not found (maybe never subscribed, or the Room Manager doesn't contain Rooms belonging to that Group)"),this._sfs.roomManager._removeGroup(s),t.groupId=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_GROUP_UNSUBSCRIBE,t)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_GROUP_UNSUBSCRIBE_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnSpectatorToPlayer=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.System.SpectatorToPlayerRequest.KEY_ROOM_ID],n=e[SFS2X.Requests.System.SpectatorToPlayerRequest.KEY_USER_ID],e=e[SFS2X.Requests.System.SpectatorToPlayerRequest.KEY_PLAYER_ID],i=this._sfs.userManager.getUserById(n),o=this._sfs.roomManager.getRoomById(s);null!=o?null!=i?i.isJoinedInRoom(o)?(i._setPlayerId(e,o),t.room=o,t.user=i,t.playerId=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.SPECTATOR_TO_PLAYER,t)):this._log.warn("SpectatorToPlayer event, user "+i+" not joined in Room ",o):this._log.warn("SpectatorToPlayer event, unknown User id: "+n):this._log.warn("SpectatorToPlayer event, unknown Room id: "+s)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],n=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=n,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.SPECTATOR_TO_PLAYER_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnPlayerToSpectator=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.System.PlayerToSpectatorRequest.KEY_ROOM_ID],e=e[SFS2X.Requests.System.PlayerToSpectatorRequest.KEY_USER_ID],n=this._sfs.userManager.getUserById(e),i=this._sfs.roomManager.getRoomById(s);null!=i?null!=n?n.isJoinedInRoom(i)?(n._setPlayerId(-1,i),t.room=i,t.user=n,this._sfs._dispatchEvent(SFS2X.SFSEvent.PLAYER_TO_SPECTATOR,t)):this._log.warn("PlayerToSpectator event, user "+n+" not joined in Room ",i):this._log.warn("PlayerToSpectator event, unknown User id: "+e):this._log.warn("PlayerToSpectator event, unknown Room id: "+s)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.PLAYER_TO_SPECTATOR_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnFindRooms=function(e){for(var t={},e=e[SFS2X.Requests.System.FindRoomsRequest.KEY_FILTERED_ROOMS],s=[],n=0;n<e.length;n++){var i=SFS2X.Entities.SFSRoom.fromArray(e[n]),o=this._sfs.roomManager.getRoomById(i.id);null!=o&&(i.isJoined=o.isJoined),s.push(i)}t.rooms=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_FIND_RESULT,t)},SFS2X.Controllers.SystemController.prototype._fnFindUsers=function(e){for(var t={},e=e[SFS2X.Requests.System.FindUsersRequest.KEY_FILTERED_USERS],s=[],n=this._sfs.mySelf,i=0;i<e.length;i++){var o=SFS2X.Entities.SFSUser.fromArray(e[i]);o.id==n.id&&(o=n),s.push(o)}t.users=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.USER_FIND_RESULT,t)},SFS2X.Controllers.SystemController.prototype._fnInviteUsers=function(e){var t={},s=null,s=null!=e[SFS2X.Requests.Game.InviteUsersRequest.KEY_USER_ID]?this._sfs.userManager.getUserById(e[SFS2X.Requests.Game.InviteUsersRequest.KEY_USER_ID]):SFS2X.Entities.SFSUser.fromArray(e[SFS2X.Requests.Game.InviteUsersRequest.KEY_USER]),n=e[SFS2X.Requests.Game.InviteUsersRequest.KEY_INVITATION_ID];(e=new SFS2X.Entities.Invitation.SFSInvitation(s,this._sfs.mySelf,e[SFS2X.Requests.Game.InviteUsersRequest.KEY_TIME],e[SFS2X.Requests.Game.InviteUsersRequest.KEY_PARAMS])).id=n,t.invitation=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.INVITATION,t)},SFS2X.Controllers.SystemController.prototype._fnInvitationReply=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=null,s=null!=e[SFS2X.Requests.Game.InviteUsersRequest.KEY_USER_ID]?this._sfs.userManager.getUserById(e[SFS2X.Requests.Game.InviteUsersRequest.KEY_USER_ID]):SFS2X.Entities.SFSUser.fromArray(e[SFS2X.Requests.Game.InviteUsersRequest.KEY_USER]),n=e[SFS2X.Requests.Game.InviteUsersRequest.KEY_REPLY_ID],e=e[SFS2X.Requests.Game.InviteUsersRequest.KEY_PARAMS];t.invitee=s,t.reply=n,t.data=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.INVITATION_REPLY,t)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.INVITATION_REPLY_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnQuickJoinGame=function(e){if(null!=e[SFS2X.Controllers.KEY_ERROR_CODE]){var t=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(t,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),s={};s.errorMessage=e,s.errorCode=t,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_JOIN_ERROR,s)}},SFS2X.Controllers.SystemController.prototype._fnPingPong=function(){var e=this._sfs._lagMonitor._onPingPong(),t={};t.lagValue=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.PING_PONG,t)},SFS2X.Controllers.SystemController.prototype._fnSetUserPosition=function(e){var t={},s=this._sfs.roomManager.getRoomById(e[SFS2X.Requests.MMO.SetUserPositionRequest.KEY_ROOM]),n=e[SFS2X.Requests.MMO.SetUserPositionRequest.KEY_MINUS_USER_LIST],i=e[SFS2X.Requests.MMO.SetUserPositionRequest.KEY_PLUS_USER_LIST],o=e[SFS2X.Requests.MMO.SetUserPositionRequest.KEY_MINUS_ITEM_LIST],e=e[SFS2X.Requests.MMO.SetUserPositionRequest.KEY_PLUS_ITEM_LIST],a=[],r=[],c=[],u=[],l=0;if(null!=n)for(l=0;l<n.length;l++){var h=s.getUserById(n[l]);null!=h&&(s._removeUser(h),r.push(h))}if(null!=i)for(l=0;l<i.length;l++)h=i[l],n=this._getOrCreateUser(h,!0,s),a.push(n),s._addUser(n),null!=(h=h[5])&&(n.aoiEntryPoint=SFS2X.Entities.Data.Vec3D.fromArray(h));if(null!=o)for(l=0;l<o.length;l++)null!=(i=s.getMMOItem(o[l]))&&(s._removeItem(i),u.push(i));if(null!=e)for(l=0;l<e.length;l++)i=e[l],o=SFS2X.Entities.MMOItem.fromArray(i),c.push(o),s._addMMOItem(o),null!=(i=i[2])&&(o.aoiEntryPoint=SFS2X.Entities.Data.Vec3D.fromArray(i));t.addedItems=c,t.removedItems=u,t.removedUsers=r,t.addedUsers=a,t.room=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.PROXIMITY_LIST_UPDATE,t)},SFS2X.Controllers.SystemController.prototype._fnSetMMOItemVariables=function(e){var t={},s=this._sfs.roomManager.getRoomById(e[SFS2X.Requests.MMO.SetMMOItemVariables.KEY_ROOM_ID]),n=e[SFS2X.Requests.MMO.SetMMOItemVariables.KEY_ITEM_ID],e=e[SFS2X.Requests.MMO.SetMMOItemVariables.KEY_VAR_LIST],i=[];if(null!=s&&null!=(n=s.getMMOItem(n))){for(var o=0;o<e.length;o++){var a=SFS2X.Entities.Variables.MMOItemVariable.fromArray(e[o]);n._setVariable(a),i.push(a.name)}t.changedVars=i,t.mmoItem=n,t.room=s,this._sfs._dispatchEvent(SFS2X.SFSEvent.MMOITEM_VARIABLES_UPDATE,t)}},SFS2X.Controllers.SystemController.prototype._fnUserEnterRoom=function(e){var t=this._sfs.roomManager.getRoomById(e[SFS2X.Controllers.ROOM_PARAM]);if(null!=t){e=this._getOrCreateUser(e[SFS2X.Controllers.USER_PARAM],!0,t),t._addUser(e);var s={};s.user=e,s.room=t,this._sfs._dispatchEvent(SFS2X.SFSEvent.USER_ENTER_ROOM,s)}},SFS2X.Controllers.SystemController.prototype._fnUserCountChange=function(e){var t=this._sfs.roomManager.getRoomById(e[SFS2X.Controllers.ROOM_PARAM]);if(null!=t){var s=e[SFS2X.Controllers.USER_COUNT_PARAM],n=0;null!=e.sc&&(n=e[SFS2X.Controllers.SPECT_COUNT_PARAM]),t._userCount=s,t._specCount=n,(e={}).room=t,e.uCount=s,e.sCount=n,this._sfs._dispatchEvent(SFS2X.SFSEvent.USER_COUNT_CHANGE,e)}},SFS2X.Controllers.SystemController.prototype._fnUserLost=function(e){if(null!=(e=this._sfs.userManager.getUserById(e[SFS2X.Controllers.USER_PARAM]))){var t=this._sfs.roomManager.getUserRooms(e);this._sfs.roomManager._removeUser(e),this._sfs.userManager._removeUserReference(e,!0);for(var s=0;s<t.length;s++){var n={};n.user=e,n.room=t[s],this._sfs._dispatchEvent(SFS2X.SFSEvent.USER_EXIT_ROOM,n)}}},SFS2X.Controllers.SystemController.prototype._fnRoomLost=function(e){var e=this._sfs.roomManager.getRoomById(e[SFS2X.Controllers.ROOM_PARAM]),t=this._sfs.userManager;if(null!=e){this._sfs.roomManager._removeRoom(e);for(var s=e.getUserList(),n=0;n<s.length;n++)t._removeUser(s[n]);(t={}).room=e,this._sfs._dispatchEvent(SFS2X.SFSEvent.ROOM_REMOVE,t)}},SFS2X.Controllers.SystemController.prototype._fnUserExitRoom=function(e){var t=this._sfs.roomManager.getRoomById(e[SFS2X.Controllers.ROOM_PARAM]),e=this._sfs.userManager.getUserById(e[SFS2X.Controllers.USER_PARAM]);if(null!=t&&null!=e){t._removeUser(e),this._sfs.userManager._removeUser(e),e.isItMe&&t.isJoined&&(t.isJoined=!1,0==this._sfs.roomManager.getJoinedRooms().length&&(this._sfs.lastJoinedRoom=null),t._isManaged||this._sfs.roomManager._removeRoom(t));var s={};s.user=e,s.room=t,this._sfs._dispatchEvent(SFS2X.SFSEvent.USER_EXIT_ROOM,s)}else this._log.debug("Failed to handle UserExit event. Room: "+t+", User: "+e)},SFS2X.Controllers.SystemController.prototype._fnClientDisconnection=function(e){this._sfs._handleClientDisconnection(SFS2X.Utils.ClientDisconnectionReason.getReason(e.dr))},SFS2X.Controllers.SystemController.prototype._fnInitBuddyList=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.BuddyList.InitBuddyListRequest.KEY_BLIST],n=e[SFS2X.Requests.BuddyList.InitBuddyListRequest.KEY_MY_VARS],i=e[SFS2X.Requests.BuddyList.InitBuddyListRequest.KEY_BUDDY_STATES];for(this._sfs.buddyManager._clearAll(),e=0;e<s.length;e++){var o=SFS2X.Entities.SFSBuddy.fromArray(s[e]);this._sfs.buddyManager._addBuddy(o)}for(null!=i&&this._sfs.buddyManager._setBuddyStates(i),s=[],e=0;e<n.length;e++)i=SFS2X.Entities.Variables.SFSBuddyVariable.fromArray(n[e]),s.push(i);this._sfs.buddyManager._setMyVariables(s),this._sfs.buddyManager._setInited(),t.buddyList=this._sfs.buddyManager.getBuddyList(),t.myVariables=this._sfs.buddyManager.getMyVariables(),this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_LIST_INIT,t)}else n=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(n,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=n,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnAddBuddy=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=SFS2X.Entities.SFSBuddy.fromArray(e[SFS2X.Requests.BuddyList.AddBuddyRequest.KEY_BUDDY_NAME]);this._sfs.buddyManager._addBuddy(s),t.buddy=s,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ADD,t)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnRemoveBuddy=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.BuddyList.RemoveBuddyRequest.KEY_BUDDY_NAME];null!=(e=this._sfs.buddyManager._removeBuddyByName(s))?(t.buddy=e,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_REMOVE,t)):this._log.warn("Unexpected: buddy removal failed, can't find "+s+" in local buddy list")}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnBlockBuddy=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_NAME],n=this._sfs.buddyManager.getBuddyByName(s);if(null!=e[SFS2X.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY])n=SFS2X.Entities.SFSBuddy.fromArray(e[SFS2X.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY]),this._sfs.buddyManager._addBuddy(n);else{if(null==n)return void this._log.warn("Unexpected: buddy blocking/unblocking failed, can't find "+s+" in local buddy list");n.blocked=e[SFS2X.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_BLOCK_STATE]}t.buddy=n,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_BLOCK,t)}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnGoOnline=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){var s=e[SFS2X.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_NAME],n=this._sfs.buddyManager.getBuddyByName(s),i=s==this._sfs.mySelf.name,o=e[SFS2X.Requests.BuddyList.GoOnlineRequest.KEY_ONLINE],a=o==SFS2X.Utils.BuddyOnlineState.ONLINE,r=!0;if(i)this._sfs.buddyManager.getMyOnlineState()!=a&&(this._log.warn("Unexpected: myOnlineState is not in synch with the server; resynching to: "+a),this._sfs.buddyManager._setMyOnlineState(a));else{if(null==n)return void this._log.warn("Unexpected:  buddy '"+s+"' not found in local Buddy List when trying to set his online state");n.id=e[SFS2X.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_ID],n._setVariable(new SFS2X.Entities.Variables.SFSBuddyVariable(SFS2X.Entities.Variables.ReservedBuddyVariables.BV_ONLINE,a)),o==SFS2X.Utils.BuddyOnlineState.LEFT_THE_SERVER&&n._clearVolatileVariables(),r=this._sfs.buddyManager.getMyOnlineState()}r&&(t.buddy=n,t.isItMe=i,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ONLINE_STATE_CHANGE,t))}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ERROR,t)},SFS2X.Controllers.SystemController.prototype._fnSetBuddyVariables=function(e){var t={};if(null==e[SFS2X.Controllers.KEY_ERROR_CODE]){for(var s=e[SFS2X.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_NAME],e=e[SFS2X.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_VARS],n=this._sfs.buddyManager.getBuddyByName(s),i=s==this._sfs.mySelf.name,o=[],a=[],r=!0,c=0;c<e.length;c++){var u=SFS2X.Entities.Variables.SFSBuddyVariable.fromArray(e[c]);a.push(u),o.push(u.name)}if(i)this._sfs.buddyManager._setMyVariables(a);else{if(null==n)return void this._log.warn("Unexpected:  buddy '"+s+"' not found in local Buddy List when trying to set his Buddy Variables");n._setVariables(a),r=this._sfs.buddyManager.getMyOnlineState()}r&&(t.buddy=n,t.isItMe=i,t.changedVars=o,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_VARIABLES_UPDATE,t))}else s=e[SFS2X.Controllers.KEY_ERROR_CODE],e=SFS2X.ErrorCodes.getErrorMessage(s,e[SFS2X.Controllers.KEY_ERROR_PARAMS]),t.errorMessage=e,t.errorCode=s,this._sfs._dispatchEvent(SFS2X.SFSBuddyEvent.BUDDY_ERROR,t)},SFS2X.Controllers.SystemController.prototype._populateRoomList=function(e){for(var t=this._sfs.roomManager,s=0;s<e.length;s++){var n=SFS2X.Entities.SFSRoom.fromArray(e[s]);t._replaceRoom(n)}},SFS2X.Controllers.SystemController.prototype._getOrCreateUser=function(e,t,s){null==t&&(t=!1);var n=this._sfs.userManager.getUserById(e[0]);if(null==n)(n=SFS2X.Entities.SFSUser.fromArray(e,s))._setUserManager(this._sfs.userManager);else if(null!=s)for(n._setPlayerId(e[3],s),e=e[4],s=0;s<e.length;s++)n._setVariable(SFS2X.Entities.Variables.SFSUserVariable.fromArray(e[s]));return t&&this._sfs.userManager._addUser(n),n},SFS2X.Controllers.ExtensionController=function(e){this.KEY_CMD="c",this.KEY_PARAMS="p",this.KEY_ROOM="r",this._sfs=e,this._id=1,this._log=SFS2X.Logger},SFS2X.Controllers.ExtensionController.prototype.getId=function(){return this._id},SFS2X.Controllers.ExtensionController.prototype.handleMessage=function(e){this._sfs.debug&&this._log.info("IN < ExtensionResponse");var t={};if(t.cmd=e[this.KEY_CMD],t.params=e[this.KEY_PARAMS],null!=e[this.KEY_ROOM]){var e=e[this.KEY_ROOM],s=this._sfs.roomManager.getRoomById(e);t.sourceRoom=e,t.room=s}this._sfs._dispatchEvent(SFS2X.SFSEvent.EXTENSION_RESPONSE,t)},SFS2X.DebugHelper={},SFS2X.DebugHelper.getDump=function(e){return void 0==e?"<Null>":e instanceof Object?this._dumpObject(e):"<Not An Object>"},SFS2X.DebugHelper._dumpObject=function(e){function t(e,s,n){var i=null;SFS2X.DebugHelper._getTabs(n);for(var o in e){var a=e[o];if(null==a)i="Null";else{var r=a.constructor,c=void 0;r===Array||r===Object?(i=null,c=r===Array?"[Array]":"[Object]",t(a,s,n+1)):i=a.constructor===Number?"Num":a.constructor===Boolean?"Bool":a.constructor===String?"Str":"Unsupported"}s.push(SFS2X.DebugHelper._getTabs(n)+o+": "+(void 0==c?a:c)+(void 0==i?"":" ("+i+")"))}}var s=[];return t(e,s,0),SFS2X.DebugHelper._prettyPrint(s)},SFS2X.DebugHelper._getTabs=function(e){if(0>=e)return"";if(1==e)return"\t";for(var t="",s=0;s<e;s++)t+="\t";return t},SFS2X.DebugHelper._prettyPrint=function(e){for(var t="",s=e.length-1;-1<s;s--)t+=e[s]+"\n";return t},SFS2X.Entities={},SFS2X.Entities.Data={},SFS2X.Entities.Variables={},SFS2X.Entities.Match={},SFS2X.Entities.Invitation={},SFS2X.Entities.SFSRoom=Class.extend({init:function(e,t,s){this.id=e,this.name=t,this.groupId=null!=s?s:"default",this.isPasswordProtected=this.isJoined=this.isHidden=this.isGame=!1,this._specCount=this._userCount=this.maxSpectators=this.maxUsers=0,this._isManaged=!0,this.variables={},this.properties={},this._userManager=new SFS2X.Managers.UserManager,this._roomManager=null},toString:function(){return"[Room: "+this.name+", Id: "+this.id+", Group id: "+this.groupId+"]"},getUserCount:function(){return this.isJoined?this.isGame?this.getPlayerList().length:this._userManager.getUserCount():this._userCount},getSpectatorCount:function(){return this.isGame?this.isJoined?this.getSpectatorList().length:this._specCount:0},getCapacity:function(){return this.maxUsers+this.maxSpectators},getUserByName:function(e){return this._userManager.getUserByName(e)},getUserById:function(e){return this._userManager.getUserById(e)},containsUser:function(e){return this._userManager.containsUser(e)},getUserList:function(){return this._userManager.getUserList()},getPlayerList:function(){for(var e=[],t=this._userManager.getUserList(),s=0;s<t.length;s++){var n=t[s];n.isPlayerInRoom(this)&&e.push(n)}return e},getSpectatorList:function(){for(var e=[],t=this._userManager.getUserList(),s=0;s<t.length;s++){var n=t[s];n.isSpectatorInRoom(this)&&e.push(n)}return e},getVariable:function(e){return this.variables[e]},containsVariable:function(e){return null!=this.variables[e]},getVariables:function(){return SFS2X.Utils.ArrayUtil.objToArray(this.variables)},getRoomManager:function(){return this._roomManager},_addUser:function(e){this._userManager._addUser(e)},_removeUser:function(e){this._userManager._removeUser(e)},_setVariables:function(e){for(var t=0;t<e.length;t++)this._setVariable(e[t])},_setVariable:function(e){e.isNull()?delete this.variables[e.name]:this.variables[e.name]=e},_setRoomManager:function(e){if(null!=this._roomManager)throw new SFS2X.Exceptions.SFSError("Room Manager already assigned to Room "+this.toString());this._roomManager=e},_merge:function(e){this.variables=[];for(var t in e.variables)this.variables[t]=e.variables[t];for(this._userManager._clearAll(),e=e.getUserList(),t=0;t<e.length;t++)this._userManager._addUser(e[t])}}),SFS2X.Entities.SFSRoom.fromArray=function(e){var t=14==e.length,s=null;(s=t?new SFS2X.Entities.MMORoom(e[0],e[1],e[2]):new SFS2X.Entities.SFSRoom(e[0],e[1],e[2])).isGame=e[3],s.isHidden=e[4],s.isPasswordProtected=e[5],s._userCount=e[6],s.maxUsers=e[7];var n=e[8];if(null!=n)for(var i=0;i<n.length;i++){var o=SFS2X.Entities.Variables.SFSRoomVariable.fromArray(n[i]);s._setVariable(o)}return s.isGame&&(s._specCount=e[9],s.maxSpectators=e[10]),t&&(s.defaultAOI=SFS2X.Entities.Data.Vec3D.fromArray(e[11]),null!=e[13]&&(s.lowerMapLimit=SFS2X.Entities.Data.Vec3D.fromArray(e[12]),s.higherMapLimit=SFS2X.Entities.Data.Vec3D.fromArray(e[13]))),s},SFS2X.Entities.MMORoom=SFS2X.Entities.SFSRoom.extend({init:function(e,t,s){this._super(e,t,s),this.higherMapLimit=this.lowerMapLimit=this.defaultAOI=null,this._itemsById={}},getMMOItem:function(e){return this._itemsById[e]},getMMOItems:function(){return SFS2X.Utils.ArrayUtil.objToArray(this._itemsById)},_addMMOItem:function(e){this._itemsById[e.id]=e},_removeItem:function(e){delete this._itemsById[e]}}),SFS2X.Entities.SFSUser=function(e,t,s){this.id=e,this.name=t,this.isItMe=null!=s&&s,this.privilegeId=0,this.properties={},this.aoiEntryPoint=null,this.variables={},this._playerIdByRoomId={},this._userManager=null},SFS2X.Entities.SFSUser.fromArray=function(e,t){var s=new SFS2X.Entities.SFSUser(e[0],e[1]);s.privilegeId=e[2],null!=t&&s._setPlayerId(e[3],t);var n=e[4];if(null!=n)for(var i=0;i<n.length;i++){var o=SFS2X.Entities.Variables.SFSUserVariable.fromArray(n[i]);s._setVariable(o)}return s},SFS2X.Entities.SFSUser.prototype.toString=function(){return"[User: "+this.name+", Id: "+this.id+", Is me: "+this.isItMe+"]"},SFS2X.Entities.SFSUser.prototype.isJoinedInRoom=function(e){return e.containsUser(this)},SFS2X.Entities.SFSUser.prototype.isGuest=function(){return this.privilegeId==SFS2X.Entities.UserPrivileges.GUEST},SFS2X.Entities.SFSUser.prototype.isStandardUser=function(){return this.privilegeId==SFS2X.Entities.UserPrivileges.STANDARD},SFS2X.Entities.SFSUser.prototype.isModerator=function(){return this.privilegeId==SFS2X.Entities.UserPrivileges.MODERATOR},SFS2X.Entities.SFSUser.prototype.isAdmin=function(){return this.privilegeId==SFS2X.Entities.UserPrivileges.ADMINISTRATOR},SFS2X.Entities.SFSUser.prototype.isPlayer=function(){return this.isPlayerInRoom(this._userManager._sfs.lastJoinedRoom)},SFS2X.Entities.SFSUser.prototype.isSpectator=function(){return this.isSpectatorInRoom(this._userManager._sfs.lastJoinedRoom)},SFS2X.Entities.SFSUser.prototype.getPlayerId=function(e){var t=0;return null!=this._playerIdByRoomId[e.id]&&(t=this._playerIdByRoomId[e.id]),t},SFS2X.Entities.SFSUser.prototype.isPlayerInRoom=function(e){return!(null==e||!e.isGame)&&0<this._playerIdByRoomId[e.id]},SFS2X.Entities.SFSUser.prototype.isSpectatorInRoom=function(e){return!(null==e||!e.isGame)&&0>this._playerIdByRoomId[e.id]},SFS2X.Entities.SFSUser.prototype.getVariable=function(e){return this.variables[e]},SFS2X.Entities.SFSUser.prototype.containsVariable=function(e){return null!=this.variables[e]},SFS2X.Entities.SFSUser.prototype.getVariables=function(){return SFS2X.Utils.ArrayUtil.objToArray(this.variables)},SFS2X.Entities.SFSUser.prototype.getUserManager=function(){return this._userManager},SFS2X.Entities.SFSUser.prototype._setPlayerId=function(e,t){this._playerIdByRoomId[t.id]=e},SFS2X.Entities.SFSUser.prototype._removePlayerId=function(e){delete this._playerIdByRoomId[e.id]},SFS2X.Entities.SFSUser.prototype._setVariables=function(e){for(var t=0;t<e.length;t++)this._setVariable(e[t])},SFS2X.Entities.SFSUser.prototype._setVariable=function(e){e.isNull()?delete this.variables[e.name]:this.variables[e.name]=e},SFS2X.Entities.SFSUser.prototype._setUserManager=function(e){if(null!=this._userManager)throw new SFS2X.Exceptions.SFSError("User Manager already assigned to user "+this.toString());this._userManager=e},SFS2X.Entities.SFSBuddy=function(e,t,s,n){this.id=e,this.name=t,this.blocked=null!=s&&s,this.temp=null!=n&&n,this.variables={}},SFS2X.Entities.SFSBuddy.fromArray=function(e){for(var t=new SFS2X.Entities.SFSBuddy(e[0],e[1],e[2],4<e.length&&e[4]),e=e[3],s=0;s<e.length;s++){var n=SFS2X.Entities.Variables.SFSBuddyVariable.fromArray(e[s]);t._setVariable(n)}return t},SFS2X.Entities.SFSBuddy.prototype.toString=function(){return"[Buddy: "+this.name+", Id: "+this.id+"]"},SFS2X.Entities.SFSBuddy.prototype.isBlocked=function(){return this.blocked},SFS2X.Entities.SFSBuddy.prototype.isTemp=function(){return this.temp},SFS2X.Entities.SFSBuddy.prototype.isOnline=function(){var e=!0,t=SFS2X.Entities.Variables.ReservedBuddyVariables.BV_ONLINE;return this.containsVariable(t)&&(e=this.getVariable(t).value),e&&-1<this.id},SFS2X.Entities.SFSBuddy.prototype.getState=function(){var e=SFS2X.Entities.Variables.ReservedBuddyVariables.BV_STATE;return this.containsVariable(e)?this.getVariable(e).value:null},SFS2X.Entities.SFSBuddy.prototype.getNickName=function(){var e=SFS2X.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME;return this.containsVariable(e)?this.getVariable(e).value:null},SFS2X.Entities.SFSBuddy.prototype.getVariable=function(e){return this.variables[e]},SFS2X.Entities.SFSBuddy.prototype.containsVariable=function(e){return null!=this.variables[e]},SFS2X.Entities.SFSBuddy.prototype.getVariables=function(){return SFS2X.Utils.ArrayUtil.objToArray(this.variables)},SFS2X.Entities.SFSBuddy.prototype.getOfflineVariables=function(){var e,t=[];for(e in this.variables){var s=this.variables[e];s.name.charAt(0)==SFS2X.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX&&t.push(s)}return t},SFS2X.Entities.SFSBuddy.prototype.getOnlineVariables=function(){var e,t=[];for(e in this.variables){var s=this.variables[e];s.name.charAt(0)!=SFS2X.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX&&t.push(s)}return t},SFS2X.Entities.SFSBuddy.prototype._setVariables=function(e){for(var t=0;t<e.length;t++)this._setVariable(e[t])},SFS2X.Entities.SFSBuddy.prototype._setVariable=function(e){e.isNull()?this._removeVariable(e.name):this.variables[e.name]=e},SFS2X.Entities.SFSBuddy.prototype._removeVariable=function(e){delete this.variables[e]},SFS2X.Entities.SFSBuddy.prototype._clearVolatileVariables=function(){for(var e in this.variables){var t=this.variables[e];t.name.charAt(0)!=SFS2X.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX&&this._removeVariable(t.name)}},SFS2X.Entities.MMOItem=function(e){this.id=e,this.aoiEntryPoint=null,this.variables={}},SFS2X.Entities.MMOItem.fromArray=function(e){var t=new SFS2X.Entities.MMOItem(e[0]);if(null!=(e=e[1]))for(var s=0;s<e.length;s++){var n=SFS2X.Entities.Variables.MMOItemVariable.fromArray(e[s]);t._setVariable(n)}return t},SFS2X.Entities.MMOItem.prototype.toString=function(){return"[Item: "+this.id+"]"},SFS2X.Entities.MMOItem.prototype.getVariable=function(e){return this.variables[e]},SFS2X.Entities.MMOItem.prototype.containsVariable=function(e){return null!=this.variables[e]},SFS2X.Entities.MMOItem.prototype.getVariables=function(){return SFS2X.Utils.ArrayUtil.objToArray(this.variables)},SFS2X.Entities.MMOItem.prototype._setVariables=function(e){for(var t=0;t<e.length;t++)this._setVariable(e[t])},SFS2X.Entities.MMOItem.prototype._setVariable=function(e){null!=e&&(e.isNull()?delete this.variables[e.name]:this.variables[e.name]=e)},SFS2X.Entities.Variables.BaseVariable=Class.extend({init:function(e,t,s){this.name=e,this.value=t,this._setType(s)},toArray:function(){return[this.name,SFS2X.Entities.Variables.VariableType.getTypeIdFromName(this.type),this.value]},isNull:function(){return SFS2X.Entities.Variables.VariableType.getTypeIdFromName(this.type)==SFS2X.Entities.Variables.VariableType.NULL},_setType:function(e){null==e&&(e=-1),-1<e?this.type=this.getTypeName(e):null==this.value?this.type=this.getTypeName(SFS2X.Entities.Variables.VariableType.NULL):"boolean"==(e=m(this.value))?this.type=this.getTypeName(SFS2X.Entities.Variables.VariableType.BOOL):"number"==e?(e=this.value,this.type=e===+e&&e===(0|e)?this.getTypeName(SFS2X.Entities.Variables.VariableType.INT):this.getTypeName(SFS2X.Entities.Variables.VariableType.DOUBLE)):"string"==e?this.type=this.getTypeName(SFS2X.Entities.Variables.VariableType.STRING):"object"==e&&(this.type=this.value instanceof Array?this.getTypeName(SFS2X.Entities.Variables.VariableType.ARRAY):this.getTypeName(SFS2X.Entities.Variables.VariableType.OBJECT))},getTypeName:function(e){return SFS2X.Entities.Variables.VariableType.getTypeName(e)}}),SFS2X.Entities.Variables.SFSUserVariable=SFS2X.Entities.Variables.BaseVariable.extend({init:function(e,t,s){this._super(e,t,s),this.isPrivate=!1},toString:function(){return"[UserVar: "+this.name+", Type: "+this.type+", Value: "+this.value+", Private: "+this.isPrivate+"]"},toArray:function(){var e=this._super();return e.push(this.isPrivate),e}}),SFS2X.Entities.Variables.SFSUserVariable.fromArray=function(e){var t=new SFS2X.Entities.Variables.SFSUserVariable(e[0],e[2],e[1]);return 3<e.length&&(t.isPrivate=e[3]),t},SFS2X.Entities.Variables.SFSRoomVariable=SFS2X.Entities.Variables.BaseVariable.extend({init:function(e,t,s){this._super(e,t,s),this.isPersistent=this.isPrivate=!1},toString:function(){return"[RoomVar: "+this.name+", Type: "+this.type+", Value: "+this.value+", Private: "+this.isPrivate+"]"},toArray:function(){var e=this._super();return e.push(this.isPrivate),e.push(this.isPersistent),e}}),SFS2X.Entities.Variables.SFSRoomVariable.fromArray=function(e){var t=new SFS2X.Entities.Variables.SFSRoomVariable(e[0],e[2],e[1]);return t.isPrivate=e[3],t.isPersistent=e[4],t},SFS2X.Entities.Variables.SFSBuddyVariable=SFS2X.Entities.Variables.BaseVariable.extend({init:function(e,t,s){this._super(e,t,s)},toString:function(){return"[BuddyVar: "+this.name+", Type: "+this.type+", Value: "+this.value+"]"},isOffline:function(){return this.name.charAt(0)==SFS2X.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX}}),SFS2X.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX="$",SFS2X.Entities.Variables.SFSBuddyVariable.fromArray=function(e){return new SFS2X.Entities.Variables.SFSBuddyVariable(e[0],e[2],e[1])},SFS2X.Entities.Variables.MMOItemVariable=SFS2X.Entities.Variables.BaseVariable.extend({init:function(e,t,s){this._super(e,t,s)},toString:function(){return"[ItemVar: "+this.name+", Type: "+this.type+", Value: "+this.value+"]"}}),SFS2X.Entities.Variables.MMOItemVariable.fromArray=function(e){return new SFS2X.Entities.Variables.MMOItemVariable(e[0],e[2],e[1])},SFS2X.Entities.Variables.VariableType={_typeStrings:"Null Bool Int Double String Object Array".split(" "),NULL:0,BOOL:1,INT:2,DOUBLE:3,STRING:4,OBJECT:5,ARRAY:6},SFS2X.Entities.Variables.VariableType.getTypeName=function(e){return this._typeStrings[e]},SFS2X.Entities.Variables.VariableType.getTypeIdFromName=function(e){return this._typeStrings.indexOf(e)},SFS2X.Entities.Variables.ReservedBuddyVariables={},SFS2X.Entities.Variables.ReservedBuddyVariables.BV_ONLINE="$__BV_ONLINE__",SFS2X.Entities.Variables.ReservedBuddyVariables.BV_STATE="$__BV_STATE__",SFS2X.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME="$__BV_NICKNAME__",SFS2X.Entities.Variables.ReservedRoomVariables={},SFS2X.Entities.Variables.ReservedRoomVariables.RV_GAME_STARTED="$GS",SFS2X.Entities.UserPrivileges={},SFS2X.Entities.UserPrivileges.GUEST=0,SFS2X.Entities.UserPrivileges.STANDARD=1,SFS2X.Entities.UserPrivileges.MODERATOR=2,SFS2X.Entities.UserPrivileges.ADMINISTRATOR=3,SFS2X.Entities.Match.MatchExpression=function(e,t,s){this.varName=e,this.condition=t,this.value=s,this._parent=this.next=this.logicOp=null},SFS2X.Entities.Match.MatchExpression.chainedMatchExpression=function(e,t,s,n,i){return e=new SFS2X.Entities.Match.MatchExpression(e,t,s),e.logicOp=n,e._parent=i,e},SFS2X.Entities.Match.MatchExpression.prototype.and=function(e,t,s){return this.next=SFS2X.Entities.Match.MatchExpression.chainedMatchExpression(e,t,s,SFS2X.Entities.Match.LogicOperator.AND,this)},SFS2X.Entities.Match.MatchExpression.prototype.or=function(e,t,s){return this.next=SFS2X.Entities.Match.MatchExpression.chainedMatchExpression(e,t,s,SFS2X.Entities.Match.LogicOperator.OR,this)},SFS2X.Entities.Match.MatchExpression.prototype.hasNext=function(){return null!=this.next},SFS2X.Entities.Match.MatchExpression.prototype.rewind=function(){for(var e=this;null!=e._parent;)e=e._parent;return e},SFS2X.Entities.Match.MatchExpression.prototype.toString=function(){for(var e=this.rewind(),t=e._asString();e.hasNext();)t+=(e=e.next)._asString();return t},SFS2X.Entities.Match.MatchExpression.prototype._asString=function(){var e="";return null!=this.logicOp&&(e+=" "+this.logicOp.id+" "),(e=e+"("+this.varName+" "+this.condition.symbol+" "+("string"==typeof this.value?"'"+this.value+"'":this.value))+")"},SFS2X.Entities.Match.MatchExpression.prototype._toArray=function(){var e=this.rewind(),t=[];for(t.push(e._expressionAsArray());e.hasNext();)e=e.next,t.push(e._expressionAsArray());return t},SFS2X.Entities.Match.MatchExpression.prototype._expressionAsArray=function(){var e=[];return null!=this.logicOp?e.push(this.logicOp.id):e.push(null),e.push(this.varName),e.push(this.condition.type),e.push(this.condition.symbol),e.push(this.value),e},SFS2X.Entities.Match.LogicOperator=function(e){this.id=e},SFS2X.Entities.Match.LogicOperator.AND=new SFS2X.Entities.Match.LogicOperator("AND"),SFS2X.Entities.Match.LogicOperator.OR=new SFS2X.Entities.Match.LogicOperator("OR"),SFS2X.Entities.Match.BoolMatch=function(e){this.type=0,this.symbol=e},SFS2X.Entities.Match.BoolMatch.EQUALS=new SFS2X.Entities.Match.BoolMatch("=="),SFS2X.Entities.Match.BoolMatch.NOT_EQUALS=new SFS2X.Entities.Match.BoolMatch("!="),SFS2X.Entities.Match.NumberMatch=function(e){this.type=1,this.symbol=e},SFS2X.Entities.Match.NumberMatch.EQUALS=new SFS2X.Entities.Match.NumberMatch("=="),SFS2X.Entities.Match.NumberMatch.NOT_EQUALS=new SFS2X.Entities.Match.NumberMatch("!="),SFS2X.Entities.Match.NumberMatch.GREATER_THAN=new SFS2X.Entities.Match.NumberMatch(">"),SFS2X.Entities.Match.NumberMatch.GREATER_THAN_OR_EQUAL_TO=new SFS2X.Entities.Match.NumberMatch(">="),SFS2X.Entities.Match.NumberMatch.LESS_THAN=new SFS2X.Entities.Match.NumberMatch("<"),SFS2X.Entities.Match.NumberMatch.LESS_THAN_OR_EQUAL_TO=new SFS2X.Entities.Match.NumberMatch("<="),SFS2X.Entities.Match.StringMatch=function(e){this.type=2,this.symbol=e},SFS2X.Entities.Match.StringMatch.EQUALS=new SFS2X.Entities.Match.StringMatch("=="),SFS2X.Entities.Match.StringMatch.NOT_EQUALS=new SFS2X.Entities.Match.StringMatch("!="),SFS2X.Entities.Match.StringMatch.CONTAINS=new SFS2X.Entities.Match.StringMatch("contains"),SFS2X.Entities.Match.StringMatch.STARTS_WITH=new SFS2X.Entities.Match.StringMatch("startsWith"),SFS2X.Entities.Match.StringMatch.ENDS_WITH=new SFS2X.Entities.Match.StringMatch("endsWith"),SFS2X.Entities.Match.RoomProperties={},SFS2X.Entities.Match.RoomProperties.NAME="${N}",SFS2X.Entities.Match.RoomProperties.GROUP_ID="${G}",SFS2X.Entities.Match.RoomProperties.MAX_USERS="${MXU}",SFS2X.Entities.Match.RoomProperties.MAX_SPECTATORS="${MXS}",SFS2X.Entities.Match.RoomProperties.USER_COUNT="${UC}",SFS2X.Entities.Match.RoomProperties.SPECTATOR_COUNT="${SC}",SFS2X.Entities.Match.RoomProperties.IS_GAME="${ISG}",SFS2X.Entities.Match.RoomProperties.IS_PRIVATE="${ISP}",SFS2X.Entities.Match.RoomProperties.HAS_FREE_PLAYER_SLOTS="${HFP}",SFS2X.Entities.Match.RoomProperties.IS_TYPE_SFSGAME="${IST}",SFS2X.Entities.Match.UserProperties={},SFS2X.Entities.Match.UserProperties.NAME="${N}",SFS2X.Entities.Match.UserProperties.IS_PLAYER="${ISP}",SFS2X.Entities.Match.UserProperties.IS_SPECTATOR="${ISS}",SFS2X.Entities.Match.UserProperties.IS_NPC="${ISN}",SFS2X.Entities.Match.UserProperties.PRIVILEGE_ID="${PRID}",SFS2X.Entities.Match.UserProperties.IS_IN_ANY_ROOM="${IAR}",SFS2X.Entities.Invitation.SFSInvitation=function(e,t,s,n){this.id=-1,this.inviter=e,this.invitee=t,this.secondsForAnswer=null!=s?s:15,this.params=n},SFS2X.Entities.Invitation.InvitationReply={},SFS2X.Entities.Invitation.InvitationReply.ACCEPT=0,SFS2X.Entities.Invitation.InvitationReply.REFUSE=1,SFS2X.Entities.Invitation.InvitationReply.EXPIRED=255,SFS2X.Entities.Data.Vec3D=function(e,t,s){this.px=null!=e?e:0,this.py=null!=t?t:0,this.pz=null!=s?s:0},SFS2X.Entities.Data.Vec3D.fromArray=function(e){return new SFS2X.Entities.Data.Vec3D(e[0],e[1],e[2])},SFS2X.Entities.Data.Vec3D.prototype.isFloat=function(){return!(this.px===parseInt(this.px)&&this.py===parseInt(this.py)&&this.pz===parseInt(this.pz))},SFS2X.Entities.Data.Vec3D.prototype._toString=function(){return"("+this.px+", "+this.py+", "+this.pz+")"},SFS2X.Entities.Data.Vec3D.prototype._toArray=function(){return[this.px,this.py,this.pz]},SFS2X.ErrorCodes={},SFS2X.ErrorCodes._errorsByCode=["Client API version is obsolete: {0}; required version: {1}","Requested Zone {0} does not exist","User name {0} is not recognized","Wrong password for user {0}","User {0} is banned","Zone {0} is full","User {0} is already logged in Zone {1}","The server is full","Zone {0} is currently inactive","User name {0} contains bad words; filtered: {1}","Guest users not allowed in Zone {0}","IP address {0} is banned","A Room with the same name already exists: {0}","Requested Group is not available - Room: {0}; Group: {1}","Bad Room name length -  Min: {0}; max: {1}; passed name length: {2}","Room name contains bad words: {0}","Zone is full; can't add Rooms anymore","You have exceeded the number of Rooms that you can create per session: {0}","Room creation failed, wrong parameter: {0}","User {0} already joined in Room","Room {0} is full","Wrong password for Room {0}","Requested Room does not exist","Room {0} is locked","Group {0} is already subscribed","Group {0} does not exist","Group {0} is not subscribed","Group {0} does not exist","{0}","Room permission error; Room {0} cannot be renamed","Room permission error; Room {0} cannot change password state","Room permission error; Room {0} cannot change capacity","Switch user error; no player slots available in Room {0}","Switch user error; no spectator slots available in Room {0}","Switch user error; Room {0} is not a Game Room","Switch user error; you are not joined in Room {0}","Buddy Manager initialization error, could not load buddy list: {0}","Buddy Manager error, your buddy list is full; size is {0}","Buddy Manager error, was not able to block buddy {0} because offline","Buddy Manager error, you are attempting to set too many Buddy Variables; limit is {0}","Game {0} access denied, user does not match access criteria","QuickJoinGame action failed: no matching Rooms were found","Your previous invitation reply was invalid or arrived too late"],SFS2X.ErrorCodes.setErrorMessage=function(e,t){this._errorsByCode[e]=t},SFS2X.ErrorCodes.getErrorMessage=function(e,t){return this.stringFormat(this._errorsByCode[e],t)},SFS2X.ErrorCodes.stringFormat=function(e,t){if(null==e)return"";if(null!=t)for(var s=0;s<t.length;s++)e=e.replace("{"+s+"}",t[s]);return e},SFS2X.EventDispatcher=function(){this.listenersByEvent={}},SFS2X.EventDispatcher.prototype.addEventListener=function(e,t,s){null==this.listenersByEvent[e]&&(this.listenersByEvent[e]=[]),this.listenersByEvent[e].push({listener:t,scope:s})},SFS2X.EventDispatcher.prototype.removeEventListener=function(e,t){var s=this.listenersByEvent[e];if(null!=s)for(var n=0;n<s.length;n++)if(s[n].listener===t){s.splice(n,1);break}},SFS2X.EventDispatcher.prototype.dispatchEvent=function(e,t){var s=this.listenersByEvent[e];if(s&&0<s.length)for(var n=0;n<s.length;n++)s[n].listener.call(s[n].scope,t)},SFS2X.EventDispatcher.prototype.getListeners=function(e){return listeners[e]},SFS2X.SFSEvent={HANDSHAKE:"handshake",CONNECTION:"connection",CONNECTION_LOST:"connectionLost",CONNECTION_RETRY:"connectionRetry",CONNECTION_RESUME:"connectionResume",LOGIN:"login",LOGIN_ERROR:"loginError",LOGOUT:"logout",ROOM_ADD:"roomAdd",ROOM_CREATION_ERROR:"roomCreationError",ROOM_REMOVE:"roomRemove",ROOM_JOIN:"roomJoin",ROOM_JOIN_ERROR:"roomJoinError",USER_ENTER_ROOM:"userEnterRoom",USER_EXIT_ROOM:"userExitRoom",USER_COUNT_CHANGE:"userCountChange",PROXIMITY_LIST_UPDATE:"proximityListUpdate",PLAYER_TO_SPECTATOR:"playerToSpectator",PLAYER_TO_SPECTATOR_ERROR:"playerToSpectatorError",SPECTATOR_TO_PLAYER:"spectatorToPlayer",SPECTATOR_TO_PLAYER_ERROR:"spectatorToPlayerError",ROOM_NAME_CHANGE:"roomNameChange",ROOM_NAME_CHANGE_ERROR:"roomNameChangeError",ROOM_PASSWORD_STATE_CHANGE:"roomPasswordStateChange",ROOM_PASSWORD_STATE_CHANGE_ERROR:"roomPasswordStateChangeError",ROOM_CAPACITY_CHANGE:"roomCapacityChange",ROOM_CAPACITY_CHANGE_ERROR:"roomCapacityChangeError",PUBLIC_MESSAGE:"publicMessage",PRIVATE_MESSAGE:"privateMessage",OBJECT_MESSAGE:"objectMessage",MODERATOR_MESSAGE:"moderatorMessage",ADMIN_MESSAGE:"adminMessage",EXTENSION_RESPONSE:"extensionResponse",ROOM_VARIABLES_UPDATE:"roomVariablesUpdate",USER_VARIABLES_UPDATE:"userVariablesUpdate",MMOITEM_VARIABLES_UPDATE:"mmoItemVariablesUpdate",ROOM_GROUP_SUBSCRIBE:"roomGroupSubscribe",ROOM_GROUP_SUBSCRIBE_ERROR:"roomGroupSubscribeError",ROOM_GROUP_UNSUBSCRIBE:"roomGroupUnsubscribe",ROOM_GROUP_UNSUBSCRIBE_ERROR:"roomGroupUnsubscribeError",ROOM_FIND_RESULT:"roomFindResult",USER_FIND_RESULT:"userFindResult",INVITATION:"invitation",INVITATION_REPLY:"invitationReply",INVITATION_REPLY_ERROR:"invitationReplyError",PING_PONG:"pingPong",SOCKET_ERROR:"socketError"},SFS2X.SFSBuddyEvent={BUDDY_LIST_INIT:"buddyListInit",BUDDY_ADD:"buddyAdd",BUDDY_REMOVE:"buddyRemove",BUDDY_BLOCK:"buddyBlock",BUDDY_ERROR:"buddyError",BUDDY_ONLINE_STATE_CHANGE:"buddyOnlineStateChange",BUDDY_VARIABLES_UPDATE:"buddyVariablesUpdate",BUDDY_MESSAGE:"buddyMessage"},SFS2X.Exceptions={},SFS2X.Exceptions.SFSError=Class.extend({init:function(e){this._messsage=e},getMessage:function(){return this._messsage}}),SFS2X.Exceptions.SFSValidationError=SFS2X.Exceptions.SFSError.extend({init:function(e,t){this._super(e),this._errrors=t},getErrors:function(){return this._errrors}}),SFS2X.LogLevel={DEBUG:0,INFO:1,WARN:2,ERROR:3},SFS2X._Logger=function(){this.isAvailable=void 0!=console,this.level=SFS2X.LogLevel.INFO},SFS2X.Logger=new SFS2X._Logger,SFS2X._Logger.prototype.setLevel=function(e){e<SFS2X.LogLevel.DEBUG||e>SFS2X.LogLevel.ERROR||(this.level=e)},SFS2X._Logger.prototype.debug=function(e){this.isAvailable&&this.level<=SFS2X.LogLevel.DEBUG&&console.log("[DEBUG] "+e)},SFS2X._Logger.prototype.info=function(e){this.isAvailable&&this.level<=SFS2X.LogLevel.INFO&&console.log("[INFO] "+e)},SFS2X._Logger.prototype.warn=function(e){this.isAvailable&&this.level<=SFS2X.LogLevel.WARN&&console.log("[WARN] "+e)},SFS2X._Logger.prototype.error=function(e){this.isAvailable&&console.log("[ERROR] "+e)},SFS2X.Managers={},SFS2X.Managers.UserManager=Class.extend({init:function(e){this._sfs=e,this._usersById=new SFS2X.Utils.HashTable,this._usersByName=new SFS2X.Utils.HashTable},containsUserName:function(e){return this._usersByName.hasItem(e)},containsUserId:function(e){return this._usersById.hasItem(e)},containsUser:function(e){return this._usersById.hasItem(e.id)},getUserById:function(e){return this._usersById.getItem(e)},getUserByName:function(e){return this._usersByName.getItem(e)},getUserCount:function(){return this._usersById.length},getUserList:function(){return this._usersById.values()},_addUser:function(e){this._usersById.hasItem(e.id)&&SFS2X.Logger.warn("Unexpected, duplicate user in UserManager: "+e.toString()),this.__addUser(e)},__addUser:function(e){this._usersByName.setItem(e.name,e),this._usersById.setItem(e.id,e)},_removeUser:function(e){this.__removeUser(e)},__removeUser:function(e){this._usersById.removeItem(e.id),this._usersByName.removeItem(e.name)},_removeUserById:function(){this._usersById.removeItem(user.id),this._usersByName.removeItem(user.name)},_clearAll:function(){this._usersById.clear(),this._usersByName.clear()}}),SFS2X.Managers.GlobalUserManager=SFS2X.Managers.UserManager.extend({init:function(e){this._super(e),this._roomRefCount=[]},_addUser:function(e){null==this._roomRefCount[e]?this._roomRefCount[e]=1:this._roomRefCount[e]++,this.__addUser(e)},_removeUser:function(e){this._removeUserReference(e,!1)},_removeUserReference:function(e,t){null!=this._roomRefCount?1>this._roomRefCount[e]?SFS2X.Logger.warn("GlobalUserManager RefCount is already at zero. User: "+e):(0==--this._roomRefCount[e]||t)&&(this.__removeUser(e),delete this._roomRefCount[e]):SFS2X.Logger.warn("Can't remove User from GlobalUserManager. RefCount missing. User: "+e)},dumpRefCount:function(){}}),SFS2X.Managers.RoomManager=function(e){this._sfs=e,this._ownerZone=null,this._groups=[],this._roomsById=new SFS2X.Utils.HashTable,this._roomsByName=new SFS2X.Utils.HashTable},SFS2X.Managers.RoomManager.prototype.getRoomGroups=function(){return this._groups},SFS2X.Managers.RoomManager.prototype.containsGroup=function(e){return-1<this._groups.indexOf(e)},SFS2X.Managers.RoomManager.prototype.containsRoom=function(e){return"number"==typeof e?this._roomsById.hasItem(e):this._roomsByName.hasItem(e)},SFS2X.Managers.RoomManager.prototype.containsRoomInGroup=function(e,t){var s,n=this.getRoomListFromGroup(t),i=!1,o="number"==typeof e;for(s in n){var a=n[s];if(a instanceof SFS2X.Entities.SFSRoom)if(o){if(a.id==e){i=!0;break}}else if(a.name==e){i=!0;break}}return i},SFS2X.Managers.RoomManager.prototype.getRoomById=function(e){return this._roomsById.getItem(e)},SFS2X.Managers.RoomManager.prototype.getRoomByName=function(e){return this._roomsByName.getItem(e)},SFS2X.Managers.RoomManager.prototype.getRoomList=function(){return this._roomsById.values()},SFS2X.Managers.RoomManager.prototype.getRoomCount=function(){return this._roomsById.length},SFS2X.Managers.RoomManager.prototype.getRoomListFromGroup=function(e){var t,s=[];for(t in this._roomsById.items){var n=this._roomsById.items[t];n instanceof SFS2X.Entities.SFSRoom&&n.groupId==e&&s.push(n)}return s},SFS2X.Managers.RoomManager.prototype.getJoinedRooms=function(){var e,t=[];for(e in this._roomsById.items){var s=this._roomsById.items[e];s instanceof SFS2X.Entities.SFSRoom&&s.isJoined&&t.push(s)}return t},SFS2X.Managers.RoomManager.prototype.getUserRooms=function(e){var t,s=[];for(t in this._roomsById.items){var n=this._roomsById.items[t];n instanceof SFS2X.Entities.SFSRoom&&n.containsUser(e)&&s.push(n)}return s},SFS2X.Managers.RoomManager.prototype._addRoom=function(e,t){null==t&&(t=!0),this._roomsById.setItem(e.id,e),this._roomsByName.setItem(e.name,e),t?this.containsGroup(e.groupId)||this._addGroup(e.groupId):e._isManaged=!1},SFS2X.Managers.RoomManager.prototype._replaceRoom=function(e,t){null==t&&(t=!0);var s=this.getRoomById(e.id);return null!=s?(s._merge(e),s):(this._addRoom(e,t),e)},SFS2X.Managers.RoomManager.prototype._removeRoom=function(e){this._roomsById.removeItem(e.id),this._roomsByName.removeItem(e.name)},SFS2X.Managers.RoomManager.prototype._removeRoomById=function(e){null!=(e=this.getRoomById(e))&&this._removeRoom(e)},SFS2X.Managers.RoomManager.prototype._removeRoomByName=function(e){null!=(e=this.getRoomByName(e))&&this._removeRoom(e)},SFS2X.Managers.RoomManager.prototype._changeRoomName=function(e,t){var s=e.name;e.name=t,this._roomsByName.setItem(t,e),this._roomsByName.removeItem(s)},SFS2X.Managers.RoomManager.prototype._changeRoomPasswordState=function(e,t){e.isPasswordProtected=t},SFS2X.Managers.RoomManager.prototype._changeRoomCapacity=function(e,t,s){e.maxUsers=t,e.maxSpectators=s},SFS2X.Managers.RoomManager.prototype._addGroup=function(e){this._groups.push(e)},SFS2X.Managers.RoomManager.prototype._removeGroup=function(e){SFS2X.Utils.ArrayUtil.removeItem(this._groups,e);var t,e=this.getRoomListFromGroup(e);for(t in e){var s=e[t];s instanceof SFS2X.Entities.SFSRoom&&(s.isJoined?s._isManaged=!1:this._removeRoom(s))}},SFS2X.Managers.RoomManager.prototype._removeUser=function(e){for(var t in this._roomsById.items){var s=this._roomsById.items[t];s instanceof SFS2X.Entities.SFSRoom&&s.containsUser(e)&&s._removeUser(e)}},SFS2X.Managers.BuddyManager=function(e){this._sfs=e,this._buddiesByName=[],this._myVariables=[],this._inited=!1,this._buddyStates=[]},SFS2X.Managers.BuddyManager.prototype.isInited=function(){return this._inited},SFS2X.Managers.BuddyManager.prototype.containsBuddy=function(e){return null!=this.getBuddyByName(e)},SFS2X.Managers.BuddyManager.prototype.getBuddyById=function(e){if(-1<e)for(var t in this._buddiesByName){var s=this._buddiesByName[t];if(s instanceof SFS2X.Entities.SFSBuddy&&s.id==e)return s}return null},SFS2X.Managers.BuddyManager.prototype.getBuddyByName=function(e){return this._buddiesByName[e]},SFS2X.Managers.BuddyManager.prototype.getBuddyByNickName=function(e){for(var t in this._buddiesByName){var s=this._buddiesByName[t];if(s instanceof SFS2X.Entities.SFSBuddy&&s.nickName==e)return s}return null},SFS2X.Managers.BuddyManager.prototype.getOfflineBuddies=function(){var e,t=[];for(e in this._buddiesByName){var s=this._buddiesByName[e];s instanceof SFS2X.Entities.SFSBuddy&&!s.isOnline()&&t.push(s)}return t},SFS2X.Managers.BuddyManager.prototype.getOnlineBuddies=function(){var e,t=[];for(e in this._buddiesByName){var s=this._buddiesByName[e];s instanceof SFS2X.Entities.SFSBuddy&&s.isOnline()&&t.push(s)}return t},SFS2X.Managers.BuddyManager.prototype.getBuddyList=function(){return SFS2X.Utils.ArrayUtil.objToArray(this._buddiesByName)},SFS2X.Managers.BuddyManager.prototype.getMyVariable=function(e){return this._myVariables[e]},SFS2X.Managers.BuddyManager.prototype.getMyVariables=function(){return SFS2X.Utils.ArrayUtil.objToArray(this._myVariables)},SFS2X.Managers.BuddyManager.prototype.getMyOnlineState=function(){if(!this._inited)return!1;var e=!0,t=this.getMyVariable(SFS2X.Entities.Variables.ReservedBuddyVariables.BV_ONLINE);return null!=t&&(e=t.value),e},SFS2X.Managers.BuddyManager.prototype.getMyNickName=function(){var e=this.getMyVariable(SFS2X.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME);return null!=e?e.value:null},SFS2X.Managers.BuddyManager.prototype.getMyState=function(){var e=this.getMyVariable(SFS2X.Entities.Variables.ReservedBuddyVariables.BV_STATE);return null!=e?e.value:null},SFS2X.Managers.BuddyManager.prototype.getBuddyStates=function(){return this._buddyStates},SFS2X.Managers.BuddyManager.prototype._setInited=function(){this._inited=!0},SFS2X.Managers.BuddyManager.prototype._addBuddy=function(e){this._buddiesByName[e.name]=e},SFS2X.Managers.BuddyManager.prototype._clearAll=function(){this._buddiesByName=[]},SFS2X.Managers.BuddyManager.prototype._removeBuddyById=function(e){return null!=(e=this.getBuddyById(e))&&delete this._buddiesByName[e.name],e},SFS2X.Managers.BuddyManager.prototype._removeBuddyByName=function(e){var t=this.getBuddyByName(e);return null!=t&&delete this._buddiesByName[e],t},SFS2X.Managers.BuddyManager.prototype._setMyVariables=function(e){for(var t=0;t<e.length;t++)this._setMyVariable(e[t])},SFS2X.Managers.BuddyManager.prototype._setMyVariable=function(e){e.isNull()?delete this._myVariables[e.name]:this._myVariables[e.name]=e},SFS2X.Managers.BuddyManager.prototype._setMyOnlineState=function(e){e=new SFS2X.Entities.Variables.SFSBuddyVariable(SFS2X.Entities.Variables.ReservedBuddyVariables.BV_ONLINE,e),this._setMyVariable(e)},SFS2X.Managers.BuddyManager.prototype._setMyNickName=function(e){e=new SFS2X.Entities.Variables.SFSBuddyVariable(SFS2X.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME,e),this._setMyVariable(e)},SFS2X.Managers.BuddyManager.prototype._setMyState=function(e){e=new SFS2X.Entities.Variables.SFSBuddyVariable(SFS2X.Entities.Variables.ReservedBuddyVariables.BV_STATE,e),this._setMyVariable(e)},SFS2X.Managers.BuddyManager.prototype._setBuddyStates=function(e){this._buddyStates=e},SFS2X.Requests={},SFS2X.Requests.System={},SFS2X.Requests.MMO={},SFS2X.Requests.BuddyList={},SFS2X.Requests.Game={},SFS2X.Requests._BaseRequest=Class.extend({init:function(e){this._reqObj={},this._id=e,this._targetController=0,this._log=SFS2X.Logger},getMessage:function(){return{a:this._id,c:this._targetController,p:this._reqObj}},validate:function(){this._log.error("BaseRequest.validate = no child-class implementation found!")},execute:function(){this._log.error("BaseRequest.execute = no child-class implementation found!")}}),SFS2X.Requests.System.HandshakeRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.Handshake),this._apiVersion=e,this._clientDetails=t,this._reconnectionToken=s},validate:function(){},execute:function(){this._reqObj[this.constructor.KEY_API]=this._apiVersion,this._reqObj[this.constructor.KEY_CLIENT_TYPE]=this._clientDetails,null!=this._reconnectionToken&&(this.reqObj[this.constructor.KEY_RECONNECTION_TOKEN]=this._reconnectionToken)}}),SFS2X.Requests.System.HandshakeRequest.KEY_SESSION_TOKEN="tk",SFS2X.Requests.System.HandshakeRequest.KEY_API="api",SFS2X.Requests.System.HandshakeRequest.KEY_COMPRESSION_THRESHOLD="ct",SFS2X.Requests.System.HandshakeRequest.KEY_RECONNECTION_TOKEN="rt",SFS2X.Requests.System.HandshakeRequest.KEY_CLIENT_TYPE="cl",SFS2X.Requests.System.HandshakeRequest.KEY_MAX_MESSAGE_SIZE="ms",SFS2X.Requests.System.LoginRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s,n){this._super(SFS2X.Requests.Login),this._userName=e,this._password=t,this._params=s,this._zoneName=n},validate:function(e){if(null!=e.mySelf)throw new SFS2X.Exceptions.SFSValidationError("LoginRequest error",["You are already logged in; logout before attempting a new login"]);if(e=null!=e.config&&null!=e.config.zone?e.config.zone:null,null!=this._zoneName&&(e=this._zoneName),null==e||0==e.length)throw new SFS2X.Exceptions.SFSValidationError("LoginRequest Error",["Missing Zone name"]);this._zoneName=e,null==this._userName&&(this._userName=""),null==this._password&&(this._password="")},execute:function(e){this._reqObj[this.constructor.KEY_ZONE_NAME]=this._zoneName,this._reqObj[this.constructor.KEY_USER_NAME]=this._userName,this._reqObj[this.constructor.KEY_PASSWORD]=0<this._password.length?n(e.sessionToken+this._password):"",null!=this._params&&(this._reqObj[this.constructor.KEY_PARAMS]=this._params)}}),SFS2X.Requests.System.LoginRequest.KEY_ZONE_NAME="zn",SFS2X.Requests.System.LoginRequest.KEY_USER_NAME="un",SFS2X.Requests.System.LoginRequest.KEY_PASSWORD="pw",SFS2X.Requests.System.LoginRequest.KEY_PARAMS="p",SFS2X.Requests.System.LoginRequest.KEY_PRIVILEGE_ID="pi",SFS2X.Requests.System.LoginRequest.KEY_ID="id",SFS2X.Requests.System.LoginRequest.KEY_ROOMLIST="rl",SFS2X.Requests.System.LoginRequest.KEY_RECONNECTION_SECONDS="rs",SFS2X.Requests.System.LogoutRequest=SFS2X.Requests._BaseRequest.extend({init:function(){this._super(SFS2X.Requests.Logout)},validate:function(e){if(null==e.mySelf)throw new SFS2X.Exceptions.SFSValidationError("LogoutRequest error",["You are not logged in"])},execute:function(){}}),SFS2X.Requests.System.LogoutRequest.KEY_ZONE_NAME="zn",SFS2X.Requests.System.JoinRoomRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s,n){this._super(SFS2X.Requests.JoinRoom),"string"==typeof e?this._rName=e:"number"==typeof e?this._rId=e:e instanceof SFS2X.Entities.SFSRoom&&(this._rId=e.id,this._rName=e.name),this._password=t,this._roomIdToLeave=s,this._asSpectator="boolean"==typeof n&&n},validate:function(){if(null==this._rId&&null==this._rName)throw new SFS2X.Exceptions.SFSValidationError("JoinRoomRequest Error",["Missing Room id or name, please provide one of the two or an existing Room object"])},execute:function(e){e._isJoining=!0,0<=this._rId?this._reqObj[this.constructor.KEY_ROOM_ID]=this._rId:null!=this._rName&&(this._reqObj[this.constructor.KEY_ROOM_NAME]=this._rName),null!=this._password&&(this._reqObj[this.constructor.KEY_PASS]=this._password),null!=this._roomIdToLeave&&(this._reqObj[this.constructor.KEY_ROOM_TO_LEAVE]=this._roomIdToLeave),this._asSpectator&&(this._reqObj[this.constructor.KEY_AS_SPECTATOR]=this._asSpectator)}}),SFS2X.Requests.System.JoinRoomRequest.KEY_ROOM="r",SFS2X.Requests.System.JoinRoomRequest.KEY_USER_LIST="ul",SFS2X.Requests.System.JoinRoomRequest.KEY_ROOM_NAME="n",SFS2X.Requests.System.JoinRoomRequest.KEY_ROOM_ID="i",SFS2X.Requests.System.JoinRoomRequest.KEY_PASS="p",SFS2X.Requests.System.JoinRoomRequest.KEY_ROOM_TO_LEAVE="rl",SFS2X.Requests.System.JoinRoomRequest.KEY_AS_SPECTATOR="sp",SFS2X.Requests.System.CreateRoomRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.CreateRoom),this._settings=e,this._autoJoin="boolean"==typeof t&&t,this._roomToLeave=s},validate:function(){var e=[];if((null==this._settings.name||0==this._settings.name.length)&&e.push("Missing Room name"),0>=this._settings.maxUsers&&e.push("Max number of users must be > 0"),null!=this._settings.extension&&((null==this._settings.extension.className||0==this._settings.extension.className.length)&&e.push("Missing Extension class name"),(null==this._settings.extension.id||0==this._settings.extension.id.length)&&e.push("Missing Extension id")),this._settings instanceof SFS2X.Requests.MMO.MMORoomSettings&&(null==this._settings.defaultAOI&&e.push("Missing default AoI (Area of Interest)"),null!=this._settings.mapLimits&&(null==this._settings.mapLimits.lowerLimit||null==this._settings.mapLimits.higherLimit)&&e.push("Map limits must be both defined")),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("CreateRoomRequest Error",e)},execute:function(){if(this._reqObj[this.constructor.KEY_NAME]=this._settings.name,this._reqObj[this.constructor.KEY_GROUP_ID]=this._settings.groupId,this._reqObj[this.constructor.KEY_PASSWORD]=this._settings.password,this._reqObj[this.constructor.KEY_ISGAME]=this._settings.isGame,this._reqObj[this.constructor.KEY_MAXUSERS]=this._settings.maxUsers,this._reqObj[this.constructor.KEY_MAXSPECTATORS]=this._settings.maxSpectators,this._reqObj[this.constructor.KEY_MAXVARS]=this._settings.maxVariables,this._reqObj[this.constructor.KEY_ALLOW_JOIN_INVITATION_BY_OWNER]=this._settings.allowOwnerOnlyInvitation,null!=this._settings.variables&&0<this._settings.variables.length){var e,t=[];for(e in this._settings.variables){var s=this._settings.variables[e];s instanceof SFS2X.Entities.Variables.SFSRoomVariable&&t.push(s.toArray())}this._reqObj[this.constructor.KEY_ROOMVARS]=t}null!=this._settings.permissions&&((t=[]).push(this._settings.permissions.allowNameChange),t.push(this._settings.permissions.allowPasswordStateChange),t.push(this._settings.permissions.allowPublicMessages),t.push(this._settings.permissions.allowResizing),this._reqObj[this.constructor.KEY_PERMISSIONS]=t),null!=this._settings.events&&((t=[]).push(this._settings.events.allowUserEnter),t.push(this._settings.events.allowUserExit),t.push(this._settings.events.allowUserCountChange),t.push(this._settings.events.allowUserVariablesUpdate),this._reqObj[this.constructor.KEY_EVENTS]=t),null!=this._settings.extension&&(this._reqObj[this.constructor.KEY_EXTID]=this._settings.extension.id,this._reqObj[this.constructor.KEY_EXTCLASS]=this._settings.extension.className,null!=this._settings.extension.propertiesFile&&0<this._settings.extension.propertiesFile.length&&(this._reqObj[this.constructor.KEY_EXTPROP]=this._settings.extension.propertiesFile)),this._settings instanceof SFS2X.Requests.MMO.MMORoomSettings&&(this._reqObj[this.constructor.KEY_MMO_DEFAULT_AOI]=this._settings.defaultAOI._toArray(),null!=this._settings.mapLimits&&(this._reqObj[this.constructor.KEY_MMO_MAP_LOW_LIMIT]=this._settings.mapLimits.lowerLimit._toArray(),this._reqObj[this.constructor.KEY_MMO_MAP_HIGH_LIMIT]=this._settings.mapLimits.higherLimit._toArray()),this._reqObj[this.constructor.KEY_MMO_USER_MAX_LIMBO_SECONDS]=this._settings.userMaxLimboSeconds,this._reqObj[this.constructor.KEY_MMO_PROXIMITY_UPDATE_MILLIS]=this._settings.proximityListUpdateMillis,this._reqObj[this.constructor.KEY_MMO_SEND_ENTRY_POINT]=this._settings.sendAOIEntryPoint),this._reqObj[this.constructor.KEY_AUTOJOIN]=this._autoJoin,null!=this._roomToLeave&&(this._reqObj[this.constructor.KEY_ROOM_TO_LEAVE]=this._roomToLeave.id)}}),SFS2X.Requests.System.CreateRoomRequest.KEY_ROOM="r",SFS2X.Requests.System.CreateRoomRequest.KEY_NAME="n",SFS2X.Requests.System.CreateRoomRequest.KEY_PASSWORD="p",SFS2X.Requests.System.CreateRoomRequest.KEY_GROUP_ID="g",SFS2X.Requests.System.CreateRoomRequest.KEY_ISGAME="ig",SFS2X.Requests.System.CreateRoomRequest.KEY_MAXUSERS="mu",SFS2X.Requests.System.CreateRoomRequest.KEY_MAXSPECTATORS="ms",SFS2X.Requests.System.CreateRoomRequest.KEY_MAXVARS="mv",SFS2X.Requests.System.CreateRoomRequest.KEY_ROOMVARS="rv",SFS2X.Requests.System.CreateRoomRequest.KEY_PERMISSIONS="pm",SFS2X.Requests.System.CreateRoomRequest.KEY_EVENTS="ev",SFS2X.Requests.System.CreateRoomRequest.KEY_EXTID="xn",SFS2X.Requests.System.CreateRoomRequest.KEY_EXTCLASS="xc",SFS2X.Requests.System.CreateRoomRequest.KEY_EXTPROP="xp",SFS2X.Requests.System.CreateRoomRequest.KEY_AUTOJOIN="aj",SFS2X.Requests.System.CreateRoomRequest.KEY_ROOM_TO_LEAVE="rl",SFS2X.Requests.System.CreateRoomRequest.KEY_ALLOW_JOIN_INVITATION_BY_OWNER="aji",SFS2X.Requests.System.CreateRoomRequest.KEY_MMO_DEFAULT_AOI="maoi",SFS2X.Requests.System.CreateRoomRequest.KEY_MMO_MAP_LOW_LIMIT="mllm",SFS2X.Requests.System.CreateRoomRequest.KEY_MMO_MAP_HIGH_LIMIT="mlhm",SFS2X.Requests.System.CreateRoomRequest.KEY_MMO_USER_MAX_LIMBO_SECONDS="muls",SFS2X.Requests.System.CreateRoomRequest.KEY_MMO_PROXIMITY_UPDATE_MILLIS="mpum",SFS2X.Requests.System.CreateRoomRequest.KEY_MMO_SEND_ENTRY_POINT="msep",SFS2X.Requests.System.GenericMessageRequest=SFS2X.Requests._BaseRequest.extend({init:function(){this._super(SFS2X.Requests.GenericMessage),this._type=-1,this._recipient=this._params=this._message=this._user=this._room=null,this._sendMode=-1},validate:function(e){if(0>this._type)throw new SFS2X.Exceptions.SFSValidationError("GenericMessageRequest Error",["Unsupported message type: "+this._type]);var t=[];switch(this._type){case SFS2X.Requests.GenericMessageType.PUBLIC_MSG:this._validatePublicMessage(e,t);break;case SFS2X.Requests.GenericMessageType.PRIVATE_MSG:this._validatePrivateMessage(e,t);break;case SFS2X.Requests.GenericMessageType.OBJECT_MSG:this._validateObjectMessage(e,t);break;case SFS2X.Requests.GenericMessageType.BUDDY_MSG:this._validateBuddyMessage(e,t);break;default:this._validateSuperUserMessage(e,t)}if(0<t.length)throw new SFS2X.Exceptions.SFSValidationError("GenericMessageRequest Error",t)},execute:function(e){switch(this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE_TYPE]=this._type,this._type){case SFS2X.Requests.GenericMessageType.PUBLIC_MSG:this._executePublicMessage(e);break;case SFS2X.Requests.GenericMessageType.PRIVATE_MSG:this._executePrivateMessage(e);break;case SFS2X.Requests.GenericMessageType.OBJECT_MSG:this._executeObjectMessage(e);break;case SFS2X.Requests.GenericMessageType.BUDDY_MSG:this._executeBuddyMessage(e);break;default:this._executeSuperUserMessage(e)}},_validatePublicMessage:function(e,t){(null==this._message||0==this._message.length)&&t.push("Public message is empty"),null!=this._room&&!e.mySelf.isJoinedInRoom(this._room)&&t.push("You are not joined in the target Room: "+this._room)},_validatePrivateMessage:function(e,t){(null==this._message||0==this._message.length)&&t.push("Private message is empty"),0>this._recipient&&t.push("Invalid recipient id: "+this._recipient)},_validateObjectMessage:function(e,t){null==this._params&&t.push("Object message is null")},_validateBuddyMessage:function(e,t){e.buddyManager.isInited||t.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0==e.buddyManager.myOnlineState&&t.push("Can't send messages while you are offline in the Buddy List system"),(null==this._message||0==this._message.length)&&t.push("Buddy message is empty"),0>this._recipient&&t.push("Recipient is offline or not in your Buddy List")},_validateSuperUserMessage:function(e,t){switch((null==this._message||0==this._message.length)&&t.push("Moderator message is empty"),this._sendMode){case SFS2X.Requests.MessageRecipientMode.TO_USER:this._recipient instanceof SFS2X.Entities.SFSUser||t.push("SFSUser object expected as recipient");break;case SFS2X.Requests.MessageRecipientMode.TO_ROOM:this._recipient instanceof SFS2X.Entities.SFSRoom||t.push("SFSRoom object expected as recipient");break;case SFS2X.Requests.MessageRecipientMode.TO_GROUP:"string"!=typeof this._recipient&&t.push("String object (the groupId) expected as recipient")}},_executePublicMessage:function(e){if(null==this._room&&(this._room=e.lastJoinedRoom),null==this._room)throw new SFS2X.Exceptions.SFSError("User should be joined in a Room in order to send a public message");this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_ROOM_ID]=this._room.id,this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_USER_ID]=e.mySelf.id,this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params)},_executePrivateMessage:function(){this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient,this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params)},_executeBuddyMessage:function(){this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient,this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params)},_executeSuperUserMessage:function(){switch(this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params),this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT_MODE]=this._sendMode,this._sendMode){case SFS2X.Requests.MessageRecipientMode.TO_USER:case SFS2X.Requests.MessageRecipientMode.TO_ROOM:this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient.id;break;case SFS2X.Requests.MessageRecipientMode.TO_GROUP:this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient}},_executeObjectMessage:function(e){if(null==this._room&&(this._room=e.lastJoinedRoom),null==this._room)throw new SFS2X.Exceptions.SFSError("User should be joined in a Room in order to send an object message");if(e=[],null!=this._recipient&&this._recipient instanceof Array){var t=this._recipient;if(t.length>this._room.capacity)throw new SFS2X.Exceptions.SFSError("The number of recipients is bigger than the target Room capacity: "+t.length);for(var s in t){var n=t[s];n instanceof SFS2X.Entities.SFSUser?e.push(n.id):this._log.warn("Bad recipient in ObjectMessage recipient list: "+(void 0===n?"undefined":m(n))+"; expected type: SFSUser")}}this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_ROOM_ID]=this._room.id,this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params,0<e.length&&(this._reqObj[SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=e)}}),SFS2X.Requests.System.GenericMessageRequest.KEY_ROOM_ID="r",SFS2X.Requests.System.GenericMessageRequest.KEY_USER_ID="u",SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE="m",SFS2X.Requests.System.GenericMessageRequest.KEY_MESSAGE_TYPE="t",SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT="rc",SFS2X.Requests.System.GenericMessageRequest.KEY_RECIPIENT_MODE="rm",SFS2X.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS="p",SFS2X.Requests.System.GenericMessageRequest.KEY_SENDER_DATA="sd",SFS2X.Requests.System.ChangeRoomNameRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t){this._super(SFS2X.Requests.ChangeRoomName),this._room=e,this._newName=t},validate:function(){var e=[];if(null==this._room&&e.push("Provided Room is null"),(null==this._newName||0==this._newName.length)&&e.push("Invalid new room name: it must be a non-null and non-empty string"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("ChangeRoomNameRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_NAME]=this._newName}}),SFS2X.Requests.System.ChangeRoomNameRequest.KEY_ROOM="r",SFS2X.Requests.System.ChangeRoomNameRequest.KEY_NAME="n",SFS2X.Requests.System.ChangeRoomPasswordStateRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t){this._super(SFS2X.Requests.ChangeRoomPassword),this._room=e,this._newPass=t},validate:function(){var e=[];if(null==this._room&&e.push("Provided Room is null"),null==this._newPass&&e.push("Invalid new room name: it must be a non-null string"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("ChangeRoomPasswordStateRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_PASS]=this._newPass}}),SFS2X.Requests.System.ChangeRoomPasswordStateRequest.KEY_ROOM="r",SFS2X.Requests.System.ChangeRoomPasswordStateRequest.KEY_PASS="p",SFS2X.Requests.System.ObjectMessageRequest=SFS2X.Requests.System.GenericMessageRequest.extend({init:function(e,t,s){this._super(),this._type=SFS2X.Requests.GenericMessageType.OBJECT_MSG,this._params=e,this._room=t,this._recipient=s}}),SFS2X.Requests.System.SetRoomVariablesRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t){this._super(SFS2X.Requests.SetRoomVariables),this._roomVariables=e,this._room=t},validate:function(e){var t=[];if(null!=this._room?this._room.containsUser(e.mySelf)||t.push("You are not joined in the target Room"):null==e.lastJoinedRoom&&t.push("You are not joined in any Room"),(null==this._roomVariables||0==this._roomVariables.length)&&t.push("No variables were specified"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("SetRoomVariablesRequest Error",t)},execute:function(e){var t,s=[];for(t in this._roomVariables){var n=this._roomVariables[t];n instanceof SFS2X.Entities.Variables.SFSRoomVariable&&s.push(n.toArray())}null==this._room&&(this._room=e.lastJoinedRoom),this._reqObj[this.constructor.KEY_VAR_LIST]=s,this._reqObj[this.constructor.KEY_VAR_ROOM]=this._room.id}}),SFS2X.Requests.System.SetRoomVariablesRequest.KEY_VAR_ROOM="r",SFS2X.Requests.System.SetRoomVariablesRequest.KEY_VAR_LIST="vl",SFS2X.Requests.System.SetUserVariablesRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.SetUserVariables),this._userVariables=e},validate:function(){var e=[];if((null==this._userVariables||0==this._userVariables.length)&&e.push("No variables were specified"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("SetUserVariablesRequest Error",e)},execute:function(){var e,t=[];for(e in this._userVariables){var s=this._userVariables[e];s instanceof SFS2X.Entities.Variables.SFSUserVariable&&t.push(s.toArray())}this._reqObj[this.constructor.KEY_VAR_LIST]=t}}),SFS2X.Requests.System.SetUserVariablesRequest.KEY_USER="u",SFS2X.Requests.System.SetUserVariablesRequest.KEY_VAR_LIST="vl",SFS2X.Requests.System.ExtensionRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.CallExtension),this._targetController=1,this._extCmd=e,this._params=t,this._room=s,null==this._params&&(this._params={})},validate:function(){var e=[];if((null==this._extCmd||0==this._extCmd.length)&&e.push("Missing extension command"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("ExtensionRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_CMD]=this._extCmd,this._reqObj[this.constructor.KEY_ROOM]=null==this._room?-1:this._room.id,this._reqObj[this.constructor.KEY_PARAMS]=this._params}}),SFS2X.Requests.System.ExtensionRequest.KEY_CMD="c",SFS2X.Requests.System.ExtensionRequest.KEY_PARAMS="p",SFS2X.Requests.System.ExtensionRequest.KEY_ROOM="r",SFS2X.Requests.System.LeaveRoomRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.LeaveRoom),this._room=e},validate:function(e){if(1>e.getJoinedRooms().length)throw new SFS2X.Exceptions.SFSValidationError("LeaveRoomRequest Error",["You are not joined in any room"])},execute:function(){null!=this._room&&(this._reqObj[this.constructor.KEY_ROOM_ID]=this._room.id)}}),SFS2X.Requests.System.LeaveRoomRequest.KEY_ROOM_ID="r",SFS2X.Requests.System.SubscribeRoomGroupRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.SubscribeRoomGroup),this._groupId=e},validate:function(){var e=[];if((null==this._groupId||0==this._groupId.length)&&e.push("Invalid group id passed; must be a string with at least one character"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("SubscribeGroupRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_GROUP_ID]=this._groupId}}),SFS2X.Requests.System.SubscribeRoomGroupRequest.KEY_GROUP_ID="g",SFS2X.Requests.System.SubscribeRoomGroupRequest.KEY_ROOM_LIST="rl",SFS2X.Requests.System.UnsubscribeRoomGroupRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.UnsubscribeRoomGroup),this._groupId=e},validate:function(){var e=[];if((null==this._groupId||0==this._groupId.length)&&e.push("Invalid group id passed; must be a string with at least one character"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("UnsubscribeGroupRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_GROUP_ID]=this._groupId}}),SFS2X.Requests.System.UnsubscribeRoomGroupRequest.KEY_GROUP_ID="g",SFS2X.Requests.System.SpectatorToPlayerRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.SpectatorToPlayer),this._room=e},validate:function(e){if(1>e.getJoinedRooms().length)throw new SFS2X.Exceptions.SFSValidationError("SpectatorToPlayerRequest Error",["You are not joined in any room"])},execute:function(e){null==this._room&&(this._room=e.lastJoinedRoom),this._reqObj[this.constructor.KEY_ROOM_ID]=this._room.id}}),SFS2X.Requests.System.SpectatorToPlayerRequest.KEY_ROOM_ID="r",SFS2X.Requests.System.SpectatorToPlayerRequest.KEY_USER_ID="u",SFS2X.Requests.System.SpectatorToPlayerRequest.KEY_PLAYER_ID="p",SFS2X.Requests.System.PlayerToSpectatorRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.PlayerToSpectator),this._room=e},validate:function(e){if(1>e.getJoinedRooms().length)throw new SFS2X.Exceptions.SFSValidationError("PlayerToSpectatorRequest Error",["You are not joined in any room"])},execute:function(e){null==this._room&&(this._room=e.lastJoinedRoom),this._reqObj[this.constructor.KEY_ROOM_ID]=this._room.id}}),SFS2X.Requests.System.PlayerToSpectatorRequest.KEY_ROOM_ID="r",SFS2X.Requests.System.PlayerToSpectatorRequest.KEY_USER_ID="u",SFS2X.Requests.System.ChangeRoomCapacityRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.ChangeRoomCapacity),this._room=e,this._newMaxUsers=t,this._newMaxSpect=s},validate:function(){var e=[];if(null==this._room&&e.push("Provided Room is null"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("ChangeRoomCapacityRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_USER_SIZE]=this._newMaxUsers,this._reqObj[this.constructor.KEY_SPEC_SIZE]=this._newMaxSpect}}),SFS2X.Requests.System.ChangeRoomCapacityRequest.KEY_ROOM="r",SFS2X.Requests.System.ChangeRoomCapacityRequest.KEY_USER_SIZE="u",SFS2X.Requests.System.ChangeRoomCapacityRequest.KEY_SPEC_SIZE="s",SFS2X.Requests.System.PublicMessageRequest=SFS2X.Requests.System.GenericMessageRequest.extend({init:function(e,t,s){this._super(),this._type=SFS2X.Requests.GenericMessageType.PUBLIC_MSG,this._message=e,this._room=s,this._params=t}}),SFS2X.Requests.System.PrivateMessageRequest=SFS2X.Requests.System.GenericMessageRequest.extend({init:function(e,t,s){this._super(),this._type=SFS2X.Requests.GenericMessageType.PRIVATE_MSG,this._message=e,this._recipient=t,this._params=s}}),SFS2X.Requests.System.ModeratorMessageRequest=SFS2X.Requests.System.GenericMessageRequest.extend({init:function(e,t,s){if(this._super(),null==t)throw new SFS2X.Exceptions.SFSError("Recipient mode cannot be null");this._type=SFS2X.Requests.GenericMessageType.MODERATOR_MSG,this._message=e,this._params=s,this._recipient=t.target,this._sendMode=t.mode}}),SFS2X.Requests.System.AdminMessageRequest=SFS2X.Requests.System.GenericMessageRequest.extend({init:function(e,t,s){if(this._super(),null==t)throw new SFS2X.Exceptions.SFSError("Recipient mode cannot be null");this._type=SFS2X.Requests.GenericMessageType.ADMING_MSG,this._message=e,this._params=s,this._recipient=t.target,this._sendMode=t.mode}}),SFS2X.Requests.System.KickUserRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.KickUser),null==s&&(s=5),0>s&&(s=0),this._userId=e,this._message=t,this._delay=s},validate:function(){var e=[];if(0<e.length)throw new SFS2X.Exceptions.SFSValidationError("KickUserRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_USER_ID]=this._userId,this._reqObj[this.constructor.KEY_DELAY]=this._delay,null!=this._message&&0<this._message.length&&(this._reqObj[this.constructor.KEY_MESSAGE]=this._message)}}),SFS2X.Requests.System.KickUserRequest.KEY_USER_ID="u",SFS2X.Requests.System.KickUserRequest.KEY_MESSAGE="m",SFS2X.Requests.System.KickUserRequest.KEY_DELAY="d",SFS2X.Requests.System.BanUserRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s,n,i){this._super(SFS2X.Requests.BanUser),null==s&&(s=1),null==n&&(n=5),null==i&&(i=24),this._userId=e,this._message=t,this._banMode=s,this._delay=n,this._durationHours=i},validate:function(){var e=[];if(0<e.length)throw new SFS2X.Exceptions.SFSValidationError("BanUserRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_USER_ID]=this._userId,this._reqObj[this.constructor.KEY_DELAY]=this._delay,this._reqObj[this.constructor.KEY_BAN_MODE]=this._banMode,this._reqObj[this.constructor.KEY_BAN_DURATION_HOURS]=this._durationHours,null!=this._message&&0<this._message.length&&(this._reqObj[this.constructor.KEY_MESSAGE]=this._message)}}),SFS2X.Requests.System.BanUserRequest.KEY_USER_ID="u",SFS2X.Requests.System.BanUserRequest.KEY_MESSAGE="m",SFS2X.Requests.System.BanUserRequest.KEY_DELAY="d",SFS2X.Requests.System.BanUserRequest.KEY_BAN_MODE="b",SFS2X.Requests.System.BanUserRequest.KEY_BAN_DURATION_HOURS="dh",SFS2X.Requests.System.ManualDisconnectionRequest=SFS2X.Requests._BaseRequest.extend({init:function(){this._super(SFS2X.Requests.ManualDisconnection)},validate:function(){},execute:function(){}}),SFS2X.Requests.System.FindRoomsRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.FindRooms),null==s&&(s=0),this._matchExpr=e,this._groupId=t,this._limit=s},validate:function(){var e=[];if(null==this._matchExpr&&e.push("Missing match expression"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("FindRoomsRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_EXPRESSION]=this._matchExpr._toArray(),null!=this._groupId&&(this._reqObj[this.constructor.KEY_GROUP]=this._groupId),0<this._limit&&(this._reqObj[this.constructor.KEY_LIMIT]=this._limit)}}),SFS2X.Requests.System.FindRoomsRequest.KEY_EXPRESSION="e",SFS2X.Requests.System.FindRoomsRequest.KEY_GROUP="g",SFS2X.Requests.System.FindRoomsRequest.KEY_LIMIT="l",SFS2X.Requests.System.FindRoomsRequest.KEY_FILTERED_ROOMS="fr",SFS2X.Requests.System.FindUsersRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.FindUsers),null==s&&(s=0),this._matchExpr=e,this._target=t,this._limit=s},validate:function(){var e=[];if(null==this._matchExpr&&e.push("Missing match expression"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("FindUsersRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_EXPRESSION]=this._matchExpr._toArray(),null!=this._target&&(this._target instanceof SFS2X.Entities.SFSRoom?this._reqObj[this.constructor.KEY_ROOM]=this._target.id:"string"==typeof this._target?this._reqObj[this.constructor.KEY_GROUP]=this._target:this._log.warn("Unsupport target type for FindUsersRequest: "+this._target)),0<this._limit&&(this._reqObj[this.constructor.KEY_LIMIT]=this._limit)}}),SFS2X.Requests.System.FindUsersRequest.KEY_EXPRESSION="e",SFS2X.Requests.System.FindUsersRequest.KEY_GROUP="g",SFS2X.Requests.System.FindUsersRequest.KEY_ROOM="r",SFS2X.Requests.System.FindUsersRequest.KEY_LIMIT="l",SFS2X.Requests.System.FindUsersRequest.KEY_FILTERED_USERS="fu",SFS2X.Requests.System.PingPongRequest=SFS2X.Requests._BaseRequest.extend({init:function(){this._super(SFS2X.Requests.PingPong)},validate:function(){},execute:function(){}}),SFS2X.Requests.MMO.SetUserPositionRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t){this._super(SFS2X.Requests.SetUserPosition),this._pos=e,this._room=t},validate:function(e){var t=[];if(null==this._pos&&t.push("Position must be a Vec3D instance"),null==this._room&&(this._room=e.lastJoinedRoom),this._room instanceof SFS2X.Entities.MMORoom||t.push("Passed Room is not an MMORoom"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("SetUserPosition Error",t)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_VEC3D]=this._pos._toArray()}}),SFS2X.Requests.MMO.SetUserPositionRequest.KEY_ROOM="r",SFS2X.Requests.MMO.SetUserPositionRequest.KEY_VEC3D="v",SFS2X.Requests.MMO.SetUserPositionRequest.KEY_PLUS_USER_LIST="p",SFS2X.Requests.MMO.SetUserPositionRequest.KEY_MINUS_USER_LIST="m",SFS2X.Requests.MMO.SetUserPositionRequest.KEY_PLUS_ITEM_LIST="q",SFS2X.Requests.MMO.SetUserPositionRequest.KEY_MINUS_ITEM_LIST="n",SFS2X.Requests.MMO.SetMMOItemVariables={},SFS2X.Requests.MMO.SetMMOItemVariables.KEY_ROOM_ID="r",SFS2X.Requests.MMO.SetMMOItemVariables.KEY_ITEM_ID="i",SFS2X.Requests.MMO.SetMMOItemVariables.KEY_VAR_LIST="v",SFS2X.Requests.BuddyList.InitBuddyListRequest=SFS2X.Requests._BaseRequest.extend({init:function(){this._super(SFS2X.Requests.InitBuddyList)},validate:function(e){var t=[];if(e.buddyManager.isInited()&&t.push("Buddy List is already initialized"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("InitBuddyListRequest Error",t)},execute:function(){}}),SFS2X.Requests.BuddyList.InitBuddyListRequest.KEY_BLIST="bl",SFS2X.Requests.BuddyList.InitBuddyListRequest.KEY_BUDDY_STATES="bs",SFS2X.Requests.BuddyList.InitBuddyListRequest.KEY_MY_VARS="mv",SFS2X.Requests.BuddyList.AddBuddyRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.AddBuddy),this._name=e},validate:function(e){var t=[];if(e.buddyManager.isInited()||t.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),(null==this._name||1>this._name.length)&&t.push("Invalid buddy name (null or empty string)"),0==e.buddyManager.getMyOnlineState()&&t.push("Can't add a buddy while you are offline in the Buddy List system"),null!=(e=e.buddyManager.getBuddyByName(this._name))&&!e.isTemp()&&t.push("Can't add buddy '"+this._name+"' because it is already in your list"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("AddBuddyRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_BUDDY_NAME]=this._name}}),SFS2X.Requests.BuddyList.AddBuddyRequest.KEY_BUDDY_NAME="bn",SFS2X.Requests.BuddyList.BlockBuddyRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t){this._super(SFS2X.Requests.BlockBuddy),this._name=e,this._blocked=t},validate:function(e){var t=[];if(e.buddyManager.isInited()||t.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),(null==this._name||1>this._name.length)&&t.push("Invalid buddy name (null or empty string)"),0==e.buddyManager.getMyOnlineState()&&t.push("Can't block a buddy while you are offline in the Buddy List system"),null==(e=e.buddyManager.getBuddyByName(this._name))?t.push("Can't block buddy '"+this._name+"' because it isn't in your list"):e.isBlocked()==this._blocked&&t.push("Block flag is already in the requested '"+this._blocked+"' state for buddy "+this._name),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("BlockBuddyRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_BUDDY_NAME]=this._name,this._reqObj[this.constructor.KEY_BUDDY_BLOCK_STATE]=this._blocked}}),SFS2X.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_NAME="bn",SFS2X.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_BLOCK_STATE="bs",SFS2X.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY="bd",SFS2X.Requests.BuddyList.RemoveBuddyRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.RemoveBuddy),this._name=e},validate:function(e){var t=[];if(e.buddyManager.isInited()||t.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0==e.buddyManager.getMyOnlineState()&&t.push("Can't remove a buddy while you are offline in the Buddy List system"),e.buddyManager.containsBuddy(this._name)||t.push("Can't remove buddy '"+this._name+"' because it isn't in your list"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("RemoveBuddyRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_BUDDY_NAME]=this._name}}),SFS2X.Requests.BuddyList.RemoveBuddyRequest.KEY_BUDDY_NAME="bn",SFS2X.Requests.BuddyList.SetBuddyVariablesRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.SetBuddyVariables),this._buddyVariables=e},validate:function(e){var t=[];if(e.buddyManager.isInited()||t.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0==e.buddyManager.getMyOnlineState()&&t.push("Can't set Buddy Variables while you are offline in the Buddy List system"),(null==this._buddyVariables||0==this._buddyVariables.length)&&t.push("No Buddy Variables to set have been specified"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("SetBuddyVariablesRequest Error",t)},execute:function(){var e,t=[];for(e in this._buddyVariables){var s=this._buddyVariables[e];s instanceof SFS2X.Entities.Variables.SFSBuddyVariable&&t.push(s.toArray())}this._reqObj[this.constructor.KEY_BUDDY_VARS]=t}}),SFS2X.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_NAME="bn",SFS2X.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_VARS="bv",SFS2X.Requests.BuddyList.GoOnlineRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.GoOnline),this._online=e},validate:function(e){var t=[];if(e.buddyManager.isInited()||t.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("GoOnlineRequest Error",t)},execute:function(e){e.buddyManager._setMyOnlineState(this._online),this._reqObj[this.constructor.KEY_ONLINE]=this._online}}),SFS2X.Requests.BuddyList.GoOnlineRequest.KEY_ONLINE="o",SFS2X.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_NAME="bn",SFS2X.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_ID="bi",SFS2X.Requests.BuddyList.BuddyMessageRequest=SFS2X.Requests.System.GenericMessageRequest.extend({init:function(e,t,s){this._super(),this._type=SFS2X.Requests.GenericMessageType.BUDDY_MSG,this._message=e,this._recipient=null!=t?t.id:-1,this._params=s}}),SFS2X.Requests.Game.InviteUsersRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.InviteUsers),this._invitedUsers=e,this._secondsForAnswer=t,this._params=s},validate:function(){var e=[];if((null==this._invitedUsers||1>this._invitedUsers.length)&&e.push("No invitation(s) to send"),this._invitedUsers.length>this.constructor.MAX_INVITATIONS_FROM_CLIENT_SIDE&&e.push("Too many invitations; "+this.constructor.MAX_INVITATIONS_FROM_CLIENT_SIDE+" max are allowed from client side"),(this._secondsForAnswer<this.constructor.MIN_EXPIRY_TIME||this._secondsForAnswer>this.constructor.MAX_EXPIRY_TIME)&&e.push("secondsForAnswer value is out of range (min: "+this.constructor.MIN_EXPIRY_TIME+"; max: "+this.constructor.MAX_EXPIRY_TIME+")"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("InviteUsersRequest Error",e)},execute:function(e){var t,s=[];for(t in this._invitedUsers){var n=this._invitedUsers[t];(n instanceof SFS2X.Entities.SFSUser||n instanceof SFS2X.Entities.SFSBuddy)&&n!=e.mySelf&&s.push(n.id)}this._reqObj[this.constructor.KEY_INVITED_USERS]=s,this._reqObj[this.constructor.KEY_TIME]=this._secondsForAnswer,null!=this._params&&(this._reqObj[this.constructor.KEY_PARAMS]=this._params)}}),SFS2X.Requests.Game.InviteUsersRequest.KEY_USER="u",SFS2X.Requests.Game.InviteUsersRequest.KEY_USER_ID="ui",SFS2X.Requests.Game.InviteUsersRequest.KEY_INVITATION_ID="ii",SFS2X.Requests.Game.InviteUsersRequest.KEY_TIME="t",SFS2X.Requests.Game.InviteUsersRequest.KEY_PARAMS="p",SFS2X.Requests.Game.InviteUsersRequest.KEY_INVITEE_ID="ee",SFS2X.Requests.Game.InviteUsersRequest.KEY_INVITED_USERS="iu",SFS2X.Requests.Game.InviteUsersRequest.KEY_REPLY_ID="ri",SFS2X.Requests.Game.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE=8,SFS2X.Requests.Game.InviteUsersRequest.MIN_EXPIRY_TIME=5,SFS2X.Requests.Game.InviteUsersRequest.MAX_EXPIRY_TIME=300,SFS2X.Requests.Game.InvitationReplyRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.InvitationReply),this._invitation=e,this._reply=t,this._params=s},validate:function(){var e=[];if(null==this._invitation&&e.push("Missing invitation object"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("InvitationReplyRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_INVITATION_ID]=this._invitation.id,this._reqObj[this.constructor.KEY_INVITATION_REPLY]=this._reply,null!=this._params&&(this._reqObj[this.constructor.KEY_INVITATION_PARAMS]=this._params)}}),SFS2X.Requests.Game.InvitationReplyRequest.KEY_INVITATION_ID="i",SFS2X.Requests.Game.InvitationReplyRequest.KEY_INVITATION_REPLY="r",SFS2X.Requests.Game.InvitationReplyRequest.KEY_INVITATION_PARAMS="p",SFS2X.Requests.Game.CreateSFSGameRequest=SFS2X.Requests._BaseRequest.extend({init:function(e){this._super(SFS2X.Requests.CreateSFSGame),this._settings=e,this._createRoomRequest=new SFS2X.Requests.System.CreateRoomRequest(e,!1,null)},validate:function(e){var t=[];try{this._createRoomRequest.validate(e)}catch(e){t=e.getErrors()}if(this._settings.minPlayersToStartGame>this._settings.maxUsers&&t.push("Minimum number of players to start the game can't be greater than the Room's maximum number of users"),(this._settings.invitationExpiryTime<SFS2X.Requests.Game.InviteUsersRequest.MIN_EXPIRY_TIME||this._settings.invitationExpiryTime>SFS2X.Requests.Game.InviteUsersRequest.MAX_EXPIRY_TIME)&&t.push("Invitation expiration time value is out of range (min: "+SFS2X.Requests.Game.InviteUsersRequest.MIN_EXPIRY_TIME+"; max: "+SFS2X.Requests.Game.InviteUsersRequest.MAX_EXPIRY_TIME+")"),null!=this._settings.invitedPlayers&&this._settings.invitedPlayers.length>SFS2X.Requests.Game.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE&&t.push("Can't invite more than "+SFS2X.Requests.Game.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE+" players from client side"),0<t.length)throw new SFS2X.Exceptions.SFSValidationError("CreateSFSGameRequest Error",t)},execute:function(e){if(this._createRoomRequest.execute(e),this._reqObj=this._createRoomRequest._reqObj,this._reqObj[this.constructor.KEY_IS_PUBLIC]=this._settings.isPublic,this._reqObj[this.constructor.KEY_MIN_PLAYERS]=this._settings.minPlayersToStartGame,this._reqObj[this.constructor.KEY_INVITATION_EXPIRY]=this._settings.invitationExpiryTime,this._reqObj[this.constructor.KEY_LEAVE_ROOM]=this._settings.leaveLastJoinedRoom,this._reqObj[this.constructor.KEY_NOTIFY_GAME_STARTED]=this._settings.notifyGameStarted,null!=this._settings.playerMatchExpression&&(this._reqObj[this.constructor.KEY_PLAYER_MATCH_EXP]=this._settings.playerMatchExpression._toArray()),null!=this._settings.spectatorMatchExpression&&(this._reqObj[this.constructor.KEY_SPECTATOR_MATCH_EXP]=this._settings.spectatorMatchExpression._toArray()),null!=this._settings.invitedPlayers){var t,e=[];for(t in this._settings.invitedPlayers){var s=this._settings.invitedPlayers[t];(s instanceof SFS2X.Entities.SFSUser||s instanceof SFS2X.Entities.SFSBuddy)&&e.push(s.id)}this._reqObj[this.constructor.KEY_INVITED_PLAYERS]=e}null!=this._settings.searchableRooms&&(this._reqObj[this.constructor.KEY_SEARCHABLE_ROOMS]=this._settings.searchableRooms),null!=this._settings.invitationParams&&(this._reqObj[this.constructor.KEY_INVITATION_PARAMS]=this._settings.invitationParams)}}),SFS2X.Requests.Game.CreateSFSGameRequest.KEY_IS_PUBLIC="gip",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_MIN_PLAYERS="gmp",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_INVITED_PLAYERS="ginp",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_SEARCHABLE_ROOMS="gsr",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_PLAYER_MATCH_EXP="gpme",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_SPECTATOR_MATCH_EXP="gsme",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_INVITATION_EXPIRY="gie",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_LEAVE_ROOM="glr",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_NOTIFY_GAME_STARTED="gns",SFS2X.Requests.Game.CreateSFSGameRequest.KEY_INVITATION_PARAMS="ip",SFS2X.Requests.Game.QuickJoinGameRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s){this._super(SFS2X.Requests.QuickJoinGame),this._matchExpression=e,this._whereToSearch=t,this._roomToLeave=s},validate:function(){var e=[];if(null==this._whereToSearch||1>this._whereToSearch.length?e.push("Missing lis of Rooms or Group name where to search the game to join"):this._whereToSearch.length>this.constructor.MAX_ROOMS&&e.push("Too many Rooms specified in list where to search the game to join; client limit is: "+this.constructor.MAX_ROOMS),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("CreateSFSGameRequest Error",e)},execute:function(){if("string"==typeof this._whereToSearch[0])this._reqObj[this.constructor.KEY_GROUP_LIST]=this._whereToSearch;else{if(!(this._whereToSearch[0]instanceof SFS2X.Entities.SFSRoom))throw new SFS2X.Exceptions.SFSError("Invalid type in whereToSearch parameter");for(var e=[],t=0;t<this._whereToSearch.length;t++){var s=this._whereToSearch[t];s instanceof SFS2X.Entities.SFSRoom&&e.push(s.id)}this._reqObj[this.constructor.KEY_ROOM_LIST]=e}null!=this._roomToLeave&&(this._reqObj[this.constructor.KEY_ROOM_TO_LEAVE]=this._roomToLeave.id),null!=this._matchExpression&&(this._reqObj[this.constructor.KEY_MATCH_EXPRESSION]=this._matchExpression._toArray())}}),SFS2X.Requests.Game.QuickJoinGameRequest.KEY_ROOM_LIST="rl",SFS2X.Requests.Game.QuickJoinGameRequest.KEY_GROUP_LIST="gl",SFS2X.Requests.Game.QuickJoinGameRequest.KEY_ROOM_TO_LEAVE="tl",SFS2X.Requests.Game.QuickJoinGameRequest.KEY_MATCH_EXPRESSION="me",SFS2X.Requests.Game.QuickJoinGameRequest.MAX_ROOMS=32,SFS2X.Requests.Game.JoinRoomInvitationRequest=SFS2X.Requests._BaseRequest.extend({init:function(e,t,s,n,i){this._super(SFS2X.Requests.JoinRoomInvite),this._targetRoom=e,this._invitedUserNames=t,this._params=s,this._expirySeconds=n,this._asSpectator=i},validate:function(){var e=[];if(null==this._targetRoom&&e.push("Missing target room"),(null==this._invitedUserNames||1>this._invitedUserNames.length)&&e.push("No invitees provided"),0<e.length)throw new SFS2X.Exceptions.SFSValidationError("JoinRoomInvitationRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_ROOM_ID]=this._targetRoom.id,this._reqObj[this.constructor.KEY_INVITED_NAMES]=this._invitedUserNames,this._reqObj[this.constructor.KEY_EXPIRY_SECONDS]=this._expirySeconds,this._reqObj[this.constructor.KEY_AS_SPECT]=this._asSpectator,null!=this._params&&(this._reqObj[this.constructor.KEY_OPTIONAL_PARAMS]=this._params)}}),SFS2X.Requests.Game.JoinRoomInvitationRequest.KEY_ROOM_ID="r",SFS2X.Requests.Game.JoinRoomInvitationRequest.KEY_EXPIRY_SECONDS="es",SFS2X.Requests.Game.JoinRoomInvitationRequest.KEY_INVITED_NAMES="in",SFS2X.Requests.Game.JoinRoomInvitationRequest.KEY_AS_SPECT="as",SFS2X.Requests.Game.JoinRoomInvitationRequest.KEY_OPTIONAL_PARAMS="op",SFS2X.Requests.Handshake=0,SFS2X.Requests.Login=1,SFS2X.Requests.Logout=2,SFS2X.Requests.JoinRoom=4,SFS2X.Requests.CreateRoom=6,SFS2X.Requests.GenericMessage=7,SFS2X.Requests.ChangeRoomName=8,SFS2X.Requests.ChangeRoomPassword=9,SFS2X.Requests.SetRoomVariables=11,SFS2X.Requests.SetUserVariables=12,SFS2X.Requests.CallExtension=13,SFS2X.Requests.LeaveRoom=14,SFS2X.Requests.SubscribeRoomGroup=15,SFS2X.Requests.UnsubscribeRoomGroup=16,SFS2X.Requests.SpectatorToPlayer=17,SFS2X.Requests.PlayerToSpectator=18,SFS2X.Requests.ChangeRoomCapacity=19,SFS2X.Requests.KickUser=24,SFS2X.Requests.BanUser=25,SFS2X.Requests.ManualDisconnection=26,SFS2X.Requests.FindRooms=27,SFS2X.Requests.FindUsers=28,SFS2X.Requests.PingPong=29,SFS2X.Requests.SetUserPosition=30,SFS2X.Requests.InitBuddyList=200,SFS2X.Requests.AddBuddy=201,SFS2X.Requests.BlockBuddy=202,SFS2X.Requests.RemoveBuddy=203,SFS2X.Requests.SetBuddyVariables=204,SFS2X.Requests.GoOnline=205,SFS2X.Requests.InviteUsers=300,SFS2X.Requests.InvitationReply=301,SFS2X.Requests.CreateSFSGame=302,SFS2X.Requests.QuickJoinGame=303,SFS2X.Requests.JoinRoomInvite=304,SFS2X.Requests.getRequestNameFromId=function(e){for(var t in SFS2X.Requests)if(SFS2X.Requests[t]==e)return t;return null},SFS2X.Requests.RoomSettings=Class.extend({init:function(e){this.name=e,this.password="",this.groupId="default",this.isGame=!1,this.maxUsers=10,this.maxSpectators=0,this.maxVariables=5,this.variables=[],this.extension=this.events=this.permissions=null,this.allowOwnerOnlyInvitation=!0}}),SFS2X.Requests.Game.SFSGameSettings=SFS2X.Requests.RoomSettings.extend({init:function(e){this._super(e),this.isPublic=!0,this.minPlayersToStartGame=2,this.searchableRooms=this.invitedPlayers=null,this.invitationExpiryTime=15,this.leaveLastJoinedRoom=!0,this.notifyGameStarted=!1,this.invitationParams=this.spectatorMatchExpression=this.playerMatchExpression=null}}),SFS2X.Requests.MMO.MMORoomSettings=SFS2X.Requests.RoomSettings.extend({init:function(e){this._super(e),this.mapLimits=this.defaultAOI=null,this.userMaxLimboSeconds=50,this.proximityListUpdateMillis=250,this.sendAOIEntryPoint=!0}}),SFS2X.Requests.RoomPermissions=function(){this.allowPasswordStateChange=this.allowNameChange=!1,this.allowPublicMessages=!0,this.allowResizing=!1},SFS2X.Requests.RoomEvents=function(){this.allowUserVariablesUpdate=this.allowUserExit=this.allowUserEnter=this.allowUserCountChange=!1},SFS2X.Requests.RoomExtension=function(e,t){this.id=e,this.className=t,this.propertiesFile=""},SFS2X.Requests.MMO.MapLimits=function(e,t){if(null==e||null==t)throw new SFS2X.Exceptions.SFSError("Map limits arguments must be both non null!");this.lowerLimit=e,this.higherLimit=t},SFS2X.Requests.GenericMessageType={},SFS2X.Requests.GenericMessageType.PUBLIC_MSG=0,SFS2X.Requests.GenericMessageType.PRIVATE_MSG=1,SFS2X.Requests.GenericMessageType.MODERATOR_MSG=2,SFS2X.Requests.GenericMessageType.ADMING_MSG=3,SFS2X.Requests.GenericMessageType.OBJECT_MSG=4,SFS2X.Requests.GenericMessageType.BUDDY_MSG=5,SFS2X.Requests.MessageRecipientMode=function(e,t){if(e<this.TO_USER||e>this.TO_ZONE)throw new SFS2X.Exceptions.SFSError("Illegal recipient mode: "+e);this.mode=e,this.target=t},SFS2X.Requests.MessageRecipientMode.TO_USER=0,SFS2X.Requests.MessageRecipientMode.TO_ROOM=1,SFS2X.Requests.MessageRecipientMode.TO_GROUP=2,SFS2X.Requests.MessageRecipientMode.TO_ZONE=3,SFS2X.Requests.BanMode={},SFS2X.Requests.BanMode.BY_ADDRESS=0,SFS2X.Requests.BanMode.BY_NAME=1,SFS2X.SocketEngine=function(e){this.isConnecting=this.isConnected=!1,this.reconnectionSeconds=0,this._controllers={},this._log=SFS2X.Logger,this._socket=null,this._maxMessageSize=1e4,this._sfs=e,this._lastTcpPort=0,this._reconnectionDelayMillis=1e3,this._attemptingReconnection=this._isReconnecting=!1,this._eventDispatcher=new SFS2X.EventDispatcher,this._disconnectionReason=SFS2X.Utils.ClientDisconnectionReason.UNKNOWN},SFS2X.SocketEngine.prototype.connect=function(e,t,s){this.isConnected?this._log.error("Connection is already active"):this.isConnecting?this._log.error("A connection attempt is already in progress"):(this.isConnecting=!0,this._socket=new WebSocket("ws"+(s?"s":"")+"://"+e+":"+t+"/websocket"),this._socket._scope=this,this._socket.onopen=this._onSocketConnect,this._socket.onclose=this._onSocketDisconnect,this._socket.onmessage=this._onSocketData,this._socket.onerror=this._onSocketError)},SFS2X.SocketEngine.prototype.disconnect=function(e){this._disconnectionReason=e,this._socket.close()},SFS2X.SocketEngine.prototype.addEventListener=function(e,t,s){this._eventDispatcher.addEventListener(e,t,s)},SFS2X.SocketEngine.prototype.removeEventListener=function(e,t){this._eventDispatcher.removeEventListener(e,t)},SFS2X.SocketEngine.prototype.addController=function(e,t){null==this._controllers[e]&&(this._controllers[e]=t)},SFS2X.SocketEngine.prototype.removeController=function(e){delete this._controllers[e]},SFS2X.SocketEngine.prototype.send=function(e){e=this._encodeMessage(e),this._socket.send(e)},SFS2X.SocketEngine.prototype._decodeMessage=function(e){return JSON.parse(e)},SFS2X.SocketEngine.prototype._encodeMessage=function(e){return JSON.stringify(e)},SFS2X.SocketEngine.prototype._onSocketConnect=function(){this._scope.isConnected=!0,this._scope.isConnecting=!1,this._scope._log.debug("SOCKET CONNECTION OK"),this._scope._eventDispatcher.dispatchEvent(SFS2X.SocketEvent.CONNECT,{success:!0,isReconnection:this._scope._attemptingReconnection})},SFS2X.SocketEngine.prototype._onSocketDisconnect=function(){if(this._scope.isConnected=!1,this._scope.isConnecting){this._scope.isConnecting=!1;var e={success:!1,isReconnection:this._scope._attemptingReconnection};this._scope._eventDispatcher.dispatchEvent(SFS2X.SocketEvent.CONNECT,e)}else e={reason:this._scope._disconnectionReason},this._scope._eventDispatcher.dispatchEvent(SFS2X.SocketEvent.DISCONNECT,e),this._scope._disconnectionReason=SFS2X.Utils.ClientDisconnectionReason.UNKNOWN},SFS2X.SocketEngine.prototype._onSocketData=function(e){this._scope._eventDispatcher.dispatchEvent(SFS2X.SocketEvent.DATA,this._scope._decodeMessage(e.data))},SFS2X.SocketEngine.prototype._onSocketError=function(e){this._scope._eventDispatcher.dispatchEvent(SFS2X.SocketEvent.IOERROR,e.data)},SFS2X.SocketEvent={CONNECT:"socketConnect",DISCONNECT:"socketDisconnect",DATA:"data",IOERROR:"socketIOError"},cc._RF.pop()},{}],SceneManager:[function(e,t,s){"use strict";cc._RF.push(t,"4d5a4GeqTtCs6Mt86ShVhHH","SceneManager"),cc.Class({properties:{curScene:"",_callback:null,_isLoading:!1,HallScene:"HallScene",StartScene:"StartScene",LoginScene:"LoginScene",UpdateScene:"UpdateScene",PlayScene:"PlayScene"},enterHallScene:function(e){if(!this._isLoading){if(this.curScene==this.HallScene||cc.director.getScene().name==this.HallScene)return this._callback=e,void this.onSceneLoaded();this._callback=e,this._isLoading=!0,this.curScene=this.HallScene,TipsManager.showLoadingTips(),cc.director.loadScene(this.HallScene,this.onSceneLoaded.bind(this))}},enterPlayScene:function(e){if(!this._isLoading){if(this.curScene==this.PlayScene||cc.director.getScene().name==this.PlayScene)return this._callback=e,void this.onSceneLoaded();this._callback=e,this._isLoading=!0,this.curScene=this.PlayScene,TipsManager.showLoadingTips(),cc.director.loadScene(this.PlayScene,this.onSceneLoaded.bind(this))}},enterLoginScene:function(e){if(!this._isLoading){if(this.curScene==this.LoginScene||cc.director.getScene().name==this.LoginScene)return this._callback=e,void this.onSceneLoaded();this._callback=e,this._isLoading=!0,this.curScene=this.LoginScene,TipsManager.showLoadingTips(),cc.director.loadScene(this.LoginScene,this.onSceneLoaded.bind(this))}},enterUpdateScene:function(e){if(!this._isLoading){if(this.curScene==this.UpdateScene||cc.director.getScene().name==this.UpdateScene)return this._callback=e,void this.onSceneLoaded();this._callback=e,this._isLoading=!0,this.curScene=this.UpdateScene,TipsManager.showLoadingTips(),cc.director.loadScene(this.UpdateScene,this.onSceneLoaded.bind(this))}},enterStartScene:function(e){if(!this._isLoading){if(this.curScene==this.StartScene||cc.director.getScene().name==this.StartScene)return this._callback=e,void this.onSceneLoaded();this._callback=e,this._isLoading=!0,this.curScene=this.StartScene,TipsManager.showLoadingTips(),cc.director.loadScene(this.StartScene,this.onSceneLoaded.bind(this))}},onSceneLoaded:function(e){this._isLoading=!1,TipsManager.closeLoadingTips(),e&&cc.log("load scene faild! reason: ",e),this._callback&&this._callback(null==e),this._callback=null},isInHallScene:function(){return this.curScene===this.HallScene},isInPlayScene:function(){return!this._isLoading&&this.curScene===this.PlayScene},getCurScene:function(){return this.curScene}}),cc._RF.pop()},{}],Setting:[function(e,t,s){"use strict";cc._RF.push(t,"ddc81dKjzRHLKQlHNlBejAW","Setting"),cc.Class({extends:cc.Component,properties:{Slider_yinyue:cc.Slider,Sprite_yinyue:cc.Node,Sprite_yinyue_di:cc.Node,Slider_yinxiao:cc.Slider,Sprite_yinxiao:cc.Node,btnQuitRoom:cc.Button,showQuitButton:{get:function(){return Boolean(this.btnQuitRoom&&this.btnQuitRoom.node.active)},set:function(e){this.btnQuitRoom&&(this.btnQuitRoom.node.active=Boolean(e))}},_hallEnter:Boolean,hallEnter:{visible:!1,get:function(){return this._hallEnter},set:function(e){this._hallEnter=e}}},onLoad:function(){this.node.setContentSize(cc.winSize);var e=this.Sprite_yinyue_di.getContentSize();this.Slider_yinxiao.progress=Storage.sfxVolume,this.Slider_yinyue.progress=Storage.bgmVolume,this.Sprite_yinxiao.width=e.width*this.Slider_yinxiao.progress,this.Sprite_yinyue.width=e.width*this.Slider_yinyue.progress},close:function(){AudioManager.playSFX("effects/return.mp3"),this.node.active=!1},onSliderAction:function(){cc.log("onSliderAction");var e=this.Sprite_yinyue_di.getContentSize();this.Sprite_yinyue.width=e.width*this.Slider_yinyue.progress,AudioManager.setBGMVolume(this.Slider_yinyue.progress)},onSliderAction_yinxiao:function(){cc.log("onSliderAction_yinxiao");var e=this.Sprite_yinyue_di.getContentSize();this.Sprite_yinxiao.width=e.width*this.Slider_yinxiao.progress,AudioManager.setSFXVolume(this.Slider_yinxiao.progress)},onQuitRoomClick:function(){1==this._hallEnter?u_retartGame(!0):this.node.getComponent("NQuitRoom").send()}}),cc._RF.pop()},{}],Share:[function(e,t,s){"use strict";cc._RF.push(t,"c29a7MF3kxFIqgGblyd4K/4","Share"),cc.Class({extends:cc.Component,properties:{},close:function(){this.node.active=!1},onClickShareWx:function(){cc.log("onClickShareWx")},onClickSharePyq:function(){cc.log("onClickSharePyq")}}),cc._RF.pop()},{}],SocketHelper:[function(e,t,s){"use strict";cc._RF.push(t,"6dbf2gJl1NLVb2cmorw2Gey","SocketHelper"),cc.Class({properties:{sfs:null,host:"",port:0,zone:"",connectedHandler:null,disConnectedHandler:null,loginHandler:null,joinHandler:null,recivedHandler:null,_oldHost:"",_oldPort:0,_lastJoinRoom:null,reason:"",isLogined:!1},ctor:function(){this.sfs=new SFS2X.SmartFox,this.sfs.addEventListener(SFS2X.SFSEvent.CONNECTION,this._onConnection,this),this.sfs.addEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this._onConnectionLost,this),this.sfs.addEventListener(SFS2X.SFSEvent.LOGIN,this._onLogin,this),this.sfs.addEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this._onLoginError,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this._onJoin,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this._onJoinError,this),this.sfs.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this._onRecived,this)},_onConnection:function(e){cc.log("sfs connect to server! "+this.host+":"+this.port+" res:"+e.success),this.connectedHandler&&this.connectedHandler(e)},_onConnectionLost:function(e){cc.log("sfs server disconnected! "+(this._oldHost||this.host)+":"+(this._oldPort||this.port));var t=e;null==this.reason&&""==this.reason||(t=this.reason),this.disConnectedHandler&&this.disConnectedHandler(t),this.isLogined=!1},_onLogin:function(e){cc.log('sfs login zone: "'+this.zone+'"'),this.loginHandler&&this.loginHandler({res:!0,data:e}),this.isLogined=!0},_onLoginError:function(e){cc.log('sfs login error! zone: "'+this.zone+'"'),this.loginHandler&&this.loginHandler({res:!1,data:e}),this.isLogined=!1},_onJoin:function(e){cc.log("sfs join to room: ",e.room),this.joinHandler&&this.joinHandler({res:!0,data:e})},_onJoinError:function(e){cc.log("sfs join error!"),this.joinHandler&&this.joinHandler({res:!1,data:e})},_onRecived:function(e){"ping"!=e.cmd&&cc.log('<<<<<sfs recived data! msg: "'+e.cmd+'" data:',e.params),this.recivedHandler&&this.recivedHandler(e)},connect:function(e,t){if(e&&e.match(/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/))if(!t||t<1||t>65535)cc.log("sfs connect ivalid host port: "+t);else{if(this.sfs.isConnected())return this.host!=e||this.port!=t?void this.switchconnect(e,t):void this._onConnection({success:!0});cc.log("old server :",this.host,this.port),this.host=e,this.port=t,cc.log("sfs begin connect to server! "+this.host+":"+this.port),this.sfs.connect(e,t)}else cc.log("sfs connect ivalid host address: "+e)},switchconnect:function(e,t){function s(n){this.sfs.removeEventListener(SFS2X.SFSEvent.CONNECTION_LOST,s,this),cc.log("sfs switchconnect!",e,t),this.connect(e,t)}this.sfs.isConnected()||this.connect(e,t),this.sfs.addEventListener(SFS2X.SFSEvent.CONNECTION_LOST,s,this),this.disconnect(EventCode.SFS_EVENT_CONNECT_DISCONNECT_REASON_MANUAL)},disconnect:function(e){this.reason=e,cc.log("sfs begin disconnect server! "),this._oldHost=this.host,this._oldPort=this.port,this.sfs.disconnect(e)},login:function(e,t,s){this.isLogined?this._onLogin({res:!0}):(e+="",this.zone=s,this.sfs.send(new SFS2X.Requests.System.LoginRequest(e,t,null,s)),cc.log("sfs begin login! account:"+e+" passwd:"+t+" zone:"+s))},join:function(e){e+="",this.sfs.send(new SFS2X.Requests.System.JoinRoomRequest(e)),cc.log("sfs begin join to game! roomid:"+e)},send:function(e,t){"ping"!=e&&cc.log('>>>>>sfs send data! msg: "'+e+'" data:',t),this.sfs.send(new SFS2X.Requests.System.ExtensionRequest(e,t,this.sfs.lastJoinedRoom))},isConnected:function(){return this.sfs&&this.sfs.isConnected()}}),cc._RF.pop()},{}],StartScene:[function(e,t,s){"use strict";cc._RF.push(t,"9de2dIfQH5CFKjOsreHCpls","StartScene"),cc.Class({extends:cc.Component,properties:{manifestUrl:cc.RawAsset,_updateRes:null},_versionCompareHandle:function(e,t){cc.log("JS Custom Version Compare: version A is "+e+", version B is "+t);for(var s=e.split("."),n=t.split("."),i=0;i<s.length;++i){var o=parseInt(s[i]),a=parseInt(n[i]||0);if(o!==a)return o-a}return n.length>s.length?-1:0},onLoad:function(){e("PublicFunctions"),e("AppStart"),globalInit(),cc.log(this.manifestUrl)},onAnimPlayFinished:function(){var e=function(){if(this._updateRes)switch(this._updateRes.result){case eUpdateType.NO_UPDATE:cc.log("no update!"),SceneManager.enterLoginScene();break;case eUpdateType.RESOURCE_UPDATE:cc.log("resource update!"),SceneManager.enterUpdateScene();break;case eUpdateType.PACKAGE_UPDATE:cc.log("package update!"),TipsManager.showTipsBox(CText.packageUpdate,[1,2],function(e){e==eBtnType.Sure&&cc.sys.openURL(Config.urlPackage),cc.game.end()});break;default:cc.log("unknown update res code: "+this._updateRes)}else this.scheduleOnce(e)}.bind(this);cc.director.loadScene("LoginScene")}}),cc._RF.pop()},{AppStart:"AppStart",PublicFunctions:"PublicFunctions"}],Storage:[function(e,t,s){"use strict";cc._RF.push(t,"da3e6TvrcpG0KDv8Gm72vSr","Storage"),cc.Class({properties:{loginAccount:{get:function(){return cc.sys.localStorage.getItem("login_account")},set:function(e){cc.sys.localStorage.setItem("login_account",e)}},inputAccount:{get:function(){return cc.sys.localStorage.getItem("input_account")||"tt1"},set:function(e){cc.sys.localStorage.setItem("input_account",e)}},loginSign:{get:function(){return cc.sys.localStorage.getItem("login_sign")},set:function(e){cc.sys.localStorage.setItem("login_sign",e)}},bgmVolume:{get:function(){return cc.sys.localStorage.getItem("bgm_volume")||.5},set:function(e){cc.sys.localStorage.setItem("bgm_volume",e)}},sfxVolume:{get:function(){return cc.sys.localStorage.getItem("sfx_volume")||.5},set:function(e){cc.sys.localStorage.setItem("sfx_volume",e)}},finishClassMode:{get:function(){return cc.sys.localStorage.getItem("finish_classMode")||!1},set:function(e){cc.sys.localStorage.setItem("finish_classMode",e)}},version:{get:function(){return cc.sys.localStorage.getItem("version")||"1.0.0"},set:function(e){cc.sys.localStorage.setItem("version",e)}}}}),cc._RF.pop()},{}],TJUtils:[function(e,t,s){"use strict";cc._RF.push(t,"450ddpqmA1K9bQW1wpXNed+","TJUtils"),cc.Class({init:function(){cc.sys.isNative},account:function(){cc.sys.isNative||null!=TDGA&&TDGA.Account({accountId:GameData.userId,accountType:1,accountName:GameData.userName,gender:GameData.userSex})},onChargeRequest:function(e,t,s,n){cc.sys.isNative||null!=TDGA&&TDGA.onChargeRequest({orderId:e,iapId:t,currencyAmount:s,currencyType:"CNY",virtualCurrencyAmount:1e3,paymentType:"微信"})},onChargeSuccess:function(e,t,s,n){cc.sys.isNative||null!=TDGA&&TDGA.onChargeSuccess({orderId:e,iapId:t,currencyAmount:s,currencyType:"CNY",virtualCurrencyAmount:1e3,paymentType:"微信"})},onReward:function(e,t){cc.sys.isNative||TDGA.onReward(e,t)},onItemPurchase:function(e,t,s){cc.sys.isNative||TDGA.onItemPurchase({item:e,itemNumber:t,priceInVirtualCurrency:s})},onEvent:function(e,t){cc.sys.isNative||TDGA.onEvent(e,t)}}),cc._RF.pop()},{}],TipsBox:[function(e,t,s){"use strict";cc._RF.push(t,"0dd33HhlLFNcKywu1vavsTb","TipsBox"),cc.Class({extends:cc.Component,properties:{sureHandler:null,cancelHandler:null,txtContent:cc.Label,btnSureBig:cc.Node,btnCancel:cc.Node,btnSure:cc.Node},onLoad:function(){this.node.setContentSize(cc.winSize)},onBtnSureClick:function(){this.sureHandler&&this.sureHandler(eBtnType.Sure),this.sureHandler=null,this.cancelHandler=null,this.node.active=!1},onBtnCancelClick:function(){null!=this.cancelHandler?this.sureHandler&&this.cancelHandler(eBtnType.Cancel):this.sureHandler&&this.sureHandler(eBtnType.Cancel),this.sureHandler=null,this.cancelHandler=null,this.node.active=!1},initView:function(e,t){this.txtContent.string=e,t&&t.length>1?(this.btnCancel.active=!0,this.btnSure.active=!0,this.btnSureBig.active=!1):(this.btnCancel.active=!1,this.btnSure.active=!1,this.btnSureBig.active=!0)},setClickHandler:function(e,t){this.sureHandler=e,this.cancelHandler=t}}),cc._RF.pop()},{}],TipsManager:[function(e,t,s){"use strict";cc._RF.push(t,"fcfd4hGALtN/LrkIvgT7kW7","TipsManager"),cc.Class({properties:{tipsPrefab:cc.Prefab,tipsArr:cc.Array,showingConnect:!1,showingPay:!1},showTipsBox:function(e,t,s,n){var i=cc.director.getScene().getChildByName("TipsBox");null!=i?(i.active=!0,i.getComponent("TipsBox").initView(e,t),i.getComponent("TipsBox").setClickHandler(s,n)):cc.loader.loadRes("Prefab/TipsBox",function(o,a){o||(i=cc.instantiate(a),cc.director.getScene().addChild(i,9998),i.active=!0,i.getComponent("TipsBox").initView(e,t),i.getComponent("TipsBox").setClickHandler(s,n))})},showTips:function(e){if(null==this.tipsPrefab){var t=this;cc.loader.loadRes("Prefab/Tips",function(s,n){s||(t.tipsPrefab=n,t.addTips(e))})}else this.addTips(e)},addTips:function(e){var t=cc.instantiate(this.tipsPrefab),s=cc.director.getWinSize();t.x=s.width/2,t.y=s.height/2,cc.director.getScene().addChild(t),cc.log(t.getChildByName("txtTips")),t.getChildByName("txtTips").getComponent(cc.Label).string=e,t.getChildByName("bg").width=t.getChildByName("txtTips").width+60;var n=cc.moveBy(3,cc.p(0,200)),i=cc.fadeOut(3),o=cc.spawn([n,i]),a=cc.removeSelf(!1);t.runAction(cc.sequence(o,a))},showLoadingTips:function(){var e=cc.director.getScene().getChildByName("LoadingTips");null!=e?e.active=!0:cc.loader.loadRes("Prefab/LoadingTips",function(t,s){t||((e=cc.instantiate(s)).x=cc.visibleRect.center.x,e.y=cc.visibleRect.center.y,cc.director.getScene().addChild(e,9999),e.active=!0)}.bind(this))},closeLoadingTips:function(){var e=cc.director.getScene().getChildByName("LoadingTips");null!=e&&(e.active=!1)},showConnectTips:function(){var e=cc.director.getScene().getChildByName("ConnectTips");cc.log("show connect tips !!!!!",e),this.showingConnect=!0,null!=e?e.active=!0:cc.loader.loadRes("Prefab/ConnectTips",function(t,s){t||((e=cc.instantiate(s)).x=cc.visibleRect.center.x,e.y=cc.visibleRect.center.y,cc.director.getScene().addChild(e,9999),this.showingConnect?e.active=!0:e.active=!1)}.bind(this))},closeConnectTips:function(){var e=cc.director.getScene().getChildByName("ConnectTips");cc.log("close connect tips !!!!!",e),this.showingConnect=!1,null!=e&&(e.active=!1)},showPayTips:function(){var e=cc.director.getScene().getChildByName("PayTips");this.showingPay=!0,null!=e?e.active=!0:cc.loader.loadRes("Prefab/PayTips",function(t,s){t||((e=cc.instantiate(s)).x=cc.visibleRect.center.x,e.y=cc.visibleRect.center.y,cc.director.getScene().addChild(e,9999),this.showingPay?e.active=!0:e.active=!1)}.bind(this))},closePayTips:function(){var e=cc.director.getScene().getChildByName("PayTips");this.showingPay=!1,null!=e&&(e.active=!1)},showPlayerInfoTips:function(e,t,s,n){var i=cc.director.getScene().getChildByName("PlayerInfoTips");null!=i?(i.active=!0,i.getComponent("PlayerInfoTips").showInfo(e,t,s,n)):cc.loader.loadRes("Prefab/PlayerInfoTips",function(o,a){o||(i=cc.instantiate(a),cc.director.getScene().addChild(i,9990),i.active=!0,i.getComponent("PlayerInfoTips").showInfo(e,t,s,n))})},showServerErrTips:function(e,t){this.showTipsBox(EventText[e.res],null,t)}}),cc._RF.pop()},{}],ToggleColorChange:[function(e,t,s){"use strict";cc._RF.push(t,"23d66GzFEdD4azRJ5P2zUyu","ToggleColorChange"),cc.Class({extends:cc.Component,properties:{SelectedColor:cc.Color,UnSelectedColor:cc.Color,Toggle:cc.Node,SelectedNode:cc.Node},updateSelect:function(e){this.Toggle.getComponent("cc.Toggle").isChecked?this.select():this.unSelect()},select:function(){this.SelectedNode.setColor(this.SelectedColor)},unSelect:function(){this.SelectedNode.setColor(this.UnSelectedColor)}}),cc._RF.pop()},{}],UpdateScene:[function(e,t,s){"use strict";cc._RF.push(t,"79da5Cna2xEbp2Kvi3M3bxp","UpdateScene"),cc.Class({extends:cc.Component,properties:{fileProgress:cc.ProgressBar,fileLabel:cc.Label,byteProgress:cc.ProgressBar,byteLabel:cc.Label,curVerion:cc.Label},start:function(){this.curVerion.string="Ver "+Config.version,this.fileProgress&&(this.fileProgress.totalLength=this.fileProgress.node.width-8,this.fileProgress.progress=0),this.byteProgress&&(this.byteProgress.totalLength=this.byteProgress.node.width-8,this.byteProgress.progress=0),this.handleDifUp()},onDestroy:function(){this.destroyRes()},checkUpdate:function(e){AssetsManager.getLocalManifest()&&AssetsManager.getLocalManifest().isLoaded()?(cc.log("local url: "+AssetsManager.getLocalManifest().getPackageUrl()),this._checkListener=new jsb.EventListenerAssetsManager(AssetsManager,function(t){var s=t.getEventCode(),n=function(){this.removeCheckListener(),e&&e(s==jsb.EventAssetsManager.NEW_VERSION_FOUND,s)}.bind(this);switch(cc.log("Code: "+s),s){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:TipsManager.showTipsBox("No local manifest file found, hot update skipped.",[],n);break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:TipsManager.showTipsBox("Fail to download manifest file, hot update skipped.",[],n);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:TipsManager.showTipsBox("Already up to date with the latest remote version.",[],n);break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:cc.log("local version: "+AssetsManager.getLocalManifest().getVersion()),cc.log("remote version: "+AssetsManager.getRemoteManifest().getVersion()),this.fileProgress&&(this.fileProgress.progress=0),this.byteProgress&&(this.byteProgress.progress=0),n()}}.bind(this)),cc.eventManager.addListener(this._checkListener,1),AssetsManager.checkUpdate()):TipsManager.showTipsBox("Failed to load local manifest ...")},hotUpdate:function(){cc.log("Update:hotUpdate()"),this._updateListener=new jsb.EventListenerAssetsManager(AssetsManager,function(e){var t=function(){this.destroyRes(),u_retartGame()}.bind(this);switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:TipsManager.showTipsBox("No local manifest file found, hot update skipped.",[],t);break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:this.byteProgress&&(this.byteProgress.progress=e.getPercent()),this.fileProgress&&(this.fileProgress.progress=e.getPercentByFile()),this.fileLabel&&(this.fileLabel.string=e.getDownloadedFiles()+" / "+e.getTotalFiles()),this.byteLabel&&(this.byteLabel.string=u_calcDataLen(e.getDownloadedBytes())+" / "+u_calcDataLen(e.getTotalBytes()));break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:TipsManager.showTipsBox("Fail to download manifest file, hot update skipped.",[],t);break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:TipsManager.showTipsBox("Already up to date with the latest remote version.",[],t);break;case jsb.EventAssetsManager.UPDATE_FINISHED:var s=jsb.fileUtils.getSearchPaths(),n=AssetsManager.getLocalManifest().getSearchPaths();cc.log(JSON.stringify(n)),Array.prototype.unshift(s,n),cc.sys.localStorage.setItem("HotUpdateSearchPaths",JSON.stringify(s)),jsb.fileUtils.setSearchPaths(s),t();break;case jsb.EventAssetsManager.UPDATE_FAILED:TipsManager.showTipsBox("Update failed. "+e.getMessage(),[],t);break;case jsb.EventAssetsManager.ERROR_UPDATING:TipsManager.showTipsBox("Asset update error: "+e.getAssetId()+", "+e.getMessage(),[],t);break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:TipsManager.showTipsBox(e.getMessage(),[],t)}}.bind(this)),cc.eventManager.addListener(this._updateListener,1),AssetsManager.update()},handleDifUp:function(){this.destroyRes(),AssetsManager.setVerifyCallback(function(e,t){var s=t.compressed,n=t.md5,i=t.path;t.size;return s?(cc.log("setVerifyCallback,relativePath1:",i),!0):(cc.log("setVerifyCallback,relativePath2:",i),cc.log("setVerifyCallback,expectedMD5(2):",n),!0)}),cc.log("Hot update is ready, please check or directly update."),cc.sys.os===cc.sys.OS_ANDROID&&(AssetsManager.setMaxConcurrentTask(2),cc.log("Max concurrent tasks count have been limited to 2")),this.checkUpdate(function(e,t){e&&this.hotUpdate()}.bind(this))},destroyRes:function(){this.removeUpdateListener(),this.removeCheckListener()},removeCheckListener:function(){this._checkListener&&(cc.eventManager.removeListener(this._checkListener),this._checkListener=null)},removeUpdateListener:function(){this._updateListener&&(cc.eventManager.removeListener(this._updateListener),this._updateListener=null)}}),cc._RF.pop()},{}],WXMiniGameUtils:[function(e,t,s){"use strict";cc._RF.push(t,"550b7eK/ThNR5Vw21Nojgw/","WXMiniGameUtils"),cc.Class({properties:{},init:function(){cc.log("WXMiniGameUtils.init"),wx.onShareAppMessage(function(e){u_dump(e,"WXMiniGameUtils.onShareAppMessage()")}),wx.offShareAppMessage(function(e){u_dump(e,"WXMiniGameUtils.offShareAppMessage()")})},onShareSucessCallback:function(e){u_dump(e,"WXMiniGameUtils.onShareSucessCallback()")},onShareFailCallback:function(e){u_dump(e,"WXMiniGameUtils.onShareFailCallback()")},onShareCompleteCallback:function(e){u_dump(e,"WXMiniGameUtils.onShareCompleteCallback()")},getShareInfo:function(){var e={};e.shareTicket="分享标签",e.success=this.onShareSucessCallback,e.fail=this.onShareFailCallback,e.complete=this.onShareCompleteCallback,cc.log("getShareInfo"),wx.getShareInfo(e)},hideShareMenu:function(){var e={};e.success=this.onShareSucessCallback,e.fail=this.onShareFailCallback,e.complete=this.onShareCompleteCallback,cc.log("hideShareMenu"),wx.hideShareMenu(e)},showShareMenu:function(){var e={};e.withShareTicket=!0,e.success=this.onShareSucessCallback,e.fail=this.onShareFailCallback,e.complete=this.onShareCompleteCallback,cc.log("showShareMenu"),wx.showShareMenu(e)},updateShareMenu:function(){var e={};e.withShareTicket=!0,e.success=this.onShareSucessCallback,e.fail=this.onShareFailCallback,e.complete=this.onShareCompleteCallback,cc.log("updateShareMenu"),wx.updateShareMenu(e)},shareAppMessage:function(e){var t={};t.title=e,t.query="key1=val1&key2=val2",t.success=this.onShareSucessCallback,t.fail=this.onShareFailCallback,t.complete=this.onShareCompleteCallback,cc.log("shareAppMessage"),wx.shareAppMessage(t)}}),cc._RF.pop()},{}]},{},["AppStart","ChatData","Config","ConstText","DailyTaskData","Enumerates","ExchargeData","GameData","GameListData","Storage","DailyTask_json","Excharge_json","GameList_json","ApplyDismissRoom","Bonus","ChatPanel","DailyTask","DailyTaskBox","ExchangeGoldBean","Excharge","GameList","GameListCell","GameMatch","Help","JoinRoom","PFinalReport","PRoundReport","PlayerInfoTips","Setting","Share","TipsBox","EventCode","EventText","LFinalReport","LPlayersDataChange","LShowChatMessage","LUpdateCardsAndBeans","LUpdateToggle","LocalEvent","NBattleStep","NCardExchange","NChatMessage","NCreateRoom","NDestroyRoom","NJoinRoom","NLogOut","NQuitRoom","NRobotMode","NUserUpdate","NetEvent","BattleSystem","CardsGroup","CardsHandler","DiscardGroup","DiscardHandler","JoinGame","LoginGame","NewGame","PayLogic","ToggleColorChange","Animations","BattleAvatar","Bubbles","Card","Chip","DailyTaskBoxItem","DailyTaskItem","SFS2X_API_JS","HallScene","LoginScene","PlayScene","StartScene","UpdateScene","AsycnManager","AudioManager","DodGameUtils","EventManager","HeartbeatService","HttpHelper","LayerManager","NetManager","PublicFunctions","SDK","SceneManager","SocketHelper","TJUtils","TipsManager","WXMiniGameUtils"]);